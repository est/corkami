<?xml version="1.0" encoding="UTF-8"?>
<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:smil="urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0" xmlns:anim="urn:oasis:names:tc:opendocument:xmlns:animation:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" office:version="1.2" grddl:transformation="http://docs.oasis-open.org/office/1.2/xslt/odf2rdf.xsl"><office:scripts/><office:automatic-styles><style:style style:name="dp1" style:family="drawing-page"><style:drawing-page-properties presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="false" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp2" style:family="drawing-page"><style:drawing-page-properties presentation:display-header="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp3" style:family="drawing-page"><style:drawing-page-properties presentation:visibility="hidden" presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp4" style:family="drawing-page"><style:drawing-page-properties presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp5" style:family="drawing-page"><style:drawing-page-properties presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="false" presentation:display-page-number="true" presentation:display-date-time="true"/></style:style><style:style style:name="gr1" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="true" fo:min-height="0.68cm" fo:min-width="0cm"/></style:style><style:style style:name="gr2" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr3" style:family="graphic"><style:graphic-properties style:protect="size"/></style:style><style:style style:name="gr4" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="true" fo:min-height="0cm" fo:min-width="0cm"/></style:style><style:style style:name="gr5" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:fill="solid" draw:fill-color="#0047ff" draw:textarea-vertical-align="middle" draw:auto-grow-height="false" fo:min-height="0.749cm" fo:min-width="0.499cm"/></style:style><style:style style:name="gr6" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:fill="solid" draw:fill-color="#000000" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle"/></style:style><style:style style:name="gr7" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.152cm" svg:stroke-color="#000080" draw:marker-start-width="0.428cm" draw:marker-end-width="0.428cm" draw:fill="solid" draw:fill-color="#ffffff" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm" draw:shadow="hidden"/></style:style><style:style style:name="gr8" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.152cm" svg:stroke-color="#008000" draw:marker-start-width="0.428cm" draw:marker-end-width="0.428cm" draw:fill="solid" draw:fill-color="#ffffff" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm" draw:shadow="hidden"/></style:style><style:style style:name="gr9" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="_32__20_Dots_20_1_20_Dash" svg:stroke-width="0.152cm" svg:stroke-color="#808000" draw:marker-start-width="0.428cm" draw:marker-end-width="0.428cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm" draw:shadow="hidden"/></style:style><style:style style:name="gr10" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.152cm" svg:stroke-color="#000000" draw:marker-start-width="0.428cm" draw:marker-end-width="0.428cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm"/></style:style><style:style style:name="gr11" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.203cm" svg:stroke-color="#ff0000" draw:marker-start-width="0.504cm" draw:marker-end-width="0.504cm" draw:fill="solid" draw:fill-color="#ffffff" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.2cm" fo:padding-bottom="0.2cm" fo:padding-left="0.325cm" fo:padding-right="0.325cm"/></style:style><style:style style:name="gr12" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dotted" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr13" style:family="graphic" style:parent-style-name="arrow"><style:graphic-properties draw:fill="solid" draw:fill-color="#0047ff"/></style:style><style:style style:name="gr14" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Ultrafine_20_Dashed" svg:stroke-width="0.102cm" svg:stroke-color="#008000" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr15" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dashed_20__28_var_29_" svg:stroke-width="0.102cm" svg:stroke-color="#333333" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr16" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:auto-grow-height="true" draw:auto-grow-width="false" fo:max-height="0cm" fo:min-height="0cm"/></style:style><style:style style:name="gr17" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.102cm" svg:stroke-color="#800000" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr18" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Ultrafine_20_Dashed" svg:stroke-width="0.102cm" svg:stroke-color="#808000" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr19" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dashed" svg:stroke-width="0.102cm" svg:stroke-color="#0000ff" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr20" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.102cm" svg:stroke-color="#800000" draw:marker-start-width="0.353cm" draw:marker-end-width="0.353cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr21" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:fill="solid" draw:fill-color="#0047ff" draw:textarea-horizontal-align="justify" draw:textarea-vertical-align="middle" draw:auto-grow-height="false"/></style:style><style:style style:name="gr22" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr23" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr24" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:auto-grow-height="true" draw:auto-grow-width="false" fo:max-height="0cm" fo:min-height="5.068cm"/></style:style><style:style style:name="pr1" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="3.005cm"/></style:style><style:style style:name="pr2" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" draw:auto-grow-height="true" fo:min-height="12.572cm"/></style:style><style:style style:name="pr3" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="2.755cm"/></style:style><style:style style:name="pr4" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="11.629cm"/></style:style><style:style style:name="pr5" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="12.322cm"/></style:style><style:style style:name="pr6" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="3.006cm"/></style:style><style:style style:name="pr7" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="11.879cm"/></style:style><style:style style:name="pr8" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties draw:stroke="none" draw:fill="none" fo:min-height="2.839cm"/></style:style><style:style style:name="pr9" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="12.572cm"/></style:style><style:style style:name="pr10" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="15.373cm"/></style:style><style:style style:name="pr11" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="3.006cm"/></style:style><style:style style:name="pr12" style:family="presentation" style:parent-style-name="Default-outline1" style:list-style-name="L6"><style:graphic-properties fo:min-height="11.879cm"/></style:style><style:style style:name="pr13" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="3.005cm"/></style:style><style:style style:name="pr14" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" fo:min-height="4.98cm"/></style:style><style:style style:name="pr15" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" draw:auto-grow-height="true" fo:min-height="3.005cm"/></style:style><style:style style:name="pr16" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="11.879cm"/></style:style><style:style style:name="pr17" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" draw:auto-grow-height="true" fo:min-height="15.373cm"/></style:style><style:style style:name="pr18" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="7.62cm"/></style:style><style:style style:name="pr19" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="7.853cm"/></style:style><style:style style:name="pr20" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="10.111cm"/></style:style><style:style style:name="pr21" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="2.54cm"/></style:style><style:style style:name="co1" style:family="table-column"><style:table-column-properties style:column-width="4.075cm" style:use-optimal-column-width="false"/></style:style><style:style style:name="co2" style:family="table-column"><style:table-column-properties style:column-width="1.535cm" style:use-optimal-column-width="false"/></style:style><style:style style:name="co3" style:family="table-column"><style:table-column-properties style:column-width="1.64cm" style:use-optimal-column-width="false"/></style:style><style:style style:name="co4" style:family="table-column"><style:table-column-properties style:column-width="3.526cm" style:use-optimal-column-width="false"/></style:style><style:style style:name="ro1" style:family="table-row"><style:table-row-properties style:row-height="0.973cm"/></style:style><style:style style:name="ro2" style:family="table-row"><style:table-row-properties style:row-height="0.909cm"/></style:style><style:style style:name="ce1" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" style:repeat="repeat"/><style:paragraph-properties fo:border-left="none" fo:border-right="0.001cm solid #000000" fo:border-top="none" fo:border-bottom="0.001cm solid #000000"/></style:style><style:style style:name="ce2" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" style:repeat="repeat"/><style:paragraph-properties fo:text-align="center" fo:border-left="none" fo:border-right="none" fo:border-top="0.001cm solid #000000" fo:border-bottom="0.001cm solid #000000"/><style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="ce3" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" style:repeat="repeat"/><style:paragraph-properties fo:text-align="center" fo:border-left="none" fo:border-right="0.001cm solid #000000" fo:border-top="0.001cm solid #000000" fo:border-bottom="0.001cm solid #000000"/><style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="ce4" style:family="table-cell"><style:graphic-properties style:repeat="repeat"/><style:paragraph-properties fo:text-align="center" fo:border-left="0.001cm solid #000000" fo:border-right="none" fo:border-top="none" fo:border-bottom="none"/><style:text-properties fo:font-weight="normal" style:font-weight-asian="normal" style:font-weight-complex="normal"/></style:style><style:style style:name="ce5" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#0000ff" style:repeat="repeat"/><style:paragraph-properties fo:border="none"/></style:style><style:style style:name="ce6" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#0000ff" style:repeat="repeat"/><style:paragraph-properties fo:border-left="none" fo:border-right="0.001cm solid #000000" fo:border-top="none" fo:border-bottom="none"/></style:style><style:style style:name="ce7" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#e6e6e6" style:repeat="repeat"/><style:paragraph-properties fo:text-align="center" fo:border="0.001cm solid #000000"/><style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="ce8" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#e6e6e6" style:repeat="repeat"/><style:paragraph-properties fo:border="0.001cm solid #000000"/></style:style><style:style style:name="ce9" style:family="table-cell"><style:graphic-properties style:repeat="repeat"/><style:paragraph-properties fo:text-align="center" fo:border-left="0.001cm solid #000000" fo:border-right="0.001cm solid #000000" fo:border-top="none" fo:border-bottom="none"/></style:style><style:style style:name="ce10" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ff0000" style:repeat="repeat"/><style:paragraph-properties fo:border="none"/></style:style><style:style style:name="ce11" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#333333" style:repeat="repeat"/><style:paragraph-properties fo:border="none"/></style:style><style:style style:name="ce12" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#00ff00" style:repeat="repeat"/><style:paragraph-properties fo:border-left="none" fo:border-right="0.001cm solid #000000" fo:border-top="none" fo:border-bottom="none"/></style:style><style:style style:name="ce13" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ff0000" style:repeat="repeat"/><style:paragraph-properties fo:border-left="none" fo:border-right="0.001cm solid #000000" fo:border-top="none" fo:border-bottom="none"/></style:style><style:style style:name="ce14" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#e6e6e6" style:repeat="repeat"/><style:paragraph-properties fo:border="0.001cm solid #000000"/><style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="ce15" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#00ff00" style:repeat="repeat"/><style:paragraph-properties fo:border="none"/></style:style><style:style style:name="ce16" style:family="table-cell"><style:graphic-properties style:repeat="repeat"/><style:paragraph-properties fo:text-align="center" fo:border-left="0.001cm solid #000000" fo:border-right="0.001cm solid #000000" fo:border-top="none" fo:border-bottom="0.001cm solid #000000"/></style:style><style:style style:name="ce17" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#00ff00" style:repeat="repeat"/><style:paragraph-properties fo:border-left="none" fo:border-right="none" fo:border-top="none" fo:border-bottom="0.001cm solid #000000"/></style:style><style:style style:name="ce18" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ff0000" style:repeat="repeat"/><style:paragraph-properties fo:border-left="none" fo:border-right="0.001cm solid #000000" fo:border-top="none" fo:border-bottom="0.001cm solid #000000"/></style:style><style:style style:name="ce19" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" style:repeat="repeat"/><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:color="#000000" fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="ce20" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" style:repeat="repeat"/><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:color="#ff0000" fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="ce21" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" style:repeat="repeat"/><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:color="#0000ff" fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="ce22" style:family="table-cell"><style:graphic-properties draw:fill="solid" draw:fill-color="#ffffff" style:repeat="repeat"/><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:color="#00ff00" fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="P1" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/></style:style><style:style style:name="P2" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/></style:style><style:style style:name="P3" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="P4" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="P5" style:family="paragraph"><style:text-properties fo:font-size="32pt" style:font-size-asian="32pt" style:font-size-complex="32pt"/></style:style><style:style style:name="P6" style:family="paragraph"><style:text-properties fo:font-size="22pt" style:font-size-asian="22pt" style:font-size-complex="22pt"/></style:style><style:style style:name="P7" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="18pt"/></style:style><style:style style:name="P8" style:family="paragraph"><style:text-properties fo:font-size="20pt"/></style:style><style:style style:name="P9" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="54pt" style:font-size-asian="54pt" style:font-size-complex="54pt"/></style:style><style:style style:name="P10" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="P11" style:family="paragraph"><style:text-properties fo:color="#000000" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="P12" style:family="paragraph"><style:text-properties fo:color="#000080" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="P13" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/></style:style><style:style style:name="P14" style:family="paragraph"><style:text-properties fo:color="#008000" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="P15" style:family="paragraph"><style:text-properties fo:color="#808000" fo:font-size="26pt" style:font-size-asian="26pt" style:font-size-complex="26pt"/></style:style><style:style style:name="P16" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="26pt" style:font-size-asian="26pt" style:font-size-complex="26pt"/></style:style><style:style style:name="P17" style:family="paragraph"><style:text-properties fo:font-size="14pt" style:font-size-asian="14pt" style:font-size-complex="14pt"/></style:style><style:style style:name="P18" style:family="paragraph"><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="P19" style:family="paragraph"><style:text-properties fo:color="#800000" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="P20" style:family="paragraph"><style:text-properties fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="P21" style:family="paragraph"><style:text-properties fo:font-size="16pt" style:font-size-asian="16pt" style:font-size-complex="16pt"/></style:style><style:style style:name="P22" style:family="paragraph"><style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/></style:style><style:style style:name="P23" style:family="paragraph"><style:text-properties fo:font-size="10pt" style:font-size-asian="10pt" style:font-size-complex="10pt"/></style:style><style:style style:name="P24" style:family="paragraph"><style:text-properties fo:font-size="196pt" style:font-size-asian="196pt" style:font-size-complex="196pt"/></style:style><style:style style:name="P25" style:family="paragraph"><style:text-properties fo:font-size="196pt" fo:text-shadow="1pt 1pt" style:font-size-asian="196pt" style:font-size-complex="196pt"/></style:style><style:style style:name="P26" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="100pt" fo:font-weight="normal" style:font-size-asian="100pt" style:font-weight-asian="normal" style:font-size-complex="100pt" style:font-weight-complex="normal"/></style:style><style:style style:name="P27" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:color="#00ffff" fo:font-size="72pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="72pt" style:font-weight-asian="bold" style:font-size-complex="72pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T1" style:family="text"><style:text-properties fo:font-size="139.199996948242pt" style:font-size-asian="139.199996948242pt" style:font-size-complex="139.199996948242pt"/></style:style><style:style style:name="T2" style:family="text"><style:text-properties fo:font-size="88pt" style:font-size-asian="88pt" style:font-size-complex="88pt"/></style:style><style:style style:name="T3" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="20pt" fo:font-weight="normal" style:font-size-asian="20pt" style:font-weight-asian="normal" style:font-size-complex="20pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T4" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="22pt" fo:font-weight="normal" style:font-size-asian="22pt" style:font-weight-asian="normal" style:font-size-complex="22pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T5" style:family="text"><style:text-properties fo:color="#000000" style:text-position="super 58%" fo:font-size="22pt" fo:font-weight="normal" style:font-size-asian="22pt" style:font-weight-asian="normal" style:font-size-complex="22pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T6" style:family="text"><style:text-properties fo:font-size="32pt" style:font-size-asian="32pt" style:font-size-complex="32pt"/></style:style><style:style style:name="T7" style:family="text"><style:text-properties fo:font-size="22pt" style:font-size-asian="22pt" style:font-size-complex="22pt"/></style:style><style:style style:name="T8" style:family="text"><style:text-properties fo:font-size="18pt"/></style:style><style:style style:name="T9" style:family="text"><style:text-properties fo:font-size="20pt"/></style:style><style:style style:name="T10" style:family="text"><style:text-properties fo:font-size="54pt" style:font-size-asian="54pt" style:font-size-complex="54pt"/></style:style><style:style style:name="T11" style:family="text"><style:text-properties fo:font-size="18pt" style:font-size-asian="18pt" style:font-size-complex="18pt"/></style:style><style:style style:name="T12" style:family="text"><style:text-properties fo:font-size="20pt" style:font-size-asian="18pt" style:font-size-complex="18pt"/></style:style><style:style style:name="T13" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="T14" style:family="text"><style:text-properties fo:color="#000080" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="T15" style:family="text"><style:text-properties fo:color="#008000" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="T16" style:family="text"><style:text-properties fo:color="#808000" fo:font-size="26pt" style:font-size-asian="26pt" style:font-size-complex="26pt"/></style:style><style:style style:name="T17" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-size="28pt" fo:font-weight="bold" style:font-size-asian="28pt" style:font-weight-asian="bold" style:font-size-complex="28pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T18" style:family="text"><style:text-properties fo:font-size="26pt" style:font-size-asian="26pt" style:font-size-complex="26pt"/></style:style><style:style style:name="T19" style:family="text"><style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/></style:style><style:style style:name="T20" style:family="text"><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="T21" style:family="text"><style:text-properties fo:color="#800000" fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="T22" style:family="text"><style:text-properties fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="T23" style:family="text"><style:text-properties fo:font-family="Symbol" style:font-style-name="Regular" style:font-charset="x-symbol" style:font-family-asian="Symbol" style:font-style-name-asian="Regular" style:font-charset-asian="x-symbol" style:font-family-complex="Symbol" style:font-style-name-complex="Regular" style:font-charset-complex="x-symbol"/></style:style><style:style style:name="T24" style:family="text"><style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="T25" style:family="text"><style:text-properties fo:font-weight="bold"/></style:style><style:style style:name="T26" style:family="text"><style:text-properties fo:font-size="16pt" style:font-size-asian="16pt" style:font-size-complex="16pt"/></style:style><style:style style:name="T27" style:family="text"><style:text-properties fo:font-size="60pt" style:font-family-asian="Symbol" style:font-style-name-asian="Regular" style:font-charset-asian="x-symbol" style:font-size-asian="72pt" style:font-family-complex="Symbol" style:font-style-name-complex="Regular" style:font-charset-complex="x-symbol" style:font-size-complex="72pt"/></style:style><style:style style:name="T28" style:family="text"><style:text-properties fo:font-family="Symbol" style:font-style-name="Regular" style:font-charset="x-symbol" fo:font-size="60pt" style:font-family-asian="Symbol" style:font-style-name-asian="Regular" style:font-charset-asian="x-symbol" style:font-size-asian="72pt" style:font-family-complex="Symbol" style:font-style-name-complex="Regular" style:font-charset-complex="x-symbol" style:font-size-complex="72pt"/></style:style><style:style style:name="T29" style:family="text"><style:text-properties fo:font-family="Arial" style:font-family-generic="roman" style:font-pitch="variable" fo:font-size="60pt" style:font-family-asian="Symbol" style:font-style-name-asian="Regular" style:font-charset-asian="x-symbol" style:font-size-asian="72pt" style:font-family-complex="Symbol" style:font-style-name-complex="Regular" style:font-charset-complex="x-symbol" style:font-size-complex="72pt"/></style:style><style:style style:name="T30" style:family="text"><style:text-properties fo:font-size="36pt" fo:font-style="normal" style:font-size-asian="36pt" style:font-style-asian="normal" style:font-size-complex="36pt" style:font-style-complex="normal"/></style:style><style:style style:name="T31" style:family="text"><style:text-properties fo:font-size="10pt" style:font-size-asian="10pt" style:font-size-complex="10pt"/></style:style><style:style style:name="T32" style:family="text"><style:text-properties fo:font-style="normal" style:font-style-asian="normal" style:font-style-complex="normal"/></style:style><style:style style:name="T33" style:family="text"><style:text-properties fo:font-weight="normal" style:font-weight-asian="normal" style:font-weight-complex="normal"/></style:style><style:style style:name="T34" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="16pt" fo:font-weight="bold" style:font-size-asian="16pt" style:font-weight-asian="bold" style:font-size-complex="16pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T35" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-size="16pt" fo:font-weight="bold" style:font-size-asian="16pt" style:font-weight-asian="bold" style:font-size-complex="16pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T36" style:family="text"><style:text-properties fo:color="#0000ff" fo:font-size="16pt" fo:font-weight="bold" style:font-size-asian="16pt" style:font-weight-asian="bold" style:font-size-complex="16pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T37" style:family="text"><style:text-properties fo:color="#00ff00" fo:font-size="16pt" fo:font-weight="bold" style:font-size-asian="16pt" style:font-weight-asian="bold" style:font-size-complex="16pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T38" style:family="text"><style:text-properties fo:font-size="196pt" style:font-size-asian="196pt" style:font-size-complex="196pt"/></style:style><style:style style:name="T39" style:family="text"><style:text-properties fo:color="#000000" fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="22pt" fo:font-weight="bold" style:font-size-asian="22pt" style:font-weight-asian="bold" style:font-size-complex="22pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T40" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="22pt" fo:font-weight="bold" style:font-size-asian="22pt" style:font-weight-asian="bold" style:font-size-complex="22pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T41" style:family="text"><style:text-properties fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="15pt" style:font-size-asian="15pt" style:font-size-complex="15pt"/></style:style><style:style style:name="T42" style:family="text"><style:text-properties fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="22pt" fo:font-weight="bold" style:font-size-asian="22pt" style:font-weight-asian="bold" style:font-size-complex="22pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T43" style:family="text"><style:text-properties fo:color="#ff0000"/></style:style><style:style style:name="T44" style:family="text"><style:text-properties fo:color="#000000"/></style:style><style:style style:name="T45" style:family="text"><style:text-properties fo:font-size="196pt" fo:text-shadow="1pt 1pt" style:font-size-asian="196pt" style:font-size-complex="196pt"/></style:style><style:style style:name="T46" style:family="text"><style:text-properties style:text-underline-style="solid" style:text-underline-width="auto" style:text-underline-color="font-color"/></style:style><style:style style:name="T47" style:family="text"><style:text-properties fo:font-size="36pt" style:font-size-asian="44pt" style:font-size-complex="44pt"/></style:style><style:style style:name="T48" style:family="text"><style:text-properties fo:font-size="44pt" style:font-size-asian="44pt" style:font-size-complex="44pt"/></style:style><style:style style:name="T49" style:family="text"><style:text-properties fo:font-size="72pt" style:font-size-asian="72pt" style:font-size-complex="72pt"/></style:style><style:style style:name="T50" style:family="text"><style:text-properties fo:font-family="Symbol" style:font-style-name="Regular" style:font-charset="x-symbol" fo:font-size="72pt" style:font-family-asian="Symbol" style:font-style-name-asian="Regular" style:font-charset-asian="x-symbol" style:font-size-asian="72pt" style:font-family-complex="Symbol" style:font-style-name-complex="Regular" style:font-charset-complex="x-symbol" style:font-size-complex="72pt"/></style:style><style:style style:name="T51" style:family="text"><style:text-properties fo:font-size="14pt" style:font-size-asian="14pt" style:font-size-complex="14pt"/></style:style><style:style style:name="T52" style:family="text"><style:text-properties fo:color="#00b8ff" fo:font-size="15pt" fo:font-weight="bold" style:font-size-asian="15pt" style:font-weight-asian="bold" style:font-size-complex="15pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T53" style:family="text"><style:text-properties fo:font-size="126.5pt" fo:font-weight="normal" style:font-size-asian="126.5pt" style:font-weight-asian="normal" style:font-size-complex="126.5pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T54" style:family="text"><style:text-properties fo:color="#00ffff" fo:font-size="48pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="48pt" style:font-weight-asian="bold" style:font-size-complex="48pt" style:font-weight-complex="bold"/></style:style><text:list-style style:name="L1"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="0.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="●"><style:list-level-properties text:space-before="1.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="1.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="●"><style:list-level-properties text:space-before="2.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="3cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="3.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="4.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L2"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="0.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="●"><style:list-level-properties text:space-before="1.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="1.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="●"><style:list-level-properties text:space-before="2.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="3cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="3.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="4.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L3"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="–"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="75%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="–"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="75%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L4"><text:list-level-style-number text:level="1" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number></text:list-style><text:list-style style:name="L5"><text:list-level-style-number text:level="1" style:num-suffix="." style:num-format="1"><style:list-level-properties/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="0.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="1.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="1.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="2.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="3cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="3.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="4.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number></text:list-style><text:list-style style:name="L6"><text:list-level-style-number text:level="1" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number></text:list-style></office:automatic-styles><office:body><office:presentation><draw:page draw:name="Title" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL1T0"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="19.327cm" svg:height="5.487cm" svg:x="3.837cm" svg:y="4.179cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T1">x86</text:span><text:span text:style-name="T2"> &amp; </text:span><text:span text:style-name="T1">PE</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P3" draw:layer="layout" svg:width="4.862cm" svg:height="1.043cm" svg:x="0.134cm" svg:y="16.838cm"><draw:text-box><text:p text:style-name="P2"><text:span text:style-name="T3">Ange Albertini</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="7.329cm" svg:height="6.351cm" svg:x="9.836cm" svg:y="9.659cm"><draw:image xlink:href="Pictures/10000201000001D0000001909A85887C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P4" draw:layer="layout" svg:width="7.416cm" svg:height="1.147cm" svg:x="9.792cm" svg:y="16.175cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T4">28</text:span><text:span text:style-name="T5">th</text:span><text:span text:style-name="T4"> December 2011</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="3.103cm" svg:height="1.092cm" svg:x="23.697cm" svg:y="16.708cm"><draw:image xlink:href="Pictures/10000201000000580000001FED1EC38A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="1" presentation:class="page"/><draw:frame presentation:style-name="pr2" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>Welcome!</text:p><text:p/><text:p>I&apos;m Ange Albertini, and I will talk about x86 and PE</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="offline introduction" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:text-style-name="P5" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p text:style-name="P2"><text:span text:style-name="T6">before you decide to read further...</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:text-style-name="P6" draw:layer="layout" svg:width="24.299cm" svg:height="13.013cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T7">Contents of this slide deck:</text:span></text:p><text:list text:style-name="L4"><text:list-item><text:p><text:span text:style-name="T7">Introduction</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T7">introduce Corkami, my reverse engineering site</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T7">explain (in easy terms)</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T7">why correct disassembly is important for analysis</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T7">why undocumented opcodes are a dead end</text:span></text:p></text:list-item></text:list></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T7">Main part</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T7">a few examples of undocumented opcodes and CPU weirdness</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T7">theory-only sucks, so I created CoST for practicing and testing.</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T7">CoST also tests PE, but it&apos;s not enough by itself</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T7">So I documented PE separately, and give some examples.</text:span></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="4.943cm" svg:height="0.963cm" draw:transform="rotate (-0.573515192206415) translate (22.748cm 0.319cm)"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T8">HIDDEN SLIDE</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="2" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">this extra slide to let you decide if you really want to read further ;)</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:list text:style-name="L5"><text:list-item><text:p><text:span text:style-name="T9">I studied ASM and PE, from scratch</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T9">I failed all tools I tried: IDA, OllyDbg, Hiew, pefile, WinDbg, HT, CFF Explorer...</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T9">here are a few of my findings</text:span></text:p></text:list-item></text:list></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="story behind this presentation" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="9.61cm" svg:height="3.567cm" svg:x="1.27cm" svg:y="7.228cm"><draw:image xlink:href="Pictures/10000201000001A40000009C5F0B4D9D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p>Improved, but similar</text:p></draw:text-box></draw:frame><draw:custom-shape draw:style-name="gr5" draw:text-style-name="P1" draw:layer="layout" svg:width="3.175cm" svg:height="1.814cm" svg:x="11.913cm" svg:y="7.983cm"><text:p/><draw:enhanced-geometry draw:mirror-horizontal="false" draw:mirror-vertical="false" draw:text-areas="4000 ?f1 ?f5 ?f2" draw:glue-points="0 10800 21600 10800 ?f0 0 ?f0 21600" draw:type="mso-spt100" draw:modifiers="13200 6400 0" draw:enhanced-path="M ?f0 0 L 21600 10800 ?f0 21800 ?f0 ?f2 4000 ?f2 4000 ?f1 ?f0 ?f1 ?f0 0 M 0 ?f1 L 0 ?f2 1000 ?f2 1000 ?f1 0 ?f1 M 2000 ?f1 L 2000 ?f2 3000 ?f2 3000 ?f1 2000 ?f1 Z N"><draw:equation draw:name="f0" draw:formula="$0 "/><draw:equation draw:name="f1" draw:formula="$1 "/><draw:equation draw:name="f2" draw:formula="bottom-$1 "/><draw:equation draw:name="f3" draw:formula="right-$0 "/><draw:equation draw:name="f4" draw:formula="?f3 *$1 /10800"/><draw:equation draw:name="f5" draw:formula="$0 +?f4 "/><draw:handle draw:handle-position="$0 $1" draw:handle-range-x-minimum="4000" draw:handle-range-x-maximum="21600" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="10800"/></draw:enhanced-geometry></draw:custom-shape><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="11.725cm" svg:height="10.16cm" svg:x="14.775cm" svg:y="4.68cm"><draw:image xlink:href="Pictures/10000201000001D0000001909A85887C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="3" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>This <text:s/>is an improved version of my presentation at Hashdays.</text:p><text:p>I reworked it, but most of the content is still the same.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="the author&apos;s project" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="24.299cm" svg:height="3.006cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>Author</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p><text:a xlink:href="http://www.corkami.com/">Corkami</text:a></text:p><text:list><text:list-item><text:p>reverse engineering</text:p></text:list-item><text:list-item><text:p>technical, really free</text:p></text:list-item><text:list-item><text:p>MANY handmade and focused PoCs</text:p><text:list><text:list-item><text:p>nightly builds</text:p></text:list-item><text:list-item><text:p>summary wiki pages</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>but... only a hobby!</text:p></text:list-item></text:list><text:p/></text:list-item></text:list></draw:text-box></draw:frame><draw:frame presentation:style-name="pr8" draw:text-style-name="P9" draw:layer="layout" svg:width="23.276cm" svg:height="3.266cm" svg:x="1.862cm" svg:y="13.39cm"><draw:text-box><text:list text:style-name="L3"><text:list-header><text:p text:style-name="P1"><text:span text:style-name="T10">“</text:span><text:span text:style-name="T10">there&apos;s a PoC for that”</text:span></text:p></text:list-header></text:list><text:p text:style-name="P1"><text:span text:style-name="T11">and if there&apos;s none yet, there will be soon ;)</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="4" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T11">I created Corkami, a website about reverse engineering.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T11">it&apos;s technical, and free: open-source, relying on free tools, free for commercial use, no ads, no log-in.</text:span></text:p><text:p><text:span text:style-name="T12"/></text:p><text:p><text:span text:style-name="T11">I focus on creating a LOT of small focused PoCs. they&apos;re handmade so really no extra stuff. each of them is probably meaningless, but altogether, they&apos;re a useful toolbox to test and learn.</text:span></text:p><text:p><text:span text:style-name="T11">then I write a summary page. but I put more work in PoCs than in the pages.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T11">the important is: for each feature I study, there&apos;s a PoC available</text:span></text:p><text:p><text:span text:style-name="T11"/></text:p><text:p><text:span text:style-name="T11">but it&apos;s only a hobby, so it&apos;s quite messy, and not as good as I&apos;d like it to be.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="PoCs!" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="13.335cm" svg:height="5.833cm" svg:x="13.335cm" svg:y="1.27cm"><draw:image xlink:href="Pictures/1000000000000210000000E7228FF7A4.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="11.33cm" svg:height="5.379cm" svg:x="0.165cm" svg:y="1.632cm"><draw:image xlink:href="Pictures/100000000000018E000000BDEAFA56C2.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="13.673cm" svg:height="8.475cm" svg:x="13.327cm" svg:y="9.525cm"><draw:image xlink:href="Pictures/1000000000000156000000D4CBF7B657.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="10.16cm" svg:height="7.825cm" svg:x="0.635cm" svg:y="9.714cm"><draw:image xlink:href="Pictures/100000000000011B000000DAE0D1A97F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr2" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">so, whether it&apos;s </text:span></text:p><text:list text:style-name="L1"><text:list-item><text:p><text:span text:style-name="T9">a non PE exe with an inverted ZM signature, in 16bits asm.</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T9">a complete &apos;correct&apos; PDF with text (that&apos;s the full PDF btw), typed in notepad</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T9">a working java class, with opcodes generated manually</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T9">a tiny PE, with imports and code in the middle of the header</text:span></text:p></text:list-item></text:list><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">you can see that all of them only have the necessary elements.</text:span></text:p></draw:text-box></draw:frame><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="5" presentation:class="page"/></presentation:notes></draw:page><draw:page draw:name="the story" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr10" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p>the story behind this presentation</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="6" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>and here is the story behind this presentation</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="flashback" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:rect draw:style-name="gr6" draw:text-style-name="P1" draw:layer="layout" svg:width="27cm" svg:height="18cm" svg:x="0cm" svg:y="0cm"><text:p/></draw:rect><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="12.565cm" svg:height="18cm" svg:x="0cm" svg:y="0cm"><draw:image xlink:href="Pictures/10000201000001BC0000027CF46BB050.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="7.725cm" svg:height="3.81cm" svg:x="19.103cm" svg:y="13.97cm"><draw:image xlink:href="Pictures/10000201000000960000004A11A7D669.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="7" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>first, a small flashback</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="young and innocent" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="11.645cm" svg:height="15.234cm" svg:x="7.677cm" svg:y="1.272cm"><draw:image xlink:href="Pictures/10000201000000B800000103ADE10E0A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="8" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>years ago, I was young and innocent, believing that CPU would be perfect, because they&apos;re made of transistor, not software.</text:p><text:p/><text:p>and I thought I knew assembly.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="uh oh" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="15.398cm" svg:height="5.238cm" svg:x="5.715cm" svg:y="10.795cm"><draw:image xlink:href="Pictures/1000000000000246000000C61D12FCC1.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="16.985cm" svg:height="4.762cm" svg:x="5.08cm" svg:y="1.905cm"><draw:image xlink:href="Pictures/1000000000000282000000B41E916510.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="19.367cm" svg:height="1.798cm" svg:x="3.81cm" svg:y="7.727cm"><draw:image xlink:href="Pictures/10000000000002DC0000004446AE92C0.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="9" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>then I encountered my first undocumented opcodes. and shortly after, my first sectionless PE.</text:p><text:p/><text:p>I was shocked, but I thought I was still young...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="back to the basics" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:rect draw:style-name="gr6" draw:text-style-name="P1" draw:layer="layout" svg:width="27cm" svg:height="18cm" svg:x="0cm" svg:y="0cm"><text:p/></draw:rect><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="25.043cm" svg:height="8.484cm" svg:x="0.979cm" svg:y="4.861cm"><draw:image xlink:href="Pictures/100002010000023E000000C48A63DC15.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="10" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>So I decided to go back to the basics, studying x86 and PE from scratch.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="documented on corkami" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:rect draw:style-name="gr7" draw:text-style-name="P10" draw:layer="layout" svg:width="8.815cm" svg:height="9.525cm" svg:x="4.61cm" svg:y="3.81cm"><text:p/></draw:rect><draw:rect draw:style-name="gr8" draw:text-style-name="P10" draw:layer="layout" svg:width="8.789cm" svg:height="9.525cm" svg:x="13.601cm" svg:y="3.81cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P1" draw:layer="layout" svg:width="17.78cm" svg:height="1.717cm" svg:x="4.61cm" svg:y="13.523cm"><text:p/></draw:rect><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="20.955cm" svg:height="15.875cm" svg:x="3.023cm" svg:y="1.063cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P11" draw:layer="layout" svg:width="6.429cm" svg:height="1.673cm" svg:x="3.175cm" svg:y="1.27cm"><draw:text-box><text:p><text:span text:style-name="T13">CORKAMI</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P12" draw:layer="layout" svg:width="2.551cm" svg:height="1.673cm" svg:x="4.79cm" svg:y="4.042cm"><draw:text-box><text:p><text:span text:style-name="T14">x86</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P14" draw:layer="layout" svg:width="2.195cm" svg:height="1.673cm" svg:x="19.974cm" svg:y="4.042cm"><draw:text-box><text:p text:style-name="P13"><text:span text:style-name="T15">PE</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P15" draw:layer="layout" svg:width="5.679cm" svg:height="1.276cm" svg:x="4.719cm" svg:y="13.777cm"><draw:text-box><text:p><text:span text:style-name="T16">PDF,JAVA,...</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="11" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>and writing my findings on the way, on Corkami.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="this talk is a subset" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:rect draw:style-name="gr7" draw:text-style-name="P10" draw:layer="layout" svg:width="8.815cm" svg:height="9.525cm" svg:x="4.61cm" svg:y="3.81cm"><text:p/></draw:rect><draw:rect draw:style-name="gr8" draw:text-style-name="P10" draw:layer="layout" svg:width="8.789cm" svg:height="9.525cm" svg:x="13.601cm" svg:y="3.81cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P1" draw:layer="layout" svg:width="17.78cm" svg:height="1.717cm" svg:x="4.61cm" svg:y="13.523cm"><text:p/></draw:rect><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="20.955cm" svg:height="15.875cm" svg:x="3.023cm" svg:y="1.063cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P11" draw:layer="layout" svg:width="6.429cm" svg:height="1.673cm" svg:x="3.175cm" svg:y="1.27cm"><draw:text-box><text:p><text:span text:style-name="T13">CORKAMI</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P15" draw:layer="layout" svg:width="5.679cm" svg:height="1.276cm" svg:x="4.719cm" svg:y="13.777cm"><draw:text-box><text:p><text:span text:style-name="T16">PDF,JAVA,...</text:span></text:p></draw:text-box></draw:frame><draw:ellipse draw:style-name="gr11" draw:text-style-name="P7" draw:layer="layout" svg:width="7.468cm" svg:height="2.54cm" svg:x="9.766cm" svg:y="7.785cm"><text:p text:style-name="P1"><text:span text:style-name="T17">THIS TALK</text:span></text:p></draw:ellipse><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="3.378cm" svg:height="3.176cm" svg:x="13.332cm" svg:y="5.079cm"><draw:image xlink:href="Pictures/10000201000000440000007E35DD28A1.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="3.774cm" svg:height="6.385cm" svg:x="11.613cm" svg:y="1.87cm"><draw:image xlink:href="Pictures/100002010000007B000000D075081B2B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="2.422cm" svg:height="3.045cm" svg:x="12.29cm" svg:y="2.24cm"><draw:image xlink:href="Pictures/100002010000004200000053367CF47A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P12" draw:layer="layout" svg:width="2.551cm" svg:height="1.673cm" svg:x="4.791cm" svg:y="4.043cm"><draw:text-box><text:p><text:span text:style-name="T14">x86</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P14" draw:layer="layout" svg:width="2.195cm" svg:height="1.673cm" svg:x="19.975cm" svg:y="4.043cm"><draw:text-box><text:p text:style-name="P13"><text:span text:style-name="T15">PE</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="12" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">This talk is only a subset of what&apos;s available on the site, even on these topics.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="Hall of trophy" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.006cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>“Achievement unlocked”</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="12.652cm" svg:height="4.445cm" svg:x="13.483cm" svg:y="5.08cm"><draw:image xlink:href="Pictures/100000000000017200000082FEA0CB36.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="11.985cm" svg:height="4.508cm" svg:x="1.25cm" svg:y="4.997cm"><draw:image xlink:href="Pictures/100000000000013700000075B129B23B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="11.893cm" svg:height="2.775cm" svg:x="1.351cm" svg:y="9.625cm"><draw:image xlink:href="Pictures/10000000000001B500000066E9A803FC.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P16" draw:layer="layout" svg:width="19.514cm" svg:height="1.276cm" svg:x="3.743cm" svg:y="14.44cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T18">(Authors notified, and most bugs already fixed)</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="12.7cm" svg:height="3.681cm" svg:x="13.335cm" svg:y="9.764cm"><draw:image xlink:href="Pictures/1000020100000258000000AE287456F6.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="13" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T9">but, if I was just a guy learning ASM and PE, I probably wouldn&apos;t be presenting here.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">So, here is why I&apos;m here :)</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">Most of these bugs were already reported and fixed.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="Agenda" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>Agenda</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr12" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L6"><text:list-item><text:p>why does it matter?</text:p><text:list><text:list-item><text:p>assembly</text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T19">undocumented</text:span> assembly</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>x86 oddities </text:p></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:list><text:list-header><text:p>(technical stuff starts now)</text:p></text:list-header></text:list></text:list-item></text:list><text:list text:style-name="L6"><text:list-item><text:p>CoST</text:p></text:list-item><text:list-item><text:p>a bit more of PE</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="14" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P17" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, first, I&apos;ll start slowly, trying to introduce assembly to beginners, and make them understand the problem of undocumented opcodes.</text:p><text:p/><text:p>then, it will get more technical:</text:p><text:p>I&apos;ll cover a few assembly tricks, including some found in malware.</text:p><text:p/><text:p>then I&apos;ll introduce my opcode tester, CoST.</text:p><text:p/><text:p>and I&apos;ll also present my last project which deals with the PE format.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="intro to asm" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr10" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle" presentation:user-transformed="true"><draw:text-box><text:p>assembly, in 8 slides</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="15" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>So, let&apos;s start and try to make everybody understand the problem of undocumented opcodes.</text:p><text:p/><text:p>so first, introduce opcodes themselves</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="from C to binary" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>from C to binary</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr12" draw:text-style-name="P1" draw:layer="layout" svg:width="15.221cm" svg:height="5.715cm" svg:x="1.27cm" svg:y="3.845cm"><draw:image xlink:href="Pictures/10000000000001E2000000B583B3039F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr12" draw:text-style-name="P1" draw:layer="layout" svg:width="8.226cm" svg:height="6.639cm" svg:x="17.174cm" svg:y="9.871cm"><draw:image xlink:href="Pictures/1000000000000137000000FBD96B3990.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:custom-shape draw:style-name="gr13" draw:layer="layout" svg:width="3.175cm" svg:height="1.27cm" draw:transform="rotate (-0.408232512042583) translate (14.866cm 8.89cm)"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:mirror-horizontal="false" draw:mirror-vertical="false" draw:text-areas="0 ?f0 ?f5 ?f2" draw:type="right-arrow" draw:modifiers="16200 5400" draw:enhanced-path="M 0 ?f0 L ?f1 ?f0 ?f1 0 21600 10800 ?f1 21600 ?f1 ?f2 0 ?f2 Z N"><draw:equation draw:name="f0" draw:formula="$1 "/><draw:equation draw:name="f1" draw:formula="$0 "/><draw:equation draw:name="f2" draw:formula="21600-$1 "/><draw:equation draw:name="f3" draw:formula="21600-?f1 "/><draw:equation draw:name="f4" draw:formula="?f3 *?f0 /10800"/><draw:equation draw:name="f5" draw:formula="?f1 +?f4 "/><draw:equation draw:name="f6" draw:formula="?f1 *?f0 /10800"/><draw:equation draw:name="f7" draw:formula="?f1 -?f6 "/><draw:handle draw:handle-position="$0 $1" draw:handle-range-x-minimum="0" draw:handle-range-x-maximum="21600" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="10800"/></draw:enhanced-geometry></draw:custom-shape><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="16" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P18" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T20">so, we create a simple program in a language, such as C.</text:span></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20">Here, in Visual Studio, Microsoft standard development environment.</text:span></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20">this program shows a simple message box on screen, then terminates.</text:span></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20">an executable is generated, and indeed does what we expected.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="inside the binary" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>inside the binary</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="1.27cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/10000201000004AE000002260F432DC9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="17" presentation:class="page"/><draw:frame presentation:style-name="pr2" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>what the Visual Studio compiler did from our C code is actually generate sequences of assembly code instruction that will generate the wanted actions.</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page18" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>order</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="1.27cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/10000201000004AE000002260F432DC9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr14" draw:text-style-name="P1" draw:layer="layout" svg:width="16.121cm" svg:height="3.43cm" svg:x="9.701cm" svg:y="10.485cm"><text:p/></draw:rect><draw:rect draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="5.194cm" svg:height="3.397cm" svg:x="3.723cm" svg:y="10.485cm"><text:p/></draw:rect><draw:frame draw:style-name="gr16" draw:text-style-name="P19" draw:layer="layout" svg:width="1.27cm" svg:height="1.673cm" svg:x="2.221cm" svg:y="7.866cm"><draw:text-box><text:p><text:span text:style-name="T21">1</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr16" draw:text-style-name="P14" draw:layer="layout" svg:width="1.27cm" svg:height="1.673cm" svg:x="24.552cm" svg:y="8.917cm"><draw:text-box><text:p><text:span text:style-name="T15">2</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr16" draw:text-style-name="P20" draw:layer="layout" svg:width="1.27cm" svg:height="1.673cm" svg:x="7.92cm" svg:y="13.77cm"><draw:text-box><text:p><text:span text:style-name="T22">3</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="18.099cm" svg:height="0.751cm" svg:x="2.221cm" svg:y="9.539cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="18" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">so, the C code is turned into assembly. which is itself encoded in the binary as opcodes.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="our code, translated" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="1.27cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/10000201000004AE000002260F432DC9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>our code, &apos;translated&apos;</text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="3.56cm" svg:height="0.751cm" svg:x="2.221cm" svg:y="9.538cm"><text:p/></draw:rect><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="3.625cm" svg:height="0.719cm" svg:x="18.325cm" svg:y="13.163cm"><text:p/></draw:rect><draw:rect draw:style-name="gr18" draw:text-style-name="P1" draw:layer="layout" svg:width="4.541cm" svg:height="0.752cm" svg:x="6.663cm" svg:y="9.57cm"><text:p/></draw:rect><draw:rect draw:style-name="gr18" draw:text-style-name="P1" draw:layer="layout" svg:width="4.541cm" svg:height="0.752cm" svg:x="17.264cm" svg:y="11.77cm"><text:p/></draw:rect><draw:rect draw:style-name="gr19" draw:text-style-name="P1" draw:layer="layout" svg:width="2.681cm" svg:height="0.829cm" svg:x="11.43cm" svg:y="9.525cm"><text:p/></draw:rect><draw:rect draw:style-name="gr19" draw:text-style-name="P1" draw:layer="layout" svg:width="2.681cm" svg:height="0.829cm" svg:x="17.231cm" svg:y="10.926cm"><text:p/></draw:rect><draw:rect draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="3.561cm" svg:height="0.85cm" svg:x="2.186cm" svg:y="13.849cm"><text:p/></draw:rect><draw:rect draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="3.561cm" svg:height="0.85cm" svg:x="18.387cm" svg:y="15.349cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr2" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">Here, you can see calls to MessageBox, then ExitProcess (the names are self-explaining), with the parameters above.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">these assembly operations are stored in opcodes directly in the binary, as visible on the left.</text:span></text:p></draw:text-box></draw:frame><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="19" presentation:class="page"/></presentation:notes></draw:page><draw:page draw:name="opcodes and assembly" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="1.27cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/10000201000004AE000002260F432DC9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>opcodes <text:span text:style-name="T23"></text:span> assembly</text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="0.914cm" svg:height="1.436cm" svg:x="3.691cm" svg:y="11.041cm"><text:p/></draw:rect><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="1.469cm" svg:height="1.307cm" svg:x="9.767cm" svg:y="11.138cm"><text:p/></draw:rect><draw:rect draw:style-name="gr18" draw:text-style-name="P1" draw:layer="layout" svg:width="3.406cm" svg:height="0.752cm" svg:x="4.662cm" svg:y="11.005cm"><text:p/></draw:rect><draw:rect draw:style-name="gr18" draw:text-style-name="P1" draw:layer="layout" svg:width="2.692cm" svg:height="0.752cm" svg:x="19.912cm" svg:y="11.018cm"><text:p/></draw:rect><draw:rect draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="0.883cm" svg:height="0.686cm" svg:x="3.722cm" svg:y="13.196cm"><text:p/></draw:rect><draw:rect draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="1.375cm" svg:height="0.657cm" svg:x="9.829cm" svg:y="13.225cm"><text:p/></draw:rect><draw:rect draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="0.883cm" svg:height="0.686cm" svg:x="3.723cm" svg:y="15.396cm"><text:p/></draw:rect><draw:rect draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="1.375cm" svg:height="0.657cm" svg:x="9.83cm" svg:y="15.426cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="20" presentation:class="page"/><draw:frame presentation:style-name="pr2" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">now you know that this is what is in the file itself.</text:span></text:p><text:p><text:span text:style-name="T9">this is how it&apos;s read by &apos;us&apos; (reverse engineers, malware analysts, <text:s/>exploit developers...).</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">the CPU itself only reads the hex.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">as you can see, there is a relation:</text:span></text:p><text:p><text:span text:style-name="T9">68 - in hex - is used to push offsets</text:span></text:p><text:p><text:span text:style-name="T9">calls starts with FF 15...</text:span></text:p><text:p><text:span text:style-name="T9">and you can see the used addresses here (read them backward).</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">so, you see the first byte determine the actual opcode.</text:span></text:p><text:p><text:span text:style-name="T9">and depending on each opcode, the length is variable.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="where is the code" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.554cm" svg:height="12.393cm" svg:x="0.212cm" svg:y="-0.962cm"><draw:image xlink:href="Pictures/10000201000004AE000002260F432DC9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="highlight" draw:layer="layout" svg:width="5.201cm" svg:height="3.562cm" svg:x="2.704cm" svg:y="5.551cm"><text:p/></draw:rect><draw:rect draw:style-name="highlight" draw:layer="layout" svg:width="5.201cm" svg:height="1.502cm" svg:x="2.705cm" svg:y="9.928cm"><text:p/></draw:rect><draw:frame presentation:style-name="pr14" draw:layer="layout" svg:width="34.325cm" svg:height="4.98cm" svg:x="-3.663cm" svg:y="-0.435cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>what&apos;s (only) in the binary</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="13.264cm" svg:height="13.335cm" svg:x="10.866cm" svg:y="3.175cm"><draw:image xlink:href="Pictures/10000000000002380000023B235318EB.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="21" presentation:class="page"/><draw:frame presentation:style-name="pr2" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>This is what is actually in the file on the hard disk (the &apos;hex&apos;).</text:p><text:p/><text:p>If you&apos;d accidentally open the file in, say notepad - it doesn&apos;t really make sense, but at least you have that on your machine - you could find it here (remember, it&apos;s hex).</text:p><text:p/><text:p>Note that it&apos;s actually a very tiny part of the whole file <text:s/>(&lt;30bytes out of 56000).</text:p><text:p/><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="different binary, still the same opcode" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr15" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>execution <text:span text:style-name="T23"></text:span> CPU + opcodes</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="12.997cm" svg:height="13.066cm" svg:x="0.635cm" svg:y="3.467cm"><draw:image xlink:href="Pictures/10000000000002380000023B235318EB.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="11.706cm" svg:height="6.624cm" svg:x="14.605cm" svg:y="5.688cm"><draw:image xlink:href="Pictures/100002010000026E00000160A6CA1AA1.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="22" presentation:class="page"/><draw:frame presentation:style-name="pr2" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">What&apos;s important is that in the end, anything running on your machine is about the CPU executing opcode, no matter what.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">the compiled file is full of &apos;unneeded&apos; stuff. while you can make a much smaller file with exactly the same functionality (that&apos;s the whole file), and even though they&apos;re very different, the same opcodes are present again.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="assembly" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>opcodes</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="12.099cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>generated by compilers, tools,...</text:p><text:list><text:list-item><text:p>or written by hand</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>executed directly by the CPU</text:p></text:list-item><text:list-item><text:p>the only code information, in a standard binary</text:p><text:list><text:list-item><text:p>what &apos;we&apos; read</text:p><text:list><text:list-item><text:p><text:span text:style-name="T24">after</text:span> disassembly</text:p></text:list-item></text:list></text:list-item></text:list><text:p/></text:list-item><text:list-item><text:p>disassembly is only for humans</text:p><text:list><text:list-item><text:p>no text code in the final binary</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="23" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.673cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>so, the compiler translates our C to a series of assembly operations, which is itself encoded in opcodes.</text:p><text:p>the resulting executable only contains the opcodes, which are directly understood and executed by the CPU. If no error happens, what is here directly affects the behavior of the program, there is <text:s/>no &apos;man in the middle&apos; from the OS.</text:p><text:p/><text:p>so our C code will just eventually lead the CPU to read and execute</text:p><text:p>6A 40 68 F4 20 40 00 68 FC 20...</text:p><text:p/><text:p>if, by any chance, there is some opcodes that we are not aware of, or doesn&apos;t do what we expect, the CPU doesn&apos;t care, it just knows what to do.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="let&apos;s mess" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr10" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p>let&apos;s mess a bit now...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="24" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so now, let&apos;s interfere with the compiling process</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="adding a byte..." draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p>let&apos;s insert &apos;something&apos;</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="19.378cm" svg:height="3.57cm" svg:x="1.486cm" svg:y="4.685cm"><draw:image xlink:href="Pictures/10000000000001D80000005761D1D508.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="19.87cm" svg:height="5.316cm" svg:x="6.8cm" svg:y="12.065cm"><draw:image xlink:href="Pictures/10000000000001E2000000819B9EA1B3.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="14.046cm" svg:height="1.609cm" svg:x="6.631cm" svg:y="11.89cm"><text:p/></draw:rect><draw:rect draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="5.654cm" svg:height="0.872cm" svg:x="2.601cm" svg:y="5.302cm"><text:p/></draw:rect><draw:custom-shape draw:style-name="gr21" draw:text-style-name="P1" draw:layer="layout" svg:width="5.857cm" svg:height="1.905cm" draw:transform="rotate (-0.778940445166109) translate (8.532cm 6.35cm)"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:text-areas="0 ?f0 ?f5 ?f2" draw:type="right-arrow" draw:modifiers="16200 5400" draw:enhanced-path="M 0 ?f0 L ?f1 ?f0 ?f1 0 21600 10800 ?f1 21600 ?f1 ?f2 0 ?f2 Z N"><draw:equation draw:name="f0" draw:formula="$1 "/><draw:equation draw:name="f1" draw:formula="$0 "/><draw:equation draw:name="f2" draw:formula="21600-$1 "/><draw:equation draw:name="f3" draw:formula="21600-?f1 "/><draw:equation draw:name="f4" draw:formula="?f3 *?f0 /10800"/><draw:equation draw:name="f5" draw:formula="?f1 +?f4 "/><draw:equation draw:name="f6" draw:formula="?f1 *?f0 /10800"/><draw:equation draw:name="f7" draw:formula="?f1 -?f6 "/><draw:handle draw:handle-position="$0 $1" draw:handle-range-x-minimum="0" draw:handle-range-x-maximum="21600" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="10800"/></draw:enhanced-geometry></draw:custom-shape><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="25" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>let&apos;s add a command that will force a specific byte in the opcodes.</text:p><text:p/><text:p>this result is not known to visual studio, which only shows ??</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="an undocumented byte" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="16.702cm" svg:height="17.999cm" svg:x="5.149cm" svg:y="0cm"><draw:image xlink:href="Pictures/100000000000032C0000036B156021FA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="2.159cm" svg:height="1.611cm" svg:x="17.145cm" svg:y="13.97cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="26" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>indeed, if we check Intel official documentation, there is nothing to see here...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="what&apos;s going to happen ?" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>what did we do?</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.351cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>Inserting an unrecognized byte</text:p><text:list><text:list-item><text:p>directly in the binary</text:p><text:list><text:list-item><text:p>to be executed by the CPU</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>not even documented, nor identified!</text:p><text:p/></text:list-item></text:list></text:list-item></text:list><text:p text:style-name="P1"/><text:p text:style-name="P1">“kids, don&apos;t try this at home!”</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="27" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, we forced something that is not recognized by the most expensive Microsoft compiler to execute, which is not even in Intel&apos;s books.</text:p><text:p/><text:p>We should only expect a crash, right ?</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="execution goes on fine" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>the CPU doesn&apos;t care</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T25">it</text:span> knows</text:p><text:list><text:list-item><text:p>and does its own stuff</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="18.06cm" svg:height="9.365cm" svg:x="4.47cm" svg:y="7.78cm"><draw:image xlink:href="Pictures/1000020100000392000001DA7B996A2D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="28" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P21" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T26">but the CPU doesn&apos;t care about what YOU (or VS) know, and it just executes that mysterious D6 just fine (apparently)</text:span></text:p><text:p><text:span text:style-name="T26"/></text:p><text:p><text:span text:style-name="T26">it doesn&apos;t look like a big problem, but if like Microsoft, you base your judgment on Intel&apos;s documentation, you just don&apos;t know what happens next. No automated analysis, proactive detection, etc... and you need to understand that undocumented opcode.</text:span></text:p><text:p><text:span text:style-name="T26"/></text:p><text:p><text:span text:style-name="T26">You can&apos;t even skip it:</text:span></text:p><text:p><text:span text:style-name="T26">you don&apos;t know if it will jump, do nothing, trigger an exception...</text:span></text:p><text:p><text:span text:style-name="T26">and because of variable instruction length, you can&apos;t even tell what would be the next instruction, so you can&apos;t guess easily backward from the next instruction.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="what happened ?" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.006cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>what happened ?</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="12.62cm" svg:height="11.629cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>D6 = S[ET]ALC</text:p><text:list><text:list-item><text:p>Set AL on Carry</text:p><text:list><text:list-item><text:p>AL = CF ? -1 : 0</text:p></text:list-item></text:list></text:list-item></text:list></text:list-item><text:list-item><text:p>trivial</text:p></text:list-item><text:list-item><text:p>but not documented</text:p><text:list><text:list-item><text:p>unreliable, or shameful ?</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr22" draw:text-style-name="P1" draw:layer="layout" svg:width="12.7cm" svg:height="13.762cm" svg:x="13.97cm" svg:y="3.383cm"><draw:image xlink:href="Pictures/100000000000033600000370BBA64B59.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="1.761cm" svg:height="1.131cm" svg:x="23.471cm" svg:y="15.037cm"><text:p/></draw:rect><draw:rect draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="3.231cm" svg:height="1.389cm" svg:x="23.495cm" svg:y="3.314cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="29" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">so what did we do in reality ?</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">D6 will be decoded as SETALC, which is quite simple.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">It doesn&apos;t interfere with the execution of this example (it could have, of course).</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">surprisingly, it&apos;s not documented by Intel, but it&apos;s documented by AMD.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">anyone knows why ?</text:span></text:p><text:p><text:span text:style-name="T9">I&apos;d be curious to know.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="do what I do..." draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL5T3"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>“do what I do...”</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="26.999cm" svg:height="4.096cm" svg:x="0cm" svg:y="13.065cm"><draw:image xlink:href="Pictures/10000201000004040000009C96FB4647.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="26.999cm" svg:height="1.186cm" svg:x="0cm" svg:y="11.795cm"><draw:image xlink:href="Pictures/10000201000004CC00000036F6459C8D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr22" draw:text-style-name="P1" draw:layer="layout" svg:width="17.44cm" svg:height="7.89cm" svg:x="4.78cm" svg:y="3.54cm"><draw:image xlink:href="Pictures/10000201000002B60000013AAA7337C4.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="30" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">the funny thing is, even though Intel docs are full of holes, Intel free tools are fully aware of what to expect...</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">Sadly, Microsoft WinDbg decided to follow the official docs, which makes it a very bad tool against malware, which commonly use undocumented tricks.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="the problem" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>the problem (1/2)</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>the CPU does its stuff</text:p><text:list><text:list-item><text:p>whatever we (don&apos;t) know</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>if we/our tools don&apos;t know what&apos;s next, we&apos;re blind.</text:p></text:list-item></text:list><text:p><text:span text:style-name="T27"/></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="31" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>So, you now know that the CPU knows things that the Intel documentations omits.</text:p><text:p/><text:p>if we or our tools are not able to tell what the CPU will do, we&apos;re just blind.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="the other problem" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>the problem (2/2)</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P2">no exhaustive or clean test set</text:p><text:list text:style-name="L3"><text:list-item><text:list><text:list-item><text:p>deep into malwares or packers</text:p></text:list-item><text:list-item><text:p>scattered</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p text:style-name="P1"><text:span text:style-name="T28"> </text:span><text:span text:style-name="T29">Corkami</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="32" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">the extra problem is that each of this oddities are usually scattered in various files, deep under obfuscations or in malicious behavior. no &apos;ready to use&apos; toolbox.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">that&apos;s the hole I wanted to fill.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="technical part starts now" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr17" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p>let&apos;s start exploring x86...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="33" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>Now, let&apos;s start the real stuff</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page34" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Questions</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>Generalities</text:p><text:list text:style-name="L3"><text:list-item><text:p>opcodes</text:p></text:list-item><text:list-item><text:p>registers</text:p><text:list><text:list-item><text:p>relation</text:p></text:list-item><text:list-item><text:p>initial values</text:p></text:list-item></text:list><text:p/></text:list-item></text:list><text:p>Specificities</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="34" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>before focusing on particular opcodes,</text:p><text:p>my first questions was: </text:p><text:p>what are actually all the supported opcodes ?</text:p><text:p>then, actually how many registers are there ?</text:p><text:p>before anything happen, do they have any particular value ?</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="standard language" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL5T3"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>a multi-generation CPU: modern...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr18" draw:layer="layout" svg:width="4.445cm" svg:height="8.918cm" svg:x="7.35cm" svg:y="4.717cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T22">English</text:span></text:p><text:p>let&apos;s go!</text:p><text:p>you win</text:p><text:p>sandwich</text:p><text:p>hello</text:p><text:p>f*ck</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr19" draw:text-style-name="P22" draw:layer="layout" svg:width="5.985cm" svg:height="8.898cm" svg:x="14.875cm" svg:y="4.727cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T30">Assembly</text:span></text:p><text:p><text:span text:style-name="T19">push</text:span></text:p><text:p><text:span text:style-name="T19">mov</text:span></text:p><text:p><text:span text:style-name="T19">call</text:span></text:p><text:p><text:span text:style-name="T19">retn</text:span></text:p><text:p><text:span text:style-name="T19">jmp</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="35" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>that&apos;s the problem. </text:p><text:p>like English language, assembly uses mainly always the same &apos;standard&apos; opcodes.</text:p><text:p/><text:p>which means, what everybody is used to hear or read:</text:p><text:p/><text:p>Here, &apos;standard language&apos;. What all generations understand.</text:p><text:p/><text:p>most people would understand...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="old language" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>...shakespeare...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr19" draw:layer="layout" svg:width="5.587cm" svg:height="7.853cm" svg:x="7.62cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>thou</text:p><text:p>porpentine</text:p><text:p>enmity</text:p><text:p>hither</text:p><text:p>unkennel</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr19" draw:text-style-name="P22" draw:layer="layout" svg:width="3.175cm" svg:height="7.853cm" svg:x="14.91cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T19">aaa</text:span></text:p><text:p><text:span text:style-name="T19">xlat</text:span></text:p><text:p><text:span text:style-name="T19">verr</text:span></text:p><text:p><text:span text:style-name="T19">smsw</text:span></text:p><text:p><text:span text:style-name="T19">lsl</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="36" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>but Intel CPU are from the 70&apos;s and still backward compatible...</text:p><text:p/><text:p>here is an example of Shakespeare English and old x86 mnemonics</text:p><text:p/><text:p>unknown to most people.</text:p><text:p>yet still fully working on a modern CPU.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="old language example" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL6T11"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>(old, but fully supported)</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="21.157cm" svg:height="12.286cm" svg:x="2.923cm" svg:y="4.245cm"><draw:image xlink:href="Pictures/1000020100000316000001DABF0E2CC2.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="37" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">so here is a small executable where I only use uncommon opcodes. some are not really doing anything, some are actually doing something meaningful.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">I expect that most of us are not even used to see these opcodes, yet they&apos;re fully supported by all CPUs.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="overdisasm" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>&apos;over-disassembling&apos;</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>CD XX: int XX</text:p></text:list-item><text:list-item><text:p>deprecated behaviors:</text:p><text:list><text:list-item><text:p>int 20h = VXD, int 35-39 = FPU</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="18.449cm" svg:height="3.138cm" svg:x="0.635cm" svg:y="8.927cm"><draw:image xlink:href="Pictures/100002010000035A00000092D0E2A6DF.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="16.049cm" svg:height="4.073cm" svg:x="0.635cm" svg:y="13.335cm"><draw:image xlink:href="Pictures/1000020100000286000000A4BFDC4A73.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="7.247cm" svg:height="8.952cm" svg:x="19.216cm" svg:y="8.64cm"><draw:image xlink:href="Pictures/10000000000000BB000000E76F7B22AA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="38" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T9">Another funny fact is that some specific opcodes (interrupt) used to be for various functionality, which made IDA and Hiew over-interpret them.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">in IDA, you can disable the option which is by default.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="newest language" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL5T3"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>...next generation</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr19" draw:layer="layout" svg:width="3.73cm" svg:height="7.853cm" svg:x="7.35cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>tweet</text:p><text:p>poke</text:p><text:p>google</text:p><text:p>pwn</text:p><text:p>apps</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr19" draw:text-style-name="P22" draw:layer="layout" svg:width="7.79cm" svg:height="7.853cm" svg:x="14.8cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T19">crc32</text:span></text:p><text:p><text:span text:style-name="T19">aesenc</text:span></text:p><text:p><text:span text:style-name="T19">pcmpistrm</text:span></text:p><text:p><text:span text:style-name="T19">vfmsubadd132ps</text:span></text:p><text:p><text:span text:style-name="T19">movbe</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P23" draw:layer="layout" svg:width="8.101cm" svg:height="1.029cm" svg:x="18.308cm" svg:y="10.39cm"><draw:text-box><text:p><text:span text:style-name="T31">Fused Multiply-Alternating Subtract/Add</text:span></text:p><text:p><text:span text:style-name="T31">of Packed Single-Precision Floating-Point Values</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P23" draw:layer="layout" svg:width="3.135cm" svg:height="0.64cm" svg:x="17.145cm" svg:y="11.906cm"><draw:text-box><text:p><text:span text:style-name="T31">only in netbooks!</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="39" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>new generation : English and opcodes.</text:p><text:p/><text:p>probably unknown to most people</text:p><text:p/><text:p>single opcodes for CRC, AES, string masking...</text:p><text:p/><text:p>MOVBE = rejected offspring </text:p><text:p>netbook only. absent from i7</text:p><text:p>=&gt; so much for backward compatibility</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="opcodes32" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr23" draw:text-style-name="P1" draw:layer="layout" svg:width="24.299cm" svg:height="10.026cm" svg:x="1.349cm" svg:y="3.987cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/100002010000079500000321FCD4E5BC.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>all opcodes PoC</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="40" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>I made a &apos;non working&apos; PoC with all opcodes encoded, and various tricky situation.</text:p><text:p/><text:p>very useful to quickly test the abilities of a disassembler.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="registers" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>registers</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T32">Complex relations</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T32">FPU </text:span>changes FST, STx, Mmx (ST0 overlaps MM7)</text:p><text:list><text:list-item><text:p>also changes CR0 (under XP)</text:p></text:list-item></text:list></text:list-item></text:list><text:p/></text:list-item><text:list-item><text:p>Initial values</text:p><text:list><text:list-item><text:p>AX = &lt;OS generation&gt;</text:p><text:list><text:list-item><text:p>OS = (EAX == 0) ? XP : newer</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>GS = &lt;number of bits&gt;</text:p><text:list><text:list-header><text:p>bits = (GS == 0) ? 32 : 64</text:p></text:list-header></text:list></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="41" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="13.465cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>the basics of assembly are the registers...</text:p><text:p/><text:p>registers are overlapping. </text:p><text:p>unlike many documentations, ST0 &lt;&gt; MM7</text:p><text:p/><text:p>before any operation, registers have the value assigned to themselves by the OS.</text:p><text:p>I collected these values</text:p><text:p>under windows, specific values it&apos;s not CPU specific, but the initial values of the register on process start-up, under windows, gives a few hint that are used by malwares.</text:p><text:p/><text:p>eax can immediately tell if you&apos;re on an older OS or not.</text:p><text:p>While GS can tell you if the machine is 64b or not, even in a 32b process.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="initvals" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr23" draw:text-style-name="P1" draw:layer="layout" svg:width="11.495cm" svg:height="16.412cm" svg:x="1.405cm" svg:y="0.821cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/10000201000003A5000005345696204C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr1" draw:text-style-name="P13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P1">initial values PoC</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="standard" draw:layer="layout" svg:width="7.249cm" svg:height="10.762cm" svg:x="15.027cm" svg:y="3.958cm"><table:table table:template-name="bw" table:use-first-row-styles="true"><table:table-column table:style-name="co1"/><table:table-column table:style-name="co2"/><table:table-column table:style-name="co3"/><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1"/><table:table-cell table:style-name="ce2"><text:p text:style-name="P1"><text:span text:style-name="T24">XP</text:span></text:p></table:table-cell><table:table-cell table:style-name="ce3"><text:p text:style-name="P1"><text:span text:style-name="T24">W7</text:span></text:p></table:table-cell></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce4"><text:p text:style-name="P1"><text:span text:style-name="T33">Flags</text:span></text:p></table:table-cell><table:table-cell table:style-name="ce5"/><table:table-cell table:style-name="ce6"/></table:table-row><table:table-row table:style-name="ro1" table:default-cell-style-name="ce8"><table:table-cell table:style-name="ce7" table:number-columns-spanned="3"><text:p text:style-name="P2"><text:span text:style-name="T24">TLS</text:span></text:p></table:table-cell><table:covered-table-cell/><table:covered-table-cell/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce9"><text:p text:style-name="P1">eax</text:p></table:table-cell><table:table-cell table:style-name="ce10"/><table:table-cell table:style-name="ce6"/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce9"><text:p text:style-name="P1">ecx</text:p></table:table-cell><table:table-cell table:style-name="ce11"/><table:table-cell table:style-name="ce6"/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce9"><text:p text:style-name="P1">edx</text:p></table:table-cell><table:table-cell table:style-name="ce10"/><table:table-cell table:style-name="ce12"/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce9"><text:p text:style-name="P1">ebx</text:p></table:table-cell><table:table-cell table:style-name="ce5"/><table:table-cell table:style-name="ce13"/></table:table-row><table:table-row table:style-name="ro1" table:default-cell-style-name="ce8"><table:table-cell table:style-name="ce14" table:number-columns-spanned="3"><text:p><text:span text:style-name="T24">EntryPoint</text:span></text:p></table:table-cell><table:covered-table-cell/><table:covered-table-cell/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce9"><text:p text:style-name="P1">eax</text:p></table:table-cell><table:table-cell table:style-name="ce5"/><table:table-cell table:style-name="ce12"/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce9"><text:p text:style-name="P1">ecx</text:p></table:table-cell><table:table-cell table:style-name="ce15"/><table:table-cell table:style-name="ce6"/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce16"><text:p text:style-name="P1">edx</text:p></table:table-cell><table:table-cell table:style-name="ce17"/><table:table-cell table:style-name="ce18"/></table:table-row></table:table><draw:image xlink:href="Pictures/TablePreview1.svm" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"/></draw:frame><draw:frame draw:style-name="standard" draw:layer="layout" svg:width="3.525cm" svg:height="3.635cm" svg:x="23.319cm" svg:y="14.13cm"><table:table table:template-name="default" table:use-first-row-styles="true" table:use-banding-rows-styles="true"><table:table-column table:style-name="co4"/><table:table-row table:style-name="ro2"><table:table-cell table:style-name="ce19"><text:p text:style-name="P2"><text:span text:style-name="T34">fully ctrl-ed</text:span></text:p></table:table-cell></table:table-row><table:table-row table:style-name="ro2"><table:table-cell table:style-name="ce20"><text:p text:style-name="P2"><text:span text:style-name="T35">controlled</text:span></text:p></table:table-cell></table:table-row><table:table-row table:style-name="ro2"><table:table-cell table:style-name="ce21"><text:p text:style-name="P2"><text:span text:style-name="T36">fixed</text:span></text:p></table:table-cell></table:table-row><table:table-row table:style-name="ro2"><table:table-cell table:style-name="ce22"><text:p text:style-name="P2"><text:span text:style-name="T37">range</text:span></text:p></table:table-cell></table:table-row></table:table><draw:image xlink:href="Pictures/TablePreview2.svm" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"/></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="42" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>I created a PoC that just gets all registers from EP and TLS, and checks the validity of result.</text:p><text:p/><text:p>easy check see if a malware/tool is interfering with the loading process.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="smsw" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:text-style-name="P22" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T19">smsw</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>CR0 access, from user-mode</text:p><text:list><text:list-item><text:p>286 opcode</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>higher word of reg32 &apos;undefined&apos;</text:p></text:list-item><text:list-item><text:p>under XP</text:p><text:list><text:list-item><text:p>influenced by FPU</text:p></text:list-item><text:list-item><text:p>eventually reverts</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="43" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T9">smsw is an old 286-era mnemonic (before protected mode was &apos;complete&apos;): it allows usermode access to cr0.</text:span></text:p><text:p><text:span text:style-name="T9">the higher word of a reg32 target is &apos;undefined&apos;, yet always modified (and same as cr0)</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">under XP, right after an FPU operation, the returned value is modified [bits 1 and 3, called MP (Monitor Coprocessor) and TS (Task switched)], but eventually reverted after some time.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">too tricky ? redirection fails. any idea why ?</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="smsw demo" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr24" draw:text-style-name="P24" draw:layer="layout" svg:width="21.59cm" svg:height="7.973cm" svg:x="2.705cm" svg:y="1.015cm"><draw:text-box><text:p><text:span text:style-name="T38">DEMO</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="16.081cm" svg:height="7.772cm" svg:x="0.46cm" svg:y="8.89cm"><draw:image xlink:href="Pictures/100002010000029600000140326483A9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="9.525cm" svg:height="6.077cm" svg:x="17.145cm" svg:y="9.525cm"><draw:image xlink:href="Pictures/1000020100000130000000C297ED4AB1.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="44" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>demo of smsw:</text:p><text:list text:style-name="L2"><text:list-item><text:p>undocumented behavior</text:p></text:list-item><text:list-item><text:p>fpu relation (xp)</text:p></text:list-item><text:list-item><text:p>redirection weirdness</text:p></text:list-item></text:list></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="gs" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>GS</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>unused on Windows 32b</text:p><text:list><text:list-item><text:p>on 64b: FS, GS = TEB32, TEB64</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>reset on thread switch</text:p><text:list><text:list-item><text:p>eventually reset</text:p><text:list><text:list-item><text:p><text:span text:style-name="T32">debugger stepping</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T32">wait</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T32">timings</text:span></text:p></text:list-item></text:list><text:p><text:span text:style-name="T32"/></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="45" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>the GS trick is similar.</text:p><text:list text:style-name="L2"><text:list-item><text:p>on 32b of windows, GS is reset on thread switch.</text:p></text:list-item><text:list-item><text:p>on 64b windows, it&apos;s already used by the OS (value non null at start)</text:p></text:list-item></text:list><text:p/><text:p>ie wait long enough, it&apos;s null, whatever the value before.</text:p><text:p/><text:p>if you just step manually, instantly lost.</text:p><text:p>after some time, but not a too short time, it&apos;s reset</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="gs demo" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr24" draw:text-style-name="P24" draw:layer="layout" svg:width="21.59cm" svg:height="7.973cm" svg:x="2.705cm" svg:y="2.015cm"><draw:text-box><text:p><text:span text:style-name="T38">DEMO</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="22.569cm" svg:height="6.349cm" svg:x="2.216cm" svg:y="10.796cm"><draw:image xlink:href="Pictures/100002010000038A000000FF8BEEA0BD.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="46" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>demo of all GS features</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="nop" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:text-style-name="P22" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T19">nop</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="24.299cm" svg:height="11.822cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T19">nop</text:span> is <text:span text:style-name="T19">xchg *ax, *ax</text:span></text:p><text:list><text:list-item><text:p>but <text:span text:style-name="T19">xchg *ax, *ax</text:span> can <text:span text:style-name="T25">do</text:span> something, in 64b !</text:p><text:list><text:list-header><text:p text:style-name="P2">87 c0: xchg eax, eax</text:p></text:list-header></text:list></text:list-item></text:list></text:list-item></text:list><text:p text:style-name="P13"><text:span text:style-name="T39">.. .. .. .. </text:span><text:span text:style-name="T40">01 23 45 67</text:span><text:span text:style-name="T39"> =&gt; </text:span><text:span text:style-name="T40">00 00 00 00 01 23 45 67</text:span></text:p><text:list text:continue-numbering="true" text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T19">hint nop </text:span><text:span text:style-name="T41">0F1E84C090909090 nop dword ptr [eax+eax*8-0x6f6f6f70], eax</text:span></text:p><text:list><text:list-item><text:p>partially undocumented, actually 0f 18-1f</text:p></text:list-item><text:list-item><text:p>can trigger exception</text:p></text:list-item></text:list><text:p/><text:p/></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="47" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>xchg eax, eax is 90, which originally did nothing.</text:p><text:p>(xchg eax, ecx is 91)</text:p><text:p>thus 90 became nop</text:p><text:p>but 87 c0 is an xchg eax, eax that is not a nop and does something in 64b, as it resets the upper dword.</text:p><text:p/><text:p>hint nop gives hint of what to access next. it does nothing, but it&apos;s multi-byte. </text:p><text:p>first, it&apos;s not completely documented by intel</text:p><text:p>and, being a multi-byte opcode, if it overlaps an invalid page, it can trigger an exception!</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="mov" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:text-style-name="P22" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T19">mov</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="24.299cm" svg:height="11.629cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>documented, but sometimes tricky</text:p><text:list><text:list-item><text:p><text:span text:style-name="T19">mov [cr0], eax</text:span><text:span text:style-name="T19"><text:tab/></text:span><text:span text:style-name="T19"><text:tab/></text:span><text:span text:style-name="T19">mov cr0, eax</text:span></text:p><text:list><text:list-item><text:p>mod/RM is ignored</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T19">movsxd eax, ecx</text:span><text:span text:style-name="T19"><text:tab/></text:span><text:span text:style-name="T19"><text:tab/></text:span><text:span text:style-name="T19">mov eax, ecx</text:span></text:p><text:list><text:list-item><text:p>no REX prefix</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T19">mov eax, cs</text:span><text:span text:style-name="T19"><text:tab/></text:span><text:span text:style-name="T19"><text:tab/></text:span><text:span text:style-name="T19"><text:tab/></text:span><text:span text:style-name="T19">movzx eax,cs</text:span></text:p><text:list><text:list-item><text:p>&apos;undefined&apos; upper word</text:p></text:list-item></text:list></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="48" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>Mov is documented, but has a few quirks.</text:p><text:p>* to/from control and debug registers, memory operands are not allowed. but not rejected !</text:p><text:p>* in 64b, with no REX prefix, movsxd can actually work to and from a 32b register, which is against the logic of &apos;sign extending&apos;</text:p><text:p>* on the contrary, mov from a selector actually affects a complete 32b register. the upper word is theoretically undefined, but actually 0 (used by malware to see if upper part is actually reset or if wrongly emulated as &apos;mov ax, cs&apos;.)</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="cr0 demo" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.067cm" svg:height="12.989cm" svg:x="1.476cm" svg:y="4.445cm"><draw:image xlink:href="Pictures/100002010000067E00000381F515F151.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p>non standard CR0 access</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="49" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>smsw (undocumented) gives full cr0 access.</text:p><text:p>then cr0 access with &apos;ignored&apos; Mod/RM</text:p><text:p>then standard cr0 access...</text:p><text:p/><text:p>same results, in all 3 cases.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="bswap" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T19">bswap</text:span><text:tab/></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>rax</text:p><text:p text:style-name="P1"><text:span text:style-name="T40">12 34 56 78 90 ab cd ef</text:span><text:span text:style-name="T42"> =&gt; </text:span><text:span text:style-name="T40">ef cd ab 90 78 56 34 12</text:span></text:p><text:p text:style-name="P2">eax</text:p><text:p text:style-name="P1"><text:span text:style-name="T39">.. .. .. .. </text:span><text:span text:style-name="T40">01 23 45 67 </text:span><text:span text:style-name="T42">=&gt; </text:span><text:span text:style-name="T40">00 00 00 00 67 45 23 01</text:span></text:p><text:p text:style-name="P2">ax</text:p><text:p text:style-name="P1"><text:span text:style-name="T39">.. .. .. .. .. .. </text:span><text:span text:style-name="T40">01 23</text:span><text:span text:style-name="T42"> =&gt; </text:span><text:span text:style-name="T39">.. .. .. .. .. .. </text:span><text:span text:style-name="T40">00 00</text:span></text:p><text:p text:style-name="P2"><text:span text:style-name="T43"/></text:p><text:p text:style-name="P1"><text:span text:style-name="T44"/></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="50" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>Bswap... is like an administration... rules prevent it to work correctly most of the time...</text:p><text:p/><text:p>it&apos;s supposed to swap the endianness of a register.</text:p><text:p/><text:p>but most of the time, it does something unexpected.</text:p><text:p/><text:p>with a 64b register, it swaps the quadword around. good.</text:p><text:p/><text:p>with a 32b, it resets the highest dword. &apos;as usual&apos;, of course...</text:p><text:p/><text:p>and on 16b, it&apos;s &apos;undefined&apos; but it just clears the 16b register itself (the rest stays unchanged, of course)...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="demo 32 &amp; 64" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="21.76cm" svg:height="6.984cm" svg:x="2.62cm" svg:y="10.795cm"><draw:image xlink:href="Pictures/10000201000003CC00000138952C3B80.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr24" draw:text-style-name="P25" draw:layer="layout" svg:width="21.59cm" svg:height="7.973cm" svg:x="2.705cm" svg:y="5.014cm"><draw:text-box><text:p><text:span text:style-name="T45">DEMO</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="25.4cm" svg:height="3.897cm" svg:x="0.8cm" svg:y="1.905cm"><draw:image xlink:href="Pictures/100002010000071A000001173485DBE5.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="51" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P8">demo of nop / mov / bswap, in both 32b and 64b</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="push/ret 1" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T19">push</text:span>+<text:span text:style-name="T19">ret</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="26.256cm" svg:height="4.173cm" svg:x="0.372cm" svg:y="6.914cm"><draw:image xlink:href="Pictures/10000201000005E5000000F0FD54E193.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="52" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>anyone knows what will happen here ?</text:p><text:p/><text:p>push, ret.</text:p><text:p>put an address on the stack, pop it and jump to it.</text:p><text:p/><text:p>no possible trick, right...</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="push/ret 2" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr24" draw:text-style-name="P24" draw:layer="layout" svg:width="21.59cm" svg:height="7.973cm" svg:x="2.705cm" svg:y="1.015cm"><draw:text-box><text:p><text:span text:style-name="T38">DEMO</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="26.407cm" svg:height="5.39cm" svg:x="0.296cm" svg:y="9.85cm"><draw:image xlink:href="Pictures/10000201000006A80000015CFEEABDC4.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="53" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, what happened ?</text:p><text:p>olly even auto-comments the ret!</text:p><text:p/><text:p>the 66: before the RETN makes return to IP, not EIP.</text:p><text:p/><text:p>so here we returned to 1008, not 401008.</text:p><text:p/><text:p>the other problem is that while different, there is no official name for this ret to word, &apos;small ret&apos;, &apos;ret16&apos;....</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="and so on..." draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>...and so on...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>much more @ <text:a xlink:href="http://x86.corkami.com/">http://x86.corkami.com</text:a></text:p><text:list><text:list-item><text:p>also graphs, cheat sheet...</text:p></text:list-item></text:list><text:p/></text:list-item><text:list-item><text:p>too much theory for now...</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="54" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>I won&apos;t enumerate them all.</text:p><text:p>they&apos;re already on Corkami, with some other x86 stuff that might be useful to print.</text:p><text:p/><text:p>too much theory with no practice never gives good results...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="Cost" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr10" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T46">Co</text:span>rkami <text:span text:style-name="T46">S</text:span>tandard <text:span text:style-name="T46">T</text:span>est</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="55" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so I created CoST.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="cost presentation" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>CoST</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p><text:a xlink:href="http://cost.corkami.com/">http://cost.corkami.com</text:a></text:p></text:list-item><text:list-item><text:p>testing opcodes</text:p></text:list-item><text:list-item><text:p>in a hardened PE</text:p><text:list><text:list-item><text:p>available in easy mode</text:p><text:p/></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="56" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>an opcode tester, in a tricky PE.</text:p><text:p>available in easy mode compile (less tricky), as CoST is quite difficult to debug :)</text:p><text:p/><text:p>just run, and it roughly displays what happened.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="cost tests" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>more than 150 tests</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>classic, rare</text:p></text:list-item><text:list-item><text:p>jumps (JMP to IP, IRET, …)</text:p></text:list-item><text:list-item><text:p>undocumented (IceBP, SetALc...)</text:p></text:list-item><text:list-item><text:p>cpu-specific (MOVBE, POPCNT,...)</text:p></text:list-item><text:list-item><text:p>os-dependant, anti-VM/debugs</text:p></text:list-item><text:list-item><text:p>exceptions triggers, interrupts, OS bugs,...</text:p></text:list-item><text:list-item><text:p>...</text:p></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="9.549cm" svg:height="1.93cm" svg:x="16.51cm" svg:y="4.445cm"><draw:image xlink:href="Pictures/100000000000010900000031AB4BA03C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="57" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, it contains a lot of various tests... (150 is the lower margin, depend how you count)</text:p><text:p/><text:p>some trivial... some less trivial.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="CoST demo" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr23" draw:text-style-name="P1" draw:layer="layout" svg:width="15.894cm" svg:height="9.745cm" svg:x="0.31cm" svg:y="3.255cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/10000000000001E60000012A0314162B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="26.365cm" svg:height="2.903cm" svg:x="0.318cm" svg:y="13.556cm"><draw:image xlink:href="Pictures/10000000000002780000004A139D2643.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>CoST&apos;s internals</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="14.072cm" svg:height="7.861cm" svg:x="12.979cm" svg:y="3.569cm"><draw:image xlink:href="Pictures/100000000000014E000000CA34989154.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="58" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>Cost just gives some output when ran from the command line.</text:p><text:p/><text:p>but actually it gives much more output on debug output.</text:p><text:p/><text:p>even if the binary is hand-made, it&apos;s self documented, via one-line calls to VEH printing, and internal exports for different internal chapters.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="96 bits" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>32+64 = ...</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.97cm" svg:height="12.064cm" svg:x="1.015cm" svg:y="4.445cm"><draw:image xlink:href="Pictures/100002010000054C000002B262C97E2B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="59" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>here is my favorite part of CoST:</text:p><text:p/><text:p>anyone sees what this is doing ?</text:p><text:p/><text:p>executing code at push_eip...</text:p><text:p>then the same code with selector 33 (64b code)</text:p><text:p/><text:p>so the same opcodes are executed twice, first in 32b mode, then in 64b.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="96 bits demo" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="23.78cm" svg:height="3.994cm" svg:x="1.61cm" svg:y="12.97cm"><draw:image xlink:href="Pictures/10000201000003AC0000009E56C62559.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="20.08cm" svg:height="8.255cm" svg:x="3.46cm" svg:y="2.31cm"><draw:image xlink:href="Pictures/100000000000021C000000DE543A7BD2.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:custom-shape draw:style-name="gr21" draw:text-style-name="P1" draw:layer="layout" svg:width="2.54cm" svg:height="3.175cm" svg:x="12.23cm" svg:y="10.255cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:text-areas="?f0 0 ?f2 ?f5" draw:type="down-arrow" draw:modifiers="16200 5400" draw:enhanced-path="M ?f0 0 L ?f0 ?f1 0 ?f1 10800 21600 21600 ?f1 ?f2 ?f1 ?f2 0 Z N"><draw:equation draw:name="f0" draw:formula="$1 "/><draw:equation draw:name="f1" draw:formula="$0 "/><draw:equation draw:name="f2" draw:formula="21600-$1 "/><draw:equation draw:name="f3" draw:formula="21600-?f1 "/><draw:equation draw:name="f4" draw:formula="?f3 *?f0 /10800"/><draw:equation draw:name="f5" draw:formula="?f1 +?f4 "/><draw:equation draw:name="f6" draw:formula="?f1 *?f0 /10800"/><draw:equation draw:name="f7" draw:formula="?f1 -?f6 "/><draw:handle draw:handle-position="$1 $0" draw:handle-range-x-minimum="0" draw:handle-range-x-maximum="10800" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="21600"/></draw:enhanced-geometry></draw:custom-shape><draw:frame draw:style-name="gr24" draw:text-style-name="P25" draw:layer="layout" svg:width="21.59cm" svg:height="7.973cm" svg:x="2.705cm" svg:y="5.014cm"><draw:text-box><text:p><text:span text:style-name="T45">DEMO</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="60" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">and these opcodes gives exclusive mnemonics to each side...</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">works fine under a 64b OS.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">same EIP, same opcodes, twice, and different code.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="Cost vs WinDbg &amp; Hiew" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>CoST vs WinDbg &amp; Hiew</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T20">WinDbg 6.12.0002.633</text:span></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20"/></text:p><text:p><text:span text:style-name="T20">Hiew 8.15</text:span></text:p><text:p/></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="16.329cm" svg:height="3.81cm" svg:x="5.336cm" svg:y="12.7cm"><draw:image xlink:href="Pictures/10000000000001B500000066E9A803FC.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="17.747cm" svg:height="5.502cm" svg:x="4.627cm" svg:y="5.293cm"><draw:image xlink:href="Pictures/10000201000002EC000000E8EFC7C161.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="61" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>as you&apos;d expect, WinDbg, following Intel docs too closely, will give you &apos;??&apos;</text:p><text:p/><text:p>Hiew does that too a little.</text:p><text:p/><text:p>but honestly, I found bugs in all disassemblers I looked at, no exception AFAIR. Even a crash in XED.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="Cost&apos;s PE" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>a hardened PE</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="1.526cm" svg:height="0.963cm" svg:x="7.35cm" svg:y="15.912cm"><draw:text-box><text:p>Top</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="3.393cm" svg:height="0.963cm" svg:x="15.24cm" svg:y="15.912cm"><draw:text-box><text:p>PE &apos;footer&apos;</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="6.682cm" svg:height="11.43cm" svg:x="4.717cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/100002010000019E000002C41944B023.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="6.32cm" svg:height="11.43cm" svg:x="13.96cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/100002010000012400000210742992AD.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="62" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>CoST was originally only an opcode tester.</text:p><text:p/><text:p>then I added a few PE tricks...</text:p><text:p/><text:p>have a look yourself, the top of the file, and the PE header (right at the bottom)</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="Cost vs IDA" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>CoST vs IDA</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="12.652cm" svg:height="4.445cm" svg:x="1.568cm" svg:y="4.445cm"><draw:image xlink:href="Pictures/100000000000017200000082FEA0CB36.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="13.649cm" svg:height="3.543cm" svg:x="1.07cm" svg:y="13.602cm"><draw:image xlink:href="Pictures/1000000000000204000000861500F6C5.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="10.792cm" svg:height="3.438cm" svg:x="2.498cm" svg:y="9.525cm"><draw:image xlink:href="Pictures/100000000000019800000082921D853F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="7.565cm" svg:height="4.099cm" svg:x="16.963cm" svg:y="11.335cm"><draw:image xlink:href="Pictures/100000000000011E0000009B579C37D9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="11.48cm" svg:height="5.395cm" svg:x="14.99cm" svg:y="4.445cm"><draw:image xlink:href="Pictures/10000000000001B2000000CCEACD8BF2.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="63" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>As you can see, IDA didn&apos;t really like it at first (fixed, now)</text:p><text:p/><text:p>So, if CoST helps you to find a few bugs in your program, I&apos;m not really surprised.</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="a bit more of PE" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr17" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p>a bit more of PE...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="64" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>but one single file, even full of tricks, is not enough to express all the possibilities of the PE file.</text:p><text:p/><text:p>so I created more.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="PE on corkami" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>PE on Corkami</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>still in progress</text:p></text:list-item><text:list-item><text:p>more than 120 PoCs</text:p><text:list><text:list-item><text:p>covering many aspects</text:p></text:list-item><text:list-item><text:p>good enough to break &lt;you name it&gt;</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>&apos;summary&apos; page <text:a xlink:href="http://pe.corkami.com/">http://pe.corkami.com</text:a></text:p></text:list-item><text:list-item><text:p>printable graphs</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="65" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>I already made some useful graphs for PE files.</text:p><text:p/><text:p>and I started a wiki page, with more than 120 PoCs, focusing, as usual, on precise aspects of the PE.</text:p><text:p/><text:p>PE with no section, with 64k sections, with huge ImageBase, relocation encryption...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="virtsectbl vs hiew" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>virtual section table vs Hiew</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="25.736cm" svg:height="13.335cm" svg:x="0.635cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/10000000000003F0000002203D246F19.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="66" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>in low alignments, the section table is checked but not used at all.</text:p><text:p>so, if it&apos;s full of zeroes, it will still work – under XP.</text:p><text:p/><text:p>thus, with SizeOfOptionalHeader, you can set it in virtual space...</text:p><text:p/><text:p>Hiew doesn&apos;t like that.</text:p><text:p>check the picture, it doesn&apos;t even identify it as a PE.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="Folded vs Hiew" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Folded header</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="18.493cm" svg:height="13.261cm" svg:x="4.254cm" svg:y="3.885cm"><draw:image xlink:href="Pictures/10000201000003420000025663845D87.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="67" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>what do you think ?</text:p><text:p/><text:p>when you can do ASCII art with the PE info, something dodgy is going on :)</text:p><text:p/><text:p>this is ReversingLabs&apos; dual PE header.</text:p><text:p>the PE header is partially overwritten (at exports directories) on loading. </text:p><text:p/><text:p>the upper part is read from disk, the lower part, read in memory, is overwritten by the section that is folded over the bottom of the header.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="weird exports" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>Weird export names</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>exports = &lt;anything non null&gt;, 0</text:p></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.388cm" svg:height="6.987cm" svg:x="1.307cm" svg:y="7.507cm"><draw:image xlink:href="Pictures/10000201000004720000014644D28CFC.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="68" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>export names can be anything until 0, or even null.</text:p><text:p/><text:p>Hiew displays them inline, so, well, here is the PoC of weird export names</text:p><text:p/><text:p>one of the other names in this PoC is LOOOONG enough to trigger a buffer overflow &gt;:)</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="65k sec vs Olly" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>65535 sections vs OllyDbg</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.299cm" svg:height="9.14cm" svg:x="1.349cm" svg:y="5.581cm"><draw:image xlink:href="Pictures/100002010000026E000000EA31732480.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="69" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>this is a 64k section PE against the latest Olly.</text:p><text:p/><text:p>amazingly, it doesn&apos;t crash despite this funny message...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="TlsAoI" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>a last one...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="12.989cm" svg:x="1.351cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>TLS AddressOfIndex is overwritten on loading</text:p></text:list-item><text:list-item><text:p>Imports are parsed until Name is 0</text:p><text:p/></text:list-item><text:list-item><text:p>under XP, overwritten after imports</text:p><text:list><text:list-item><text:p>imports are fully parsed</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>under W7, before</text:p><text:list><text:list-item><text:p>truncated</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p text:style-name="P1"><text:span text:style-name="T47">same PE, loaded differently</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="7.216cm" svg:height="4.445cm" svg:x="19.454cm" svg:y="5.715cm"><draw:image xlink:href="Pictures/10000000000000B900000072E3171E25.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="8.787cm" svg:height="3.067cm" svg:x="17.78cm" svg:y="10.795cm"><draw:image xlink:href="Pictures/10000000000001910000008C39C31B10.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="70" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>this one is not very visual, yet quite unique.</text:p><text:p/><text:p>TLS AoI points to an Import descriptor Name member...</text:p><text:p/><text:p>depending on AoI or imports happening first, this is a terminator or not...</text:p><text:p/><text:p>so the same PE gets loaded with more or less imports depending on the OS.</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="conclusion 1" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Conclusion (1/2)</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>x86 and PE are far from perfectly documented </text:p><text:p text:style-name="P1"><text:span text:style-name="T48"/></text:p><text:p text:style-name="P1"><text:span text:style-name="T49">official docs </text:span><text:span text:style-name="T50"></text:span><text:span text:style-name="T49"> FAIL</text:span></text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="71" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">unlike what I used to believe, cpus and windows binaries are far from perfectly logical nor documented</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">If you only follow the official doc, you&apos;re bound to fail. especially with the malware landscape out there.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="conclusion 2" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Conclusion (2/2)</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L4"><text:list-item><text:p>visit Corkami</text:p></text:list-item><text:list-item><text:p>download the PoCs</text:p></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:list><text:list-item><text:p>read the doc / source</text:p></text:list-item></text:list></text:list-item></text:list><text:list text:style-name="L4"><text:list-item><text:p>fix the bugs ;)</text:p></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:list><text:list-item><text:p>or answer my bug reports ?#$!</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="72" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so give Corkami PoCs a try – and send me a postcard if you found some bugs</text:p><text:p/><text:p>I seriously hope that MS will put WinDbg back to a more reactive release cycle, and will update it...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="ack, question" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Acknowledgments</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>Peter Ferrie</text:p></text:list-item><text:list-item><text:p>Ivanlef0u</text:p></text:list-item></text:list><text:p><text:span text:style-name="T51">Adam Błaszczyk, BeatriX, Bruce Dang, Candid Wüest, Cathal Mullaney, Czerno, Daniel Reynaud, Elias Bachaalany, Ero Carrera, Eugeny Suslikov, Georg Wicherski, Gil Dabah, Guillaume Delugré, Gunther, Igor Skochinsky, Ilfak Guilfanov, Ivanlef0u, Jean-Baptiste Bédrune, Jim Leonard, Jon Larimer, Joshua J. Drake, Markus Hinderhofer, Mateusz Jurczyk, Matthieu Bonetti, Moritz Kroll, Oleh Yuschuk, Renaud Tabary, Rewolf, Sebastian Biallas, StalkR, Yoann Guillot,...</text:span></text:p><text:p><text:span text:style-name="T51"/></text:p><text:p text:style-name="P1"><text:span text:style-name="T49">Questions?</text:span></text:p><text:p text:style-name="P1"><text:span text:style-name="T52"/></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="73" presentation:class="page"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>Eternal thanks to Peter Ferrie, my permanent reviewer.</text:p><text:p>Ivanlef0u is also very helpful.</text:p><text:p/><text:p>a lot of people helped me in the process to make this presentation and the content on corkami, in one way or another.</text:p><text:p/><text:p>Any questions?</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="thank you" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL1T0"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr20" draw:text-style-name="P26" draw:layer="layout" svg:width="24.692cm" svg:height="10.111cm" svg:x="1.155cm" svg:y="1.27cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T53">Thank YOU!</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr21" draw:text-style-name="P27" draw:layer="layout" svg:width="10.036cm" svg:height="2.54cm" svg:x="8.482cm" svg:y="10.16cm"><draw:text-box><text:p><text:span text:style-name="T54"><text:a xlink:href="http://twitter.com/ange4771">@ange4771</text:a></text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="74" presentation:class="page"/><draw:frame presentation:style-name="pr2" draw:text-style-name="P8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T9">Thanks for your attention. I hope you liked it.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="bonus - pocs" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.006cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>Bonus</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="24.299cm" svg:height="11.629cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>Mips relocs (on relocs)</text:p></text:list-item><text:list-item><text:p>ImageBase reloc</text:p></text:list-item><text:list-item><text:p>multi-subsystem PE</text:p></text:list-item><text:list-item><text:p>regs on TLS &amp; DllMain</text:p></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="7.565cm" svg:height="4.099cm" svg:x="19.05cm" svg:y="1.905cm"><draw:image xlink:href="Pictures/100000000000011E0000009B32271F74.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="19.734cm" svg:height="3.438cm" svg:x="1.856cm" svg:y="13.707cm"><draw:image xlink:href="Pictures/10000000000002EA00000082548C9877.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P1" draw:layer="layout" svg:width="10.45cm" svg:height="6.428cm" svg:x="13.335cm" svg:y="6.35cm"><draw:image xlink:href="Pictures/100000000000018B000000F365D28813.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="75" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.673cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>mips relocs are still working, even with x86 CPU and PE. and relocs apply on relocs data themselves... so does my PoC</text:p><text:p/><text:p>adding an extra relocation on the imagebase doesn&apos;t influence the loading (the PE is already mapped), but it interferes with the EP calculation.</text:p><text:p/><text:p>Drivers are just low alignment PEs with different import. so I made a PE with low alig and no imports, that detects how it&apos;s ran, and resolves its own imports accordingly</text:p><text:p/><text:p>on TLS and DLLMain return, only ESI and EIP have to be correct, so my PoC corrupts everything else... IDA didn&apos;t like a weird ESP...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><presentation:settings presentation:mouse-visible="false"/></office:presentation></office:body></office:document-content>