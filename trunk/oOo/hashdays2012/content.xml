<?xml version="1.0" encoding="UTF-8"?>
<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:smil="urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0" xmlns:anim="urn:oasis:names:tc:opendocument:xmlns:animation:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" office:version="1.2" grddl:transformation="http://docs.oasis-open.org/office/1.2/xslt/odf2rdf.xsl"><office:scripts/><office:automatic-styles><style:style style:name="dp1" style:family="drawing-page"><style:drawing-page-properties presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp2" style:family="drawing-page"><style:drawing-page-properties presentation:display-header="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp3" style:family="drawing-page"><style:drawing-page-properties presentation:visibility="hidden" presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="false" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp4" style:family="drawing-page"><style:drawing-page-properties presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="false" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp5" style:family="drawing-page"><style:drawing-page-properties presentation:visibility="hidden" presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="gr1" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr2" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="true" fo:min-height="0.68cm" fo:min-width="0cm"/></style:style><style:style style:name="gr3" style:family="graphic"><style:graphic-properties style:protect="size"/></style:style><style:style style:name="gr4" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="true" fo:min-height="0cm" fo:min-width="0cm"/></style:style><style:style style:name="gr5" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="false" fo:min-height="1.348cm" fo:min-width="10.9cm"/></style:style><style:style style:name="gr6" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:fill="solid" draw:fill-color="#000000" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle"/></style:style><style:style style:name="gr7" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0cm" draw:marker-start-width="0.305cm" draw:marker-end-width="0.305cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 1.971cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr8" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr9" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="false" fo:min-height="0.742cm" fo:min-width="10.9cm"/></style:style><style:style style:name="gr10" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.203cm" svg:stroke-color="#ff0000" draw:marker-start-width="0.503cm" draw:marker-end-width="0.503cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.225cm" fo:padding-bottom="0.225cm" fo:padding-left="0.35cm" fo:padding-right="0.35cm"/></style:style><style:style style:name="gr11" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(1.605cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr12" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(3.835cm, 0cm, 0.432cm, 5.225cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr13" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr14" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 2.692cm, 0cm, 1.346cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr15" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(1.016cm, 0cm, 1.016cm, 4.039cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr16" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(1.803cm, 2.692cm, 0cm, 6.731cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr17" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 5.08cm, 0cm, 4.064cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr18" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr19" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.102cm" draw:marker-start-width="0.457cm" draw:marker-end-width="0.457cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr20" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.152cm" draw:marker-start-width="0.427cm" draw:marker-end-width="0.427cm" draw:fill="none" draw:textarea-horizontal-align="justify" draw:textarea-vertical-align="middle" draw:auto-grow-height="false" fo:padding-top="0.2cm" fo:padding-bottom="0.2cm" fo:padding-left="0.325cm" fo:padding-right="0.325cm"/></style:style><style:style style:name="gr21" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:auto-grow-height="true" draw:auto-grow-width="false" fo:max-height="0cm" fo:min-height="0cm"/></style:style><style:style style:name="gr22" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dotted" svg:stroke-width="0.152cm" draw:marker-start-width="0.427cm" draw:marker-end-width="0.427cm" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.2cm" fo:padding-bottom="0.2cm" fo:padding-left="0.325cm" fo:padding-right="0.325cm"/></style:style><style:style style:name="gr23" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.102cm" draw:marker-start-width="0.352cm" draw:marker-end-width="0.352cm" draw:fill="none" draw:textarea-horizontal-align="justify" draw:textarea-vertical-align="middle" draw:auto-grow-height="false" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm"/></style:style><style:style style:name="gr24" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.102cm" draw:marker-start-width="0.352cm" draw:marker-end-width="0.352cm" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm"/></style:style><style:style style:name="gr25" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke-dash="Fine_20_Dashed" svg:stroke-width="0.152cm" draw:marker-start-width="0.427cm" draw:marker-end-width="0.427cm" draw:fill="none" draw:textarea-horizontal-align="justify" draw:textarea-vertical-align="middle" draw:auto-grow-height="false" fo:padding-top="0.2cm" fo:padding-bottom="0.2cm" fo:padding-left="0.325cm" fo:padding-right="0.325cm"/></style:style><style:style style:name="gr26" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dashed" svg:stroke-width="0.102cm" draw:marker-start-width="0.352cm" draw:marker-end-width="0.352cm" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm"/></style:style><style:style style:name="gr27" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="true" fo:min-height="0cm" fo:min-width="3.944cm"/></style:style><style:style style:name="gr28" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dotted" svg:stroke-width="0.051cm" draw:marker-start-width="0.276cm" draw:marker-end-width="0.276cm" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr29" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="hidden" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr30" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr31" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr32" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.102cm" draw:marker-start-width="0.352cm" draw:marker-end-width="0.352cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm"/></style:style><style:style style:name="gr33" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dotted" svg:stroke-width="0.102cm" draw:marker-start-width="0.352cm" draw:marker-end-width="0.352cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm"/></style:style><style:style style:name="gr34" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.051cm" draw:marker-start-width="0.276cm" draw:marker-end="Arrow" draw:marker-end-width="0.376cm" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr35" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.102cm" draw:marker-start-width="0.352cm" draw:marker-end="Arrow" draw:marker-end-width="0.452cm" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.175cm" fo:padding-bottom="0.175cm" fo:padding-left="0.3cm" fo:padding-right="0.3cm"/></style:style><style:style style:name="gr36" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties svg:stroke-width="0.152cm" svg:stroke-color="#ff0000" draw:marker-start-width="0.427cm" draw:marker-end-width="0.427cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.2cm" fo:padding-bottom="0.2cm" fo:padding-left="0.325cm" fo:padding-right="0.325cm"/></style:style><style:style style:name="gr37" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr38" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr39" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr40" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="false" fo:min-height="4.196cm" fo:min-width="7.755cm"/></style:style><style:style style:name="gr41" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="true" fo:min-height="0cm" fo:min-width="0cm"/></style:style><style:style style:name="gr42" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(2.445cm, 1.546cm, 0cm, -0.001cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr43" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.051cm" draw:marker-start-width="0.381cm" draw:marker-end-width="0.381cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(4.496cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr44" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:shadow="visible" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 8.467cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="pr1" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="3.005cm"/></style:style><style:style style:name="pr2" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" draw:auto-grow-height="true" fo:min-height="12.573cm"/></style:style><style:style style:name="pr3" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="3.256cm"/></style:style><style:style style:name="pr4" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="13.609cm"/></style:style><style:style style:name="pr5" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="12.572cm"/></style:style><style:style style:name="pr6" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="3.506cm"/></style:style><style:style style:name="pr7" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="13.859cm"/></style:style><style:style style:name="pr8" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" draw:auto-grow-height="true" fo:min-height="17.935cm"/></style:style><style:style style:name="pr9" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="17.935cm"/></style:style><style:style style:name="pr10" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill="none" draw:fill-color="#ffffff" fo:min-height="17.935cm"/></style:style><style:style style:name="pr11" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill="none" draw:fill-color="#ffffff" fo:min-height="3.855cm"/></style:style><style:style style:name="pr12" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill="none" draw:fill-color="#ffffff" fo:min-height="2.594cm"/></style:style><style:style style:name="pr13" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="12.322cm"/></style:style><style:style style:name="pr14" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="4.242cm"/></style:style><style:style style:name="pr15" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="1.95cm"/></style:style><style:style style:name="pr16" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill="none" draw:fill-color="#ffffff" fo:min-height="4.49cm"/></style:style><style:style style:name="pr17" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="3.506cm"/></style:style><style:style style:name="pr18" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="13.859cm"/></style:style><style:style style:name="pr19" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="13.86cm"/></style:style><style:style style:name="pr20" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="3.507cm"/></style:style><style:style style:name="pr21" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties fo:min-height="17.935cm"/></style:style><style:style style:name="pr22" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="11.103cm"/></style:style><style:style style:name="pr23" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="7.62cm"/></style:style><style:style style:name="pr24" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="4.984cm"/></style:style><style:style style:name="pr25" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="2.54cm"/></style:style><style:style style:name="pr26" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="17.685cm"/></style:style><style:style style:name="P1" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/></style:style><style:style style:name="P2" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="P3" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/></style:style><style:style style:name="P4" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="P5" style:family="paragraph"><style:text-properties fo:font-size="20pt"/></style:style><style:style style:name="P6" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/></style:style><style:style style:name="P7" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/><style:text-properties fo:color="#808080"/></style:style><style:style style:name="P8" style:family="paragraph"><style:text-properties fo:font-size="54pt" style:font-size-asian="54pt" style:font-size-complex="54pt"/></style:style><style:style style:name="P9" style:family="paragraph"><style:text-properties fo:color="#cccccc" fo:font-size="400pt" style:font-size-asian="400pt" style:font-size-complex="400pt"/></style:style><style:style style:name="P10" style:family="paragraph"><style:text-properties fo:font-size="96pt" fo:text-shadow="1pt 1pt" style:font-size-asian="96pt" style:font-size-complex="96pt"/></style:style><style:style style:name="P11" style:family="paragraph"><style:text-properties fo:color="#ff0000" fo:font-size="72pt" fo:text-shadow="none" fo:font-weight="bold" style:font-size-asian="72pt" style:font-weight-asian="bold" style:font-size-complex="72pt" style:font-weight-complex="bold"/></style:style><style:style style:name="P12" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/><style:text-properties fo:color="#000000" fo:font-size="72pt" fo:text-shadow="none" fo:font-weight="bold" style:font-size-asian="72pt" style:font-weight-asian="bold" style:font-size-complex="72pt" style:font-weight-complex="bold"/></style:style><style:style style:name="P13" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/><style:text-properties style:use-window-font-color="true" fo:font-size="36pt" fo:text-shadow="none" fo:font-weight="normal" style:font-size-asian="36pt" style:font-weight-asian="normal" style:font-size-complex="36pt" style:font-weight-complex="normal"/></style:style><style:style style:name="P14" style:family="paragraph"><style:text-properties fo:font-size="72pt" style:font-size-asian="72pt" style:font-size-complex="72pt"/></style:style><style:style style:name="P15" style:family="paragraph"><style:text-properties fo:font-size="88pt" style:font-size-asian="88pt" style:font-size-complex="88pt"/></style:style><style:style style:name="P16" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="88pt" style:font-size-asian="88pt" style:font-size-complex="88pt"/></style:style><style:style style:name="P17" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:font-size="88pt" style:font-size-asian="88pt" style:font-size-complex="88pt"/></style:style><style:style style:name="P18" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:color="#808080"/></style:style><style:style style:name="P19" style:family="paragraph"><style:text-properties style:text-line-through-style="solid"/></style:style><style:style style:name="P20" style:family="paragraph"><style:text-properties fo:color="#808080" fo:font-weight="normal" style:font-weight-asian="normal" style:font-weight-complex="normal"/></style:style><style:style style:name="P21" style:family="paragraph"><style:text-properties fo:color="#808080"/></style:style><style:style style:name="P22" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/><style:text-properties fo:color="#808080" fo:font-size="18pt"/></style:style><style:style style:name="P23" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/><style:text-properties fo:color="#ffffff"/></style:style><style:style style:name="P24" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/><style:text-properties fo:color="#ffffff" fo:text-shadow="1pt 1pt"/></style:style><style:style style:name="P25" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/><style:text-properties fo:color="#ffffff" fo:font-weight="normal" style:font-weight-asian="normal" style:font-weight-complex="normal"/></style:style><style:style style:name="P26" style:family="paragraph"><style:text-properties fo:color="#ffffff" fo:text-shadow="1pt 1pt" fo:font-weight="normal" style:font-weight-asian="normal" style:font-weight-complex="normal"/></style:style><style:style style:name="P27" style:family="paragraph"><style:paragraph-properties fo:margin-top="0cm" fo:margin-bottom="0cm"/></style:style><style:style style:name="P28" style:family="paragraph"><style:paragraph-properties fo:text-align="justify"/></style:style><style:style style:name="P29" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/><style:text-properties fo:font-size="100pt" fo:font-weight="normal" style:font-size-asian="100pt" style:font-weight-asian="normal" style:font-size-complex="100pt" style:font-weight-complex="normal"/></style:style><style:style style:name="P30" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:color="#00ffff" fo:font-size="72pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="72pt" style:font-weight-asian="bold" style:font-size-complex="72pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T1" style:family="text"><style:text-properties fo:font-size="60pt" style:font-size-asian="60pt" style:font-size-complex="60pt"/></style:style><style:style style:name="T2" style:family="text"><style:text-properties fo:font-size="48pt" style:font-size-asian="48pt" style:font-size-complex="48pt"/></style:style><style:style style:name="T3" style:family="text"><style:text-properties fo:font-size="48pt" fo:font-style="italic" fo:font-weight="normal" style:font-size-asian="48pt" style:font-style-asian="italic" style:font-weight-asian="normal" style:font-size-complex="48pt" style:font-style-complex="italic" style:font-weight-complex="normal"/></style:style><style:style style:name="T4" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="18pt" fo:font-weight="normal" style:font-size-asian="18pt" style:font-weight-asian="normal" style:font-size-complex="18pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T5" style:family="text"><style:text-properties fo:color="#000000" style:text-position="super 58%" fo:font-size="18pt" fo:font-weight="normal" style:font-size-asian="18pt" style:font-weight-asian="normal" style:font-size-complex="18pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T6" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="18pt" fo:font-style="normal" fo:font-weight="normal" style:font-size-asian="18pt" style:font-style-asian="normal" style:font-weight-asian="normal" style:font-size-complex="18pt" style:font-style-complex="normal" style:font-weight-complex="normal"/></style:style><style:style style:name="T7" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="20pt" fo:font-weight="normal" style:font-size-asian="20pt" style:font-weight-asian="normal" style:font-size-complex="20pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T8" style:family="text"><style:text-properties fo:font-style="normal" fo:font-weight="bold" style:font-style-asian="normal" style:font-weight-asian="bold" style:font-style-complex="normal" style:font-weight-complex="bold"/></style:style><style:style style:name="T9" style:family="text"><style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/></style:style><style:style style:name="T10" style:family="text"><style:text-properties fo:color="#808080" fo:font-size="15pt" style:font-size-asian="15pt" style:font-size-complex="15pt"/></style:style><style:style style:name="T11" style:family="text"><style:text-properties fo:font-size="54pt" fo:font-style="italic" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="54pt" style:font-style-asian="italic" style:font-weight-asian="bold" style:font-size-complex="54pt" style:font-style-complex="italic" style:font-weight-complex="bold"/></style:style><style:style style:name="T12" style:family="text"><style:text-properties fo:font-size="54pt" style:font-size-asian="54pt" style:font-size-complex="54pt"/></style:style><style:style style:name="T13" style:family="text"><style:text-properties fo:color="#808080"/></style:style><style:style style:name="T14" style:family="text"><style:text-properties fo:color="#cccccc" fo:font-size="400pt" style:font-size-asian="400pt" style:font-size-complex="400pt"/></style:style><style:style style:name="T15" style:family="text"><style:text-properties fo:font-size="96pt" fo:text-shadow="1pt 1pt" style:font-size-asian="96pt" style:font-size-complex="96pt"/></style:style><style:style style:name="T16" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-size="80pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="80pt" style:font-weight-asian="bold" style:font-size-complex="80pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T17" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-size="40pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="40pt" style:font-weight-asian="bold" style:font-size-complex="40pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T18" style:family="text"><style:text-properties fo:font-size="28pt" style:font-size-asian="28pt" style:font-size-complex="28pt"/></style:style><style:style style:name="T19" style:family="text"><style:text-properties fo:font-size="26pt" style:font-size-asian="26pt" style:font-size-complex="26pt"/></style:style><style:style style:name="T20" style:family="text"><style:text-properties style:text-position="super 58%" fo:font-size="28pt" style:font-size-asian="28pt" style:font-size-complex="28pt"/></style:style><style:style style:name="T21" style:family="text"><style:text-properties fo:font-size="32pt" style:font-size-asian="32pt" style:font-size-complex="32pt"/></style:style><style:style style:name="T22" style:family="text"><style:text-properties fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="T23" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="36pt" fo:font-style="italic" style:font-size-asian="36pt" style:font-style-asian="italic" style:font-size-complex="36pt" style:font-style-complex="italic"/></style:style><style:style style:name="T24" style:family="text"><style:text-properties fo:font-size="36pt" fo:font-style="normal" fo:font-weight="bold" style:font-size-asian="36pt" style:font-style-asian="normal" style:font-weight-asian="bold" style:font-size-complex="36pt" style:font-style-complex="normal" style:font-weight-complex="bold"/></style:style><style:style style:name="T25" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="36pt" fo:text-shadow="none" fo:font-weight="bold" style:font-size-asian="36pt" style:font-weight-asian="bold" style:font-size-complex="36pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T26" style:family="text"><style:text-properties style:text-line-through-style="solid"/></style:style><style:style style:name="T27" style:family="text"><style:text-properties style:use-window-font-color="true" fo:font-size="36pt" fo:text-shadow="none" fo:font-weight="normal" style:font-size-asian="36pt" style:font-weight-asian="normal" style:font-size-complex="36pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T28" style:family="text"><style:text-properties style:use-window-font-color="true" fo:font-size="36pt" fo:font-style="italic" fo:text-shadow="1pt 1pt" fo:font-weight="normal" style:font-size-asian="36pt" style:font-style-asian="italic" style:font-weight-asian="normal" style:font-size-complex="36pt" style:font-style-complex="italic" style:font-weight-complex="normal"/></style:style><style:style style:name="T29" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-size="88pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="88pt" style:font-weight-asian="bold" style:font-size-complex="88pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T30" style:family="text"><style:text-properties fo:font-size="88pt" style:font-size-asian="88pt" style:font-size-complex="88pt"/></style:style><style:style style:name="T31" style:family="text"><style:text-properties fo:font-size="72pt" style:font-size-asian="72pt" style:font-size-complex="72pt"/></style:style><style:style style:name="T32" style:family="text"><style:text-properties fo:font-size="66pt" style:font-size-asian="66pt" style:font-size-complex="66pt"/></style:style><style:style style:name="T33" style:family="text"><style:text-properties fo:font-size="40pt" style:font-size-asian="40pt" style:font-size-complex="40pt"/></style:style><style:style style:name="T34" style:family="text"><style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/></style:style><style:style style:name="T35" style:family="text"><style:text-properties fo:font-style="italic" fo:font-weight="bold" style:font-style-asian="italic" style:font-weight-asian="bold" style:font-style-complex="italic" style:font-weight-complex="bold"/></style:style><style:style style:name="T36" style:family="text"><style:text-properties fo:font-family="Arial" style:font-style-name="Regular" style:font-family-generic="swiss" style:font-family-asian="Arial" style:font-style-name-asian="Regular" style:font-family-generic-asian="swiss" style:font-family-complex="Arial" style:font-style-name-complex="Regular" style:font-family-generic-complex="swiss"/></style:style><style:style style:name="T37" style:family="text"><style:text-properties fo:color="#808080" fo:font-size="15pt" fo:font-weight="normal" style:font-size-asian="15pt" style:font-weight-asian="normal" style:font-size-complex="15pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T38" style:family="text"><style:text-properties fo:font-size="28pt" fo:font-weight="bold" style:font-size-asian="28pt" style:font-weight-asian="bold" style:font-size-complex="28pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T39" style:family="text"><style:text-properties fo:color="#ff0000"/></style:style><style:style style:name="T40" style:family="text"><style:text-properties fo:color="#ffffff" fo:font-size="15pt" fo:text-shadow="1pt 1pt" style:font-size-asian="15pt" style:font-size-complex="15pt"/></style:style><style:style style:name="T41" style:family="text"><style:text-properties fo:color="#ffff00" fo:font-size="72pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="72pt" style:font-weight-asian="bold" style:font-size-complex="72pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T42" style:family="text"><style:text-properties fo:color="#0000ff" fo:font-size="72pt" fo:text-shadow="1pt 1pt" style:font-size-asian="72pt" style:font-size-complex="72pt"/></style:style><style:style style:name="T43" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-size="72pt" fo:text-shadow="1pt 1pt" style:font-size-asian="72pt" style:font-size-complex="72pt"/></style:style><style:style style:name="T44" style:family="text"><style:text-properties fo:color="#00ff00" fo:font-size="72pt" fo:text-shadow="1pt 1pt" style:font-size-asian="72pt" style:font-size-complex="72pt"/></style:style><style:style style:name="T45" style:family="text"><style:text-properties fo:font-size="16pt" style:font-size-asian="16pt" style:font-size-complex="16pt"/></style:style><style:style style:name="T46" style:family="text"><style:text-properties fo:font-style="normal" style:font-style-asian="normal" style:font-style-complex="normal"/></style:style><style:style style:name="T47" style:family="text"><style:text-properties fo:font-size="24pt" style:font-size-asian="24pt" style:font-size-complex="24pt"/></style:style><style:style style:name="T48" style:family="text"><style:text-properties fo:color="#ffffff" fo:font-size="15pt" fo:text-shadow="1pt 1pt" fo:font-weight="normal" style:font-size-asian="15pt" style:font-weight-asian="normal" style:font-size-complex="15pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T49" style:family="text"><style:text-properties fo:font-weight="normal" style:font-weight-asian="normal" style:font-weight-complex="normal"/></style:style><style:style style:name="T50" style:family="text"><style:text-properties fo:font-size="22pt" fo:font-weight="normal" style:font-size-asian="22pt" style:font-weight-asian="normal" style:font-size-complex="22pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T51" style:family="text"><style:text-properties style:text-position="super 58%"/></style:style><style:style style:name="T52" style:family="text"><style:text-properties fo:font-family="&apos;Lucida Console&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="16pt" style:font-size-asian="16pt" style:font-size-complex="16pt"/></style:style><style:style style:name="T53" style:family="text"><style:text-properties fo:font-size="103.5pt" style:font-size-asian="103.5pt" style:font-size-complex="103.5pt"/></style:style><style:style style:name="T54" style:family="text"><style:text-properties fo:font-size="15pt" style:font-size-asian="15pt" style:font-size-complex="15pt"/></style:style><style:style style:name="T55" style:family="text"><style:text-properties fo:font-size="126.5pt" fo:font-weight="normal" style:font-size-asian="126.5pt" style:font-weight-asian="normal" style:font-size-complex="126.5pt" style:font-weight-complex="normal"/></style:style><style:style style:name="T56" style:family="text"><style:text-properties fo:color="#00ffff" fo:font-size="48pt" fo:text-shadow="1pt 1pt" fo:font-weight="bold" style:font-size-asian="48pt" style:font-weight-asian="bold" style:font-size-complex="48pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T57" style:family="text"><style:text-properties style:text-underline-style="solid" style:text-underline-width="auto" style:text-underline-color="font-color"/></style:style><text:list-style style:name="L1"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="0.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="●"><style:list-level-properties text:space-before="1.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="1.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="●"><style:list-level-properties text:space-before="2.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="3cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="3.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="4.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L2"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="–"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="75%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="–"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="75%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L3"><text:list-level-style-number text:level="1" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="1"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number></text:list-style><text:list-style style:name="L4"><text:list-level-style-bullet text:level="1" text:bullet-char="•"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="•"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="•"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="•"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="•"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="•"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="•"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="•"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="•"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="•"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:font-charset="x-symbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style></office:automatic-styles><office:body><office:presentation><draw:page draw:name="title" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL1T0"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="9.531cm" svg:height="3.54cm" svg:x="6.392cm" svg:y="13.875cm"><draw:image xlink:href="Pictures/10000201000001A40000009C5F0B4D9D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="4.26cm" svg:x="1.851cm" svg:y="5.391cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T1">Binary art</text:span><text:span text:style-name="T2"><text:line-break/></text:span><text:span text:style-name="T2">Byte-ing the PE that </text:span><text:span text:style-name="T3">fails</text:span><text:span text:style-name="T2"> you</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P2" draw:layer="layout" svg:width="6.403cm" svg:height="1.7cm" svg:x="10.799cm" svg:y="18.992cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T4">3</text:span><text:span text:style-name="T5">rd</text:span><text:span text:style-name="T4"> November 2012</text:span></text:p><text:p text:style-name="P1"><text:span text:style-name="T6">Lucerne</text:span><text:span text:style-name="T4">, Switzerland</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="3.103cm" svg:height="1.092cm" svg:x="24.597cm" svg:y="19.308cm"><draw:image xlink:href="Pictures/10000201000000580000001FED1EC38A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P4" draw:layer="layout" svg:width="6.276cm" svg:height="1.835cm" svg:x="0cm" svg:y="18.965cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T7">Ange Albertini</text:span></text:p><text:p text:style-name="P3"><text:span text:style-name="T7"><text:a xlink:href="http://corkami.com/">http://corkami.com</text:a></text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="4.113cm" svg:height="3.588cm" svg:x="16.807cm" svg:y="13.605cm"><draw:image xlink:href="Pictures/10000201000000F3000000D40525473A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="1" presentation:class="page"/><draw:frame presentation:style-name="pr2" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.573cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="extended edition" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="25.199cm" svg:height="3.256cm" svg:x="1.4cm" svg:y="0.962cm" presentation:class="title"><draw:text-box><text:p>Extended edition</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="25.199cm" svg:height="13.609cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>the <text:span text:style-name="T8">presentation</text:span> deck had 60+ slides</text:p></text:list-item><text:list-item><text:p>this <text:span text:style-name="T9">one</text:span> has 140+</text:p><text:list><text:list-item><text:p>many extra explanation slides</text:p></text:list-item><text:list-item><text:p>many extra examples</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="2" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="agenda" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>agenda</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-header><text:p><text:a xlink:href="#the topic">what&apos;s a PE?</text:a></text:p><text:p><text:a xlink:href="#Houston...">the problem, and my approach</text:a></text:p><text:p><text:a xlink:href="#&apos;Le&apos; PE">overview of the PE format</text:a></text:p><text:p><text:a xlink:href="#classic tricks">messing with PEs</text:a></text:p></text:list-header></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="0.81cm" svg:height="1.092cm" svg:x="1.4cm" svg:y="5.014cm"><draw:image xlink:href="Pictures/10000200000000170000001F7CAC9796.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="0.81cm" svg:height="1.092cm" svg:x="1.4cm" svg:y="6.803cm"><draw:image xlink:href="Pictures/10000200000000170000001F9F41E067.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="0.81cm" svg:height="1.092cm" svg:x="1.4cm" svg:y="8.57cm"><draw:image xlink:href="Pictures/10000200000000170000001FD92C1B2E.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="0.81cm" svg:height="1.092cm" svg:x="1.4cm" svg:y="10.319cm"><draw:image xlink:href="Pictures/10000200000000170000001FBE2CD93B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.724cm" svg:height="0.839cm" svg:x="24.276cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">© ID software</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="3" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="the topic" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P8" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.401cm" svg:y="1.533cm"><draw:text-box><text:p><text:span text:style-name="T11">P</text:span><text:span text:style-name="T12">ortable </text:span><text:span text:style-name="T11">E</text:span><text:span text:style-name="T12">xecutable</text:span></text:p><text:p><text:span text:style-name="T12"/></text:p><text:p><text:span text:style-name="T11">C</text:span><text:span text:style-name="T12">ommon </text:span><text:span text:style-name="T11">O</text:span><text:span text:style-name="T12">bject </text:span><text:span text:style-name="T11">F</text:span><text:span text:style-name="T12">ile </text:span><text:span text:style-name="T11">F</text:span><text:span text:style-name="T12">ormat</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr5" draw:text-style-name="P7" draw:layer="layout" svg:width="9.525cm" svg:height="1.598cm" svg:x="1.905cm" svg:y="10.795cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">based on</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="4" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="what&apos;s a PE?" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Windows executables and more</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>since 1993, used in every executables</text:p><text:list><text:list-item><text:p>32b, 64b, .Net – DLL, drivers, ActiveX...</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>also used as data container: icons, strings,...</text:p></text:list-item></text:list><text:p/><text:p text:style-name="P1">omnipresent in Windows</text:p><text:p text:style-name="P1">(also EFI boot, CE phones, Xbox,...<text:line-break/>but not covered here)</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="5" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="seen those before?" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="27.462cm" svg:height="19.687cm" svg:x="0.269cm" svg:y="0.657cm"><draw:image xlink:href="Pictures/100000000000048B00000365ABCEEE75.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="6" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="loaded DLLs under 7" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:rect draw:style-name="gr6" draw:text-style-name="P1" draw:layer="layout" svg:width="28cm" svg:height="21cm" svg:x="0cm" svg:y="0cm"><text:p/></draw:rect><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="27.999cm" svg:height="17.506cm" svg:x="0.001cm" svg:y="1.747cm"><draw:image xlink:href="Pictures/100002010000054100000349E57E215E.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="7" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="other PE containers" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr7" draw:text-style-name="P1" draw:layer="layout" svg:width="13.335cm" svg:height="12.745cm" svg:x="0.2cm" svg:y="7.855cm"><draw:image xlink:href="Pictures/100000000000036B000002FD33AFCCF9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="13.47cm" svg:height="12.065cm" svg:x="14.033cm" svg:y="8.255cm"><draw:image xlink:href="Pictures/100000000000047E00000406B33E765D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="17.78cm" svg:height="6.639cm" svg:x="5.11cm" svg:y="0.346cm"><draw:image xlink:href="Pictures/10000201000003F600000180D1BA268B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="8" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="PE is everywhere" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr9" draw:text-style-name="P9" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.401cm" svg:y="1.533cm"><draw:text-box><text:p><text:span text:style-name="T14">PE</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr10" draw:text-style-name="P10" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.401cm" svg:y="1.533cm" presentation:class="subtitle" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T15">universal Windows binary</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr9" draw:text-style-name="P7" draw:layer="layout" svg:width="3.683cm" svg:height="0.992cm" svg:x="23.495cm" svg:y="14.248cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">since 1993</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="9" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="an introduction poster" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="28.193cm" svg:height="21cm" svg:x="0cm" svg:y="0cm"><draw:image xlink:href="Pictures/1000000000000403000002FD351079D9.jpg" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr11" draw:text-style-name="P11" draw:layer="layout" svg:width="17.78cm" svg:height="3.855cm" svg:x="9.525cm" svg:y="17.145cm" presentation:class="subtitle" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T16">pe101</text:span><text:span text:style-name="T17">.corkami.com</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="10" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Houston..." draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="subtitle"><draw:text-box><text:p><text:span text:style-name="T2">the problem...</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="11" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="sins &amp; punishments" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>sins &amp; punishments</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="14.994cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p><text:span text:style-name="T18">official documentation limited and unclear</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T19">at best, describes standard PEs</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T19">not good enough for security</text:span></text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:list text:continue-numbering="true" text:style-name="L2"><text:list-item><text:p><text:span text:style-name="T18">crashes (OS, security tools)</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">obstacle for 3</text:span><text:span text:style-name="T20">rd</text:span><text:span text:style-name="T18"> party developments</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">hinders automation, classification</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T19">PE or not?</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T19">corrupted, or malware?</text:span></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T18">fails best tools → even prevent manual analysis</text:span></text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="12" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="thanks MS" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="26.67cm" svg:height="3.506cm" svg:x="0.635cm" svg:y="16.837cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T21">aka</text:span><text:span text:style-name="T22"> “the </text:span><text:span text:style-name="T23">gentle</text:span><text:span text:style-name="T22"> guide to </text:span><text:span text:style-name="T24">standard</text:span><text:span text:style-name="T22"> PEs”</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="23.588cm" svg:height="11.624cm" svg:x="2.206cm" svg:y="3.797cm"><draw:image xlink:href="Pictures/100000000000049D00000261C5A1CBA3.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="13" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="crashes, crashes..." draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="12.777cm" svg:height="10.851cm" svg:x="14.605cm" svg:y="9.525cm"><draw:image xlink:href="Pictures/1000000000000181000001471F246459.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr12" draw:text-style-name="P12" draw:layer="layout" svg:width="12.569cm" svg:height="2.594cm" svg:x="14.813cm" svg:y="7.379cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T25">CVE-2012-2273</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="13.97cm" svg:height="10.673cm" svg:x="0.2cm" svg:y="0.122cm"><draw:image xlink:href="Pictures/1000000000000291000001F64667AA8F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="10.184cm" svg:height="3.041cm" svg:x="17.145cm" svg:y="17.245cm"><draw:image xlink:href="Pictures/10000000000001810000007387C13150.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.482cm" svg:height="0.839cm" svg:x="0.328cm" svg:y="11.226cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">version_mini</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.369cm" svg:height="0.839cm" draw:transform="rotate (1.5707963267946) translate (13.766cm 20.67cm)"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">ibkernel</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="14" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="applocker linker fail" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="23.624cm" svg:height="19.687cm" svg:x="2.188cm" svg:y="0.657cm"><draw:image xlink:href="Pictures/100000000000030C0000028A3BF63618.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="9.844cm" svg:height="1.457cm" svg:x="12.63cm" svg:y="10.338cm"><text:p/></draw:rect><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="5.484cm" svg:height="4.956cm" svg:x="8.123cm" svg:y="15.388cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.128cm" svg:height="0.839cm" draw:transform="rotate (-1.57079632679579) translate (27.005cm 18.639cm)"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">normal</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="15" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="identification failures" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="21.764cm" svg:height="10.16cm" svg:x="0.2cm" svg:y="0.2cm"><draw:image xlink:href="Pictures/100002010000027A0000012835386CA8.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="6.411cm" svg:height="1.07cm" svg:x="1.082cm" svg:y="9.09cm"><text:p/></draw:rect><draw:frame draw:style-name="gr11" draw:text-style-name="P1" draw:layer="layout" svg:width="19.745cm" svg:height="8.935cm" svg:x="7.755cm" svg:y="11.565cm"><draw:image xlink:href="Pictures/100000000000023D000001402BFAF0DA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="5.345cm" svg:height="2.422cm" svg:x="8.391cm" svg:y="18.116cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="16" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="leet anti-unpacking" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:rect draw:style-name="gr6" draw:text-style-name="P1" draw:layer="layout" svg:width="28cm" svg:height="21cm" svg:x="0cm" svg:y="0cm"><text:p/></draw:rect><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="32.314cm" svg:height="12.483cm" svg:x="0.511cm" svg:y="4.259cm"><draw:image xlink:href="Pictures/1000000000000325000001378250317F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="6.761cm" svg:height="1.06cm" svg:x="10.836cm" svg:y="15.006cm"><text:p/></draw:rect><draw:rect draw:style-name="gr10" draw:text-style-name="P1" draw:layer="layout" svg:width="8.736cm" svg:height="0.996cm" svg:x="17.5cm" svg:y="4.423cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="17" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Ooops" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr12" draw:text-style-name="P1" draw:layer="layout" svg:width="13.576cm" svg:height="7.33cm" svg:x="0.394cm" svg:y="0.19cm"><draw:image xlink:href="Pictures/10000000000002DC000001C235ACC593.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr13" draw:text-style-name="P1" draw:layer="layout" svg:width="14.397cm" svg:height="6.991cm" svg:x="13.235cm" svg:y="13.656cm"><draw:image xlink:href="Pictures/10000000000001E6000000EC608D9109.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr13" draw:text-style-name="P1" draw:layer="layout" svg:width="14.435cm" svg:height="5.071cm" svg:x="6.783cm" svg:y="7.965cm"><draw:image xlink:href="Pictures/100000000000017200000082FEA0CB36.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="18" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="let&apos;s do something different" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="subtitle"><draw:text-box><text:p><text:span text:style-name="T2">...and my approach</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="19" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="approach description" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>from bottom up</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="14.588cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p><text:span text:style-name="T26">analyzing what&apos;s in the wild</text:span></text:p><text:list><text:list-item><text:p>waiting for malware/corruption to experiment?</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>generate complete binaries from scratch</text:p></text:list-item><text:list-item><text:p>manually</text:p><text:list><text:list-item><text:p>no framework/compiler limitation</text:p></text:list-item><text:list-item><text:p>concise PoCs</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p text:style-name="P1">→ better coverage</text:p><text:p text:style-name="P1">shared knowledge and PoCs (bin+src)</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="20" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="legos!" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr14" draw:text-style-name="P1" draw:layer="layout" svg:width="14.702cm" svg:height="12.928cm" svg:x="13.335cm" svg:y="8.072cm"><draw:image xlink:href="Pictures/100000000000040000000300316B628B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr15" draw:text-style-name="P1" draw:layer="layout" svg:width="14.985cm" svg:height="12.064cm" svg:x="-0.402cm" svg:y="0.001cm"><draw:image xlink:href="Pictures/100000000000040000000300AA71C0E0.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="21" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="build, build..." draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr16" draw:text-style-name="P1" draw:layer="layout" svg:width="10.235cm" svg:height="20.955cm" svg:x="0cm" svg:y="0cm"><draw:image xlink:href="Pictures/10000000000003000000040000516425.jpg" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="17.145cm" svg:height="7.555cm" svg:x="10.36cm" svg:y="6.722cm"><draw:image xlink:href="Pictures/100000000000023E000000FD617A0054.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr14" draw:layer="layout" svg:width="15.875cm" svg:height="4.242cm" svg:x="11.43cm" svg:y="0.838cm"><draw:text-box><text:p><text:span text:style-name="T2">trial and error</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="22" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="look ma, it runs!" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr17" draw:text-style-name="P1" draw:layer="layout" svg:width="8.711cm" svg:height="21cm" svg:x="0cm" svg:y="0.001cm"><draw:image xlink:href="Pictures/1000000000000300000004004EA60AA1.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="18.378cm" svg:height="20.234cm" svg:x="8.927cm" svg:y="0.383cm"><draw:image xlink:href="Pictures/10000000000002D10000026961D98F11.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr15" draw:text-style-name="P13" draw:layer="layout" svg:width="17.145cm" svg:height="1.95cm" svg:x="9.525cm" svg:y="-0.045cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T27">a </text:span><text:span text:style-name="T28">complete</text:span><text:span text:style-name="T27"> executable</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="23" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="pe.corkami.com" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr18" draw:text-style-name="P1" draw:layer="layout" svg:width="22.648cm" svg:height="21cm" svg:x="2.676cm" svg:y="0cm"><draw:image xlink:href="Pictures/1000000000000293000002630D2596E6.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr19" draw:text-style-name="P1" draw:layer="layout" svg:width="10.923cm" svg:height="7.579cm" svg:x="16.382cm" svg:y="1.311cm"><draw:image xlink:href="Pictures/100000000000050E0000038219BC1442.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr16" draw:text-style-name="P11" draw:layer="layout" svg:width="16.44cm" svg:height="4.49cm" svg:x="10.16cm" svg:y="16.51cm"><draw:text-box><text:p><text:span text:style-name="T29">pe</text:span><text:span text:style-name="T17">.corkami.com</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="24" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="&apos;Le&apos; PE" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="25.263cm" svg:height="14.893cm" svg:x="1.369cm" svg:y="3.054cm"><draw:image xlink:href="Pictures/10000000000003BB0000023355C1BAAF.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="25" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="inside a file" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="16.51cm" svg:height="14.605cm" svg:x="6.985cm" svg:y="4.445cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:frame draw:style-name="gr21" draw:text-style-name="P14" draw:layer="layout" svg:width="13.97cm" svg:height="2.618cm" svg:x="3.175cm" svg:y="1.905cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T1">File</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P15" draw:layer="layout" svg:width="10.16cm" svg:height="3.718cm" svg:x="7.62cm" svg:y="4.537cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T30">PE</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P15" draw:layer="layout" svg:width="18.415cm" svg:height="2.376cm" svg:x="7.52cm" svg:y="15.197cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T12">(Appended data)</text:span></text:p></draw:text-box></draw:frame><draw:line draw:style-name="gr22" draw:text-style-name="P1" draw:layer="layout" svg:x1="7.01cm" svg:y1="14.795cm" svg:x2="23.495cm" svg:y2="14.795cm"><text:p/></draw:line><draw:custom-shape draw:style-name="gr23" draw:text-style-name="P1" draw:layer="layout" svg:width="2.54cm" svg:height="5.08cm" svg:x="24.13cm" svg:y="4.445cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:mirror-horizontal="false" draw:mirror-vertical="false" draw:text-areas="?f0 ?f7 ?f2 21600" draw:type="up-arrow" draw:modifiers="5400 5400" draw:enhanced-path="M ?f0 21600 L ?f0 ?f1 0 ?f1 10800 0 21600 ?f1 ?f2 ?f1 ?f2 21600 Z N"><draw:equation draw:name="f0" draw:formula="$1 "/><draw:equation draw:name="f1" draw:formula="$0 "/><draw:equation draw:name="f2" draw:formula="21600-$1 "/><draw:equation draw:name="f3" draw:formula="21600-?f1 "/><draw:equation draw:name="f4" draw:formula="?f3 *?f0 /10800"/><draw:equation draw:name="f5" draw:formula="?f1 +?f4 "/><draw:equation draw:name="f6" draw:formula="?f1 *?f0 /10800"/><draw:equation draw:name="f7" draw:formula="?f1 -?f6 "/><draw:handle draw:handle-position="$1 $0" draw:handle-range-x-minimum="0" draw:handle-range-x-maximum="10800" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="21600"/></draw:enhanced-geometry></draw:custom-shape><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="26" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="appended what?" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="10.445cm" svg:height="14.605cm" svg:x="2.89cm" svg:y="1.27cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:line draw:style-name="gr24" draw:text-style-name="P1" draw:layer="layout" svg:x1="2.906cm" svg:y1="11.62cm" svg:x2="13.335cm" svg:y2="11.62cm"><text:p/></draw:line><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="3.517cm" svg:height="3.147cm" svg:x="19.343cm" svg:y="16.538cm"><draw:image xlink:href="Pictures/100000000000008500000077DC0B4D81.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="2.935cm" svg:height="3.755cm" svg:x="6.59cm" svg:y="16.565cm"><draw:image xlink:href="Pictures/100000000000006F0000008E7E3EBD6F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:custom-shape draw:style-name="gr25" draw:text-style-name="P1" draw:layer="layout" svg:width="10.445cm" svg:height="11.429cm" svg:x="15.891cm" svg:y="1.271cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:frame draw:style-name="gr21" draw:text-style-name="P15" draw:layer="layout" svg:width="10.16cm" svg:height="3.718cm" svg:x="3.175cm" svg:y="1.362cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T30">PE</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P15" draw:layer="layout" svg:width="10.16cm" svg:height="3.718cm" svg:x="16.175cm" svg:y="1.362cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T30">PE</text:span></text:p></draw:text-box></draw:frame><draw:line draw:style-name="gr26" draw:text-style-name="P1" draw:layer="layout" svg:x1="13.335cm" svg:y1="1.27cm" svg:x2="15.875cm" svg:y2="1.27cm"><text:p/></draw:line><draw:line draw:style-name="gr26" draw:text-style-name="P1" draw:layer="layout" svg:x1="13.335cm" svg:y1="11.62cm" svg:x2="15.875cm" svg:y2="12.7cm"><text:p/></draw:line><draw:frame draw:style-name="gr21" draw:text-style-name="P1" draw:layer="layout" svg:width="10.16cm" svg:height="0.963cm" draw:transform="rotate (1.5707963267946) translate (1.777cm 11.43cm)"><draw:text-box><text:p text:style-name="P1">defined by the PE header</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P15" draw:layer="layout" svg:width="18.415cm" svg:height="4.035cm" svg:x="3.075cm" svg:y="11.73cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T2">Appended</text:span></text:p><text:p text:style-name="P3"><text:span text:style-name="T2">data</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="27" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="inside a PE" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="10.907cm" svg:height="7.97cm" svg:x="8.778cm" svg:y="7.27cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:mirror-horizontal="false" draw:mirror-vertical="false" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:line draw:style-name="gr24" draw:text-style-name="P1" draw:layer="layout" svg:x1="8.786cm" svg:y1="10.72cm" svg:x2="19.685cm" svg:y2="10.72cm"><text:p/></draw:line><draw:frame draw:style-name="gr21" draw:text-style-name="P15" draw:layer="layout" svg:width="10.16cm" svg:height="3.718cm" svg:x="4.255cm" svg:y="4cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T30">PE</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="10.16cm" svg:height="3.088cm" svg:x="9.02cm" svg:y="7.457cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T31">Header</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="10.825cm" svg:height="3.088cm" svg:x="8.988cm" svg:y="10.957cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T31">Sections</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="7.83cm" svg:height="0.963cm" svg:x="11.62cm" svg:y="13.917cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">code, data, &lt;you name it&gt;</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="28" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="2 generations of headers" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="20.155cm" svg:height="8.735cm" svg:x="6.778cm" svg:y="5.87cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:line draw:style-name="gr24" draw:text-style-name="P1" draw:layer="layout" svg:x1="6.786cm" svg:y1="10.22cm" svg:x2="26.933cm" svg:y2="10.22cm"><text:p/></draw:line><draw:frame draw:style-name="gr21" draw:text-style-name="P17" draw:layer="layout" svg:width="13.335cm" svg:height="2.855cm" svg:x="1.175cm" svg:y="2.955cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T32">Header</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="15.845cm" svg:height="3.088cm" svg:x="6.92cm" svg:y="6.557cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T31">DOS header</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="20.955cm" svg:height="3.088cm" svg:x="6.255cm" svg:y="10.855cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T31">&apos;modern&apos; headers</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr5" draw:text-style-name="P7" draw:layer="layout" svg:width="9.525cm" svg:height="1.598cm" svg:x="17.91cm" svg:y="9.197cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">since IBM PC-DOS 1.0 (1981)</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="8.795cm" svg:height="0.963cm" svg:x="18.005cm" svg:y="13.417cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">since Windows NT 3.1 (1993)</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="1.421cm" svg:height="0.963cm" svg:x="6.89cm" svg:y="6.082cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">MZ</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr27" draw:text-style-name="P7" draw:layer="layout" svg:width="6.183cm" svg:height="0.963cm" svg:x="6.891cm" svg:y="10.283cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">PE (or NE/LE/LX/...)</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="29" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="between the hammer and the anvil" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="16.622cm" svg:height="11.37cm" svg:x="7.778cm" svg:y="5.27cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:line draw:style-name="gr24" draw:text-style-name="P1" draw:layer="layout" svg:x1="7.786cm" svg:y1="13.32cm" svg:x2="24.4cm" svg:y2="13.32cm"><text:p/></draw:line><draw:frame draw:style-name="gr21" draw:text-style-name="P17" draw:layer="layout" svg:width="13.335cm" svg:height="2.855cm" svg:x="3.175cm" svg:y="2.355cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T32">Header</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="15.845cm" svg:height="3.088cm" svg:x="7.92cm" svg:y="5.457cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T31">DOS header</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="15.875cm" svg:height="3.088cm" svg:x="8.255cm" svg:y="13.455cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T31">&apos;PE headers&apos;</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P17" draw:layer="layout" svg:width="15.845cm" svg:height="2.143cm" svg:x="8.42cm" svg:y="8.758cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T2">(DOS stub)</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr5" draw:text-style-name="P7" draw:layer="layout" svg:width="2.632cm" svg:height="1.598cm" svg:x="17.218cm" svg:y="9.692cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T13">16 bits</text:span></text:p></draw:text-box></draw:frame><draw:line draw:style-name="gr28" draw:text-style-name="P1" draw:layer="layout" svg:x1="7.786cm" svg:y1="8.62cm" svg:x2="24.4cm" svg:y2="8.62cm"><text:p/></draw:line><draw:frame draw:style-name="gr21" draw:text-style-name="P17" draw:layer="layout" svg:width="15.845cm" svg:height="2.143cm" svg:x="8.42cm" svg:y="11.158cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T2">(Rich header)</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr5" draw:text-style-name="P7" draw:layer="layout" svg:width="5.647cm" svg:height="1.598cm" svg:x="19.118cm" svg:y="12.092cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T13">compilation info</text:span></text:p></draw:text-box></draw:frame><draw:line draw:style-name="gr28" draw:text-style-name="P1" draw:layer="layout" svg:x1="7.786cm" svg:y1="11.02cm" svg:x2="24.4cm" svg:y2="11.02cm"><text:p/></draw:line><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="30" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="16bit oldies" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr29" draw:text-style-name="P1" draw:layer="layout" svg:width="25.199cm" svg:height="10.999cm" svg:x="1.399cm" svg:y="8.643cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/100000000000025F00000109EA27E4FC.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.588cm" svg:height="3.089cm" svg:x="0.706cm" svg:y="4.845cm"><draw:image xlink:href="Pictures/100000000000027400000049AA211256.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>DOS Stub</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="3.81cm" svg:height="4.038cm" svg:x="24.13cm" svg:y="0.107cm"><draw:image xlink:href="Pictures/10000201000000C8000000D48BE177D5.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.956cm" svg:height="0.839cm" svg:x="24.044cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">PoC: compiled</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="9.78cm" svg:height="3.099cm" svg:x="16.51cm" svg:y="9.043cm"><draw:text-box><text:list text:style-name="L1"><text:list-item><text:p><text:s/>obsolete 16b code</text:p><text:list><text:list-item><text:p>prints msg &amp; exits</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:s/>still present on all standard PEs</text:p><text:list><text:list-item><text:p>even 64b binaries</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="31" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="compiler artefact" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Rich header</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr30" draw:text-style-name="P1" draw:layer="layout" svg:width="25.199cm" svg:height="4.284cm" svg:x="1.399cm" svg:y="9.701cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/10000000000002750000006BB86019EE.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.956cm" svg:height="0.839cm" svg:x="24.044cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">PoC: compiled</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P1" draw:layer="layout" svg:width="12.397cm" svg:height="3.811cm" svg:x="8.002cm" svg:y="16.028cm"><draw:text-box><text:list text:style-name="L1"><text:list-item><text:p text:style-name="P3"><text:s/>compiler information</text:p></text:list-item><text:list-item><text:p text:style-name="P3"><text:s/>officially undocumented</text:p><text:list><text:list-item><text:p text:style-name="P3">pitiful xor32 encryption</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p text:style-name="P3"><text:s/>completely documented by Daniel Pistelli</text:p><text:list><text:list-header><text:p text:style-name="P3"><text:a xlink:href="http://ntcore.com/files/richsign.htm">http://ntcore.com/files/richsign.htm</text:a> </text:p></text:list-header></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="32" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="PE overview" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="14.283cm" svg:height="20.319cm" svg:x="6.859cm" svg:y="0.341cm"><draw:image xlink:href="Pictures/10000000000002520000034D2D12ADE3.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="33" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="dos header" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Dos header</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>obsolete stuff</text:p><text:list><text:list-item><text:p>only used if started in DOS mode</text:p></text:list-item><text:list-item><text:p>ignored otherwise</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>tells where the PE header is</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="34" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="dos header graph" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="22.831cm" svg:height="17.384cm" svg:x="2.585cm" svg:y="1.808cm"><draw:image xlink:href="Pictures/10000000000002D500000228F079CFE1.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="35" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="modern headers" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr21" draw:text-style-name="P17" draw:layer="layout" svg:width="13.971cm" svg:height="2.855cm" svg:x="0.54cm" svg:y="2.355cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T32">&apos;PE Headers&apos;</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="15.845cm" svg:height="3.088cm" svg:x="3.921cm" svg:y="7.457cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T31">File header</text:span></text:p></draw:text-box></draw:frame><draw:line draw:style-name="gr28" draw:text-style-name="P1" draw:layer="layout" svg:x1="3.787cm" svg:y1="10.42cm" svg:x2="26.374cm" svg:y2="10.455cm"><text:p/></draw:line><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="23.32cm" svg:height="12.51cm" svg:x="3.35cm" svg:y="5.27cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="15.845cm" svg:height="3.088cm" svg:x="3.622cm" svg:y="13.957cm"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T31">Section table</text:span></text:p></draw:text-box></draw:frame><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="19.71cm" svg:height="3.05cm" svg:x="3.96cm" svg:y="13.995cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:custom-shape draw:style-name="gr20" draw:text-style-name="P1" draw:layer="layout" svg:width="22.484cm" svg:height="6.705cm" svg:x="3.89cm" svg:y="6.63cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:type="rectangle" draw:enhanced-path="M 0 0 L 21600 0 21600 21600 0 21600 0 0 Z N"/></draw:custom-shape><draw:frame draw:style-name="gr21" draw:text-style-name="P16" draw:layer="layout" svg:width="19.018cm" svg:height="3.088cm" svg:x="3.922cm" svg:y="10.257cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T31">Optional header</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="4.155cm" svg:height="0.963cm" svg:x="22.38cm" svg:y="5.482cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">&apos;NT Headers&apos;</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="4.786cm" svg:height="0.963cm" svg:x="18.781cm" svg:y="15.583cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">mapping layout</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="5.188cm" svg:height="0.963cm" svg:x="21.192cm" svg:y="9.084cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">declares the rest</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="4.27cm" svg:height="0.963cm" svg:x="22.093cm" svg:y="11.985cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T13">absent in .obj</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P18" draw:layer="layout" svg:width="2.407cm" svg:height="0.963cm" svg:x="4.181cm" svg:y="6.883cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T13">PE\0\0</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="36" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="file header" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>File header</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>how many sections?</text:p></text:list-item><text:list-item><text:p>is there any Optional Header?</text:p></text:list-item><text:list-item><text:p>Dll or EXE...</text:p><text:p/></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="37" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="file header graph" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr31" draw:text-style-name="P1" draw:layer="layout" svg:width="26.981cm" svg:height="9.577cm" svg:x="0.51cm" svg:y="5.712cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/100000000000034D0000012C4972AA2D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="38" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true" presentation:user-transformed="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="standard number of sections" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>NumberOfSections</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>0: Corkami :p</text:p></text:list-item><text:list-item><text:p>1: packer</text:p></text:list-item><text:list-item><text:p>3-6: standard</text:p><text:list><text:list-item><text:p>code, data, uninitialized data, imports, resources...</text:p></text:list-item></text:list><text:p/></text:list-item><text:list-item><text:p>16: free basic FTW :D</text:p><text:list><text:list-item><text:p>what for ?</text:p></text:list-item></text:list><text:p/></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="39" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="16 sections" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="26.079cm" svg:height="13.284cm" svg:x="0.961cm" svg:y="3.858cm"><draw:image xlink:href="Pictures/100000000000031D00000196442DCB49.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="40" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="optional header" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Optional header</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>geometry properties</text:p></text:list-item><text:list-item><text:p>tells where code starts</text:p></text:list-item><text:list-item><text:p>driver/standard/console</text:p></text:list-item><text:list-item><text:p>how big in memory, …</text:p><text:list><text:list-item><text:p>many non critical information</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="41" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="optional header graph" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="20.337cm" svg:height="20.221cm" svg:x="3.832cm" svg:y="0.39cm"><draw:image xlink:href="Pictures/10000000000002B9000002B5CEF47D80.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="42" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="sections" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Sections</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>defines the mapping:</text:p><text:list><text:list-item><text:p>which part of the file goes where</text:p></text:list-item><text:list-item><text:p>what for ? (writeable, executable...)</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="43" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="section table graph" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr31" draw:text-style-name="P1" draw:layer="layout" svg:width="22.907cm" svg:height="13.859cm" svg:x="2.545cm" svg:y="3.571cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/100000000000031B000001E1EB5663AF.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="44" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="sections mapping" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="22.506cm" svg:height="20.32cm" svg:x="2.747cm" svg:y="0.34cm"><draw:image xlink:href="Pictures/10000000000003A80000034D3B05731D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="45" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="data directories" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Data Directory</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>(RVA, Size) <text:span text:style-name="T18">DataDirectory</text:span>[<text:span text:style-name="T19">NumbersOfRvaAndSizes</text:span>]</text:p></text:list-item><text:list-item><text:p>each of the standard 16 firsts has a specific use</text:p><text:list><text:list-header><text:p>→ often called &apos;Data Directories&apos;</text:p></text:list-header></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="46" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="data directories graph" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr31" draw:text-style-name="P1" draw:layer="layout" svg:width="24.479cm" svg:height="13.859cm" svg:x="1.759cm" svg:y="3.571cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/100000000000049300000297337EEBBA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="47" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="imports &amp; exports relation" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="6.073cm" svg:height="4.976cm" svg:x="0.947cm" svg:y="7.699cm"><draw:text-box><text:p><text:span text:style-name="T33">...</text:span></text:p><text:p><text:span text:style-name="T33">call [API]</text:span></text:p><text:p><text:span text:style-name="T33">…</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr32" draw:text-style-name="P1" draw:layer="layout" svg:width="10.495cm" svg:height="6.95cm" svg:x="0.935cm" svg:y="7.655cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="5.205cm" svg:height="1.826cm" svg:x="6.19cm" svg:y="12.6cm"><draw:text-box><text:p><text:span text:style-name="T33">Imports</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr33" draw:text-style-name="P1" draw:layer="layout" svg:width="5.08cm" svg:height="1.905cm" svg:x="6.19cm" svg:y="12.6cm"><text:p/></draw:rect><draw:polyline draw:style-name="gr34" draw:text-style-name="P1" draw:layer="layout" svg:width="1.269cm" svg:height="2.539cm" svg:x="6.82cm" svg:y="10.16cm" svg:viewBox="0 0 1270 2540" draw:points="0,0 1270,0 1270,2540"><text:p/></draw:polyline><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="2.382cm" svg:height="1.826cm" svg:x="0.991cm" svg:y="5.7cm"><draw:text-box><text:p><text:span text:style-name="T33">PE</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="4.972cm" svg:height="3.092cm" svg:x="22.647cm" svg:y="9.3cm"><draw:text-box><text:p><text:span text:style-name="T33">API: …</text:span></text:p><text:p><text:span text:style-name="T21"><text:s text:c="10"/></text:span><text:span text:style-name="T18">ret</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr32" draw:text-style-name="P1" draw:layer="layout" svg:width="10.495cm" svg:height="6.95cm" svg:x="16.935cm" svg:y="7.656cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="5.286cm" svg:height="1.826cm" svg:x="17.09cm" svg:y="12.601cm"><draw:text-box><text:p><text:span text:style-name="T33">Exports</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr33" draw:text-style-name="P1" draw:layer="layout" svg:width="5.08cm" svg:height="1.905cm" svg:x="17.09cm" svg:y="12.601cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="3.084cm" svg:height="1.826cm" svg:x="24.291cm" svg:y="5.701cm"><draw:text-box><text:p><text:span text:style-name="T33">DLL</text:span></text:p></draw:text-box></draw:frame><draw:polyline draw:style-name="gr34" draw:text-style-name="P1" draw:layer="layout" svg:width="2.539cm" svg:height="1.269cm" draw:transform="rotate (1.5707963267946) translate (21.555cm 12.7cm)" svg:viewBox="0 0 2540 1270" draw:points="0,0 2540,0 2540,1270"><text:p/></draw:polyline><draw:line draw:style-name="gr35" draw:text-style-name="P1" draw:layer="layout" svg:x1="11.43cm" svg:y1="13.67cm" svg:x2="16.935cm" svg:y2="13.67cm"><text:p/></draw:line><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="48" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="exports" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Exports</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>3 pointers to 3 lists</text:p></text:list-item><text:list-item><text:p>defining in parallel <text:s/>(name, address, ordinal)</text:p><text:list><text:list-item><text:p>a function can have several names</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="49" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="exports graph" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr31" draw:text-style-name="P1" draw:layer="layout" svg:width="25.199cm" svg:height="8.735cm" svg:x="1.399cm" svg:y="6.133cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/1000000000000493000001960122D56F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="50" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Imports" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Imports</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>a null-terminated list of descriptors</text:p><text:list><text:list-item><text:p>typically one per imported DLL</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>each descriptors specifies</text:p><text:list><text:list-item><text:p>a dll name</text:p></text:list-item><text:list-item><text:p>2 null-terminated lists</text:p><text:list><text:list-item><text:p>API names and future API addresses</text:p><text:p/></text:list-item></text:list></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T18">ImportsAddressTable</text:span> highlights the adress parts</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="51" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Imports and IAT" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="26.639cm" svg:height="13.989cm" svg:x="0.681cm" svg:y="3.506cm"><draw:image xlink:href="Pictures/10000000000004930000026783774170.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="52" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Relocations" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Relocations</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>PE have standard ImageBases</text:p><text:list><text:list-item><text:p>EXE: 0x400000, DLL 0x1000000</text:p><text:p>→ conflicts between DLLS</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>different ImageBase given by the loader</text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T34">absolute</text:span> addresses need relocation</text:p><text:list><text:list-item><text:p>most addresses of the header are <text:span text:style-name="T34">relative</text:span></text:p></text:list-item><text:list-item><text:p>immediate values in code, TLS callbacks</text:p></text:list-item><text:list-item><text:p>adds <text:span text:style-name="T34">(NewImageBase - OldImageBase)</text:span></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="53" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations graph" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr31" draw:text-style-name="P1" draw:layer="layout" svg:width="25.199cm" svg:height="8.908cm" svg:x="1.399cm" svg:y="6.046cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/10000000000004930000019EC4A4E233.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="54" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Resources" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Resources</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>icons, dialogs, version information, ...</text:p></text:list-item><text:list-item><text:p>requires only 3 APIs calls to be used</text:p><text:list><text:list-header><text:p>→ used everywhere</text:p></text:list-header></text:list></text:list-item><text:list-item><text:p>folder &amp; file structure</text:p><text:list><text:list-item><text:p>3 levels in standard</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="55" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="resources graph" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="27.365cm" svg:height="12.968cm" svg:x="0.318cm" svg:y="4.016cm"><draw:image xlink:href="Pictures/10000000000004930000022B2D3C4805.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="56" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Thread Local Storage" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p><text:span text:style-name="T35">T</text:span>hread <text:span text:style-name="T35">L</text:span>ocal <text:span text:style-name="T35">S</text:span>torage</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>Callbacks executed on thread start and stop</text:p><text:list><text:list-item><text:p>before EntryPoint</text:p></text:list-item><text:list-item><text:p>after ExitProcess</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="57" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="TLS graph" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr31" draw:text-style-name="P1" draw:layer="layout" svg:width="25.199cm" svg:height="5.917cm" svg:x="1.399cm" svg:y="7.542cm" presentation:class="graphic" presentation:user-transformed="true"><draw:image xlink:href="Pictures/1000000000000493000001132A60114B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="58" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="differences between 32 and 64b" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>32 bits ↔ 64 bits</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>IMAGE_FILE_HEADER.Machine</text:p><text:list><text:list-item><text:p>0x14c <text:span text:style-name="T34">I386</text:span> ↔ 0x8664 <text:span text:style-name="T34">AMD64</text:span></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>IMAGE_OPTIONAL_HEADER.Magic</text:p><text:list><text:list-item><text:p>0x10b ↔ 0x20b</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>ImageBase, Stack, Heap</text:p><text:list><text:list-item><text:p>double ↔ quad</text:p></text:list-item><text:list-item><text:p>sizeof(OptionalHeader): 0xe0 ↔ 0xf0</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>TLS, import thunks also switch to quadwords</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="59" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="classic tricks" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="17.909cm" svg:height="2.856cm" svg:x="5.046cm" svg:y="9.072cm"><draw:image xlink:href="Pictures/10000000000002A50000006CFA3AD730.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="60" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="true definition of SizeOfOptionalHeader" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr17" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>SizeOfOptionalHeader</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr18" draw:text-style-name="P19" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p><text:span text:style-name="T26">sizeof(OptionalHeader)</text:span></text:p><text:list><text:list-item><text:p>that would be 0xe0 (32b)/0xf0 (64b)</text:p></text:list-item><text:list-item><text:p>many naïve softwares fail if different</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>offset(SectionTable) – offset(OptionalHeader)</text:p></text:list-item><text:list-item><text:p>can be:</text:p><text:list><text:list-item><text:p>bigger</text:p><text:list><text:list-item><text:p>bigger than file (→ virtual table, xp)</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>smaller or null (→ overlapping OptionalHeader)</text:p></text:list-item><text:list-item><text:p>null (no section at all)</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="61" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Sectionless PE" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Section-less PE</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="14.419cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>standard mode:</text:p><text:list><text:list-item><text:p>200 <text:span text:style-name="T36">≤</text:span> FileAlignment <text:span text:style-name="T36">≤</text:span> SectionAlignment</text:p></text:list-item><text:list-item><text:p>1000 <text:span text:style-name="T36">≤</text:span> SectionAlignment</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>&apos;drivers&apos; mode:</text:p><text:list><text:list-item><text:p>1 <text:span text:style-name="T36">≤</text:span> FileAlignment == SectionAlignment <text:span text:style-name="T36">≤</text:span> 800</text:p></text:list-item></text:list></text:list-item></text:list><text:p>→ virtual == physical</text:p><text:list text:continue-numbering="true" text:style-name="L2"><text:list-item><text:p text:style-name="P3">whole file mapped as is</text:p></text:list-item><text:list-item><text:p text:style-name="P3">sections are meaningless</text:p><text:list><text:list-item><text:p text:style-name="P3">can be none, can be many bogus</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="62" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="sectionless PoC" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr4" draw:text-style-name="P20" draw:layer="layout" svg:width="2.991cm" svg:height="0.839cm" svg:x="25.009cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T37">nosection*</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="24.102cm" svg:height="8.36cm" svg:x="1.95cm" svg:y="6.32cm"><draw:image xlink:href="Pictures/10000201000003DC000001545F47A08B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="8.92cm" svg:height="3.243cm" svg:x="1.95cm" svg:y="6.32cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="63" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="TinyPE" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>TinyPE</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="14.15cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>classic example of hand-made malformation</text:p><text:list text:style-name="L2"><text:list-item><text:list><text:list-item><text:p>PE header in Dos header</text:p></text:list-item><text:list-item><text:p>truncated OptionalHeader</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>doesn&apos;t require a section</text:p></text:list-item><text:list-item><text:p>64b &amp; driver compatible</text:p></text:list-item><text:list-item><text:p>92 bytes</text:p><text:list><text:list-item><text:p>XP only (no more truncated OptionalHeader)</text:p></text:list-item><text:list-item><text:p>extra padding is required since Vista</text:p><text:p>→ smallest universal PE: 268 bytes</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="64" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="tinyPE graph" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="16.279cm" svg:height="20.319cm" svg:x="5.861cm" svg:y="0.341cm"><draw:image xlink:href="Pictures/10000000000002A50000034DD9E5CFE0.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="1.531cm" svg:height="0.839cm" svg:x="26.469cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">tiny*</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="65" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="standard sections" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>NumberOfSections</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>96 sections (XP)</text:p></text:list-item><text:list-item><text:p>65536 Sections (Vista or later)</text:p><text:p/><text:p>→ good enough to crash tools!</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="66" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="max sections PoCs" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="13.97cm" svg:height="11.411cm" svg:x="7.015cm" svg:y="8.909cm"><draw:image xlink:href="Pictures/10000000000001FC0000019F6D018E80.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="18.774cm" svg:height="8.27cm" svg:x="4.613cm" svg:y="0cm"><draw:image xlink:href="Pictures/100000000000025E0000010BF15768FA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.228cm" svg:height="0.839cm" svg:x="21.537cm" svg:y="19.685cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">65535sects</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.029cm" svg:height="0.839cm" svg:x="24.077cm" svg:y="0.478cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">maxsecXP</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.764cm" svg:height="0.657cm" svg:x="7.289cm" svg:y="16.408cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.222cm" svg:height="0.657cm" svg:x="6.875cm" svg:y="5.348cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="67" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="olly &amp; 64k sections" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr37" draw:text-style-name="P1" draw:layer="layout" svg:width="18.087cm" svg:height="8.782cm" svg:x="4.957cm" svg:y="0.743cm"><draw:image xlink:href="Pictures/10000000000001E6000000EC608D9109.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr38" draw:text-style-name="P1" draw:layer="layout" svg:width="23.328cm" svg:height="8.775cm" svg:x="2.336cm" svg:y="11.43cm"><draw:image xlink:href="Pictures/100002010000026E000000EA31732480.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p text:style-name="P1">c</text:p></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="68" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="dual headers intro" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Dual &apos;folded&apos; headers </text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="15.328cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T18">DD only used </text:span><text:span text:style-name="T38">after</text:span><text:span text:style-name="T18"> mapping – documented by Rlabs</text:span></text:p><text:list text:style-name="L2"><text:list-item><text:list><text:list-item><text:p><text:span text:style-name="T18"><text:a xlink:href="http://www.reversinglabs.com/advisory/pecoff.php">http://www.reversinglabs.com/advisory/pecoff.php</text:a></text:span></text:p></text:list-item></text:list></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T18">move down header</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">fake DD overlaps starts of section (ASCII art FTW)</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">section contains real values</text:span></text:p></text:list-item></text:list><text:list text:style-name="L2"><text:list-item><text:p><text:span text:style-name="T18">loading process:</text:span></text:p></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T18">header and sections are parsed</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">file is mapped</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">DD overwritten with real value</text:span></text:p></text:list-item></text:list><text:list text:style-name="L2"><text:list-item><text:list><text:list-item><text:p><text:span text:style-name="T19">imports are resolved, etc...</text:span></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="69" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="dual headers schema" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="19.146cm" svg:height="20.319cm" svg:x="4.427cm" svg:y="0.341cm"><draw:image xlink:href="Pictures/100000000000032000000351B41CF556.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="70" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="dual headers PoC" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="24.581cm" svg:height="15.891cm" svg:x="1.71cm" svg:y="2.555cm"><draw:image xlink:href="Pictures/100000000000019D0000010B84294F55.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.725cm" svg:height="0.839cm" svg:x="25.275cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">foldedhdr</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="71" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Null EP" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>null EntryPoint</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.114cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>&apos;MZ&apos; disassembled as &apos;dec ebp/pop edx&apos;</text:p><text:list><text:list-item><text:p>benign</text:p></text:list-item></text:list><text:p/></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="27.335cm" svg:height="9.602cm" svg:x="0.333cm" svg:y="7.43cm"><draw:image xlink:href="Pictures/100000000000022B000000C35AB50AE3.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="12.853cm" svg:height="0.657cm" svg:x="9.362cm" svg:y="16.343cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="6.681cm" svg:height="1.322cm" svg:x="10.042cm" svg:y="7.43cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P22" draw:layer="layout" svg:width="2.034cm" svg:height="0.839cm" svg:x="25.966cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">nullEP</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="72" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Virtual EP" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>virtual EntryPoint</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.114cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>first byte not physically in the file</text:p><text:list><text:list-item><text:p><text:span text:style-name="T39">00</text:span> C0 =&gt; <text:span text:style-name="T39">add</text:span> al, al</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="16.746cm" svg:height="10.16cm" svg:x="5.627cm" svg:y="7.795cm"><draw:image xlink:href="Pictures/1000000000000164000000D8288EF5E5.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="2.887cm" svg:height="1.332cm" svg:x="5.627cm" svg:y="7.997cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="12.447cm" svg:height="0.657cm" svg:x="9.328cm" svg:y="13.188cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="1.907cm" svg:height="0.839cm" svg:x="26.093cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">virtEP</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="73" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="TLS on the fly" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>TLS on the fly</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>list of callbacks is updated on the fly</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="25.542cm" svg:height="11.395cm" svg:x="1.229cm" svg:y="7.62cm"><draw:image xlink:href="Pictures/1000000000000208000000E8E3F0F89C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="12.669cm" svg:height="0.89cm" svg:x="5.929cm" svg:y="9.247cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.19cm" svg:height="0.839cm" svg:x="24.81cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">tls_onthefly</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="74" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="TLS skip" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>skipped TLS</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>TLS are <text:span text:style-name="T9">not</text:span> executed if only kernel32 is imported</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.321cm" svg:height="6.35cm" svg:x="0.84cm" svg:y="8.325cm"><draw:image xlink:href="Pictures/100000000000027A00000099D08C3FB6.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="25.4cm" svg:height="0.89cm" svg:x="0.635cm" svg:y="8.155cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.191cm" svg:height="0.839cm" svg:x="25.809cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">tls_k32</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="75" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="resources loops" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Resources loops</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>(infinite) loops</text:p><text:list><text:list-item><text:p>not checked by the loader</text:p></text:list-item><text:list-item><text:p>ignored if a different path is required to reach resource</text:p></text:list-item></text:list><text:p/></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="76" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="CFF &amp; resource loop" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="24.32cm" svg:height="14.95cm" svg:x="1.84cm" svg:y="3.025cm"><draw:image xlink:href="Pictures/10000000000002DC000001C235ACC593.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="3.584cm" svg:height="0.839cm" svg:x="24.416cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">resourceloop</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="77" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="EntryPoint change trick" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>can&apos;t trust EntryPoints</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:p>documented by Skywing, but lesser known</text:p><text:list text:style-name="L2"><text:list-item><text:list><text:list-item><text:p><text:a xlink:href="http://www.nynaeve.net/?p=127">http://www.nynaeve.net/?p=127</text:a></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>static DLLs are called before EP execution</text:p></text:list-item><text:list-item><text:p>DllMain gets context via lpvReserved</text:p><text:list><text:list-item><text:p>which already contains future EP</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p>→ any static Dll can freely change the EntryPoint</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="78" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="EntryPoint change via lpvReserved" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="27.285cm" svg:height="20.167cm" svg:x="0.358cm" svg:y="0.417cm"><draw:image xlink:href="Pictures/1000000000000381000002975DF5333D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P24" draw:layer="layout" svg:width="1.531cm" svg:height="0.839cm" svg:x="26.469cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P23"><text:span text:style-name="T40">ctxt*</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="8.14cm" svg:height="0.77cm" svg:x="18.382cm" svg:y="2.35cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="6.993cm" svg:height="1.344cm" svg:x="4.515cm" svg:y="8.06cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="79" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="New tricks" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.401cm" svg:y="1.533cm" presentation:class="subtitle" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T41">★</text:span><text:span text:style-name="T42">N</text:span><text:span text:style-name="T43">e</text:span><text:span text:style-name="T44">w</text:span><text:span text:style-name="T41">★</text:span><text:span text:style-name="T1"> tricks</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="80" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="trailing dots" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>trailing dots</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>trivial</text:p><text:list><text:list-item><text:p>trailing dots are ignored after DLL name</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>but fails disassemblers</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="81" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="trailing dots PoC" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="1.628cm" svg:height="0.839cm" svg:x="26.372cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">dll-ld</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="5.078cm" svg:height="0.963cm" svg:x="11.461cm" svg:y="0.635cm"><draw:text-box><text:p>test with IDA 6.3</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr39" draw:text-style-name="P1" draw:layer="layout" svg:width="25.867cm" svg:height="10.784cm" svg:x="1.067cm" svg:y="5.108cm"><draw:image xlink:href="Pictures/100002010000026600000100C5B6BF14.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="82" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="characteristics" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Characteristics</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:text-style-name="P19" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>IMAGE_FILE_32BIT_MACHINE</text:p><text:list><text:list-item><text:p>true for 64b</text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T35">not</text:span> required !!</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>IMAGE_FILE_DLL</text:p><text:list><text:list-item><text:p><text:span text:style-name="T35">not</text:span> required in DLLs</text:p><text:list><text:list-item><text:p>exports still useable</text:p></text:list-item><text:list-item><text:p>no DLLMain call!</text:p><text:list><text:list-item><text:p>invalid EP → not an EXE</text:p></text:list-item><text:list-item><text:p>no FILE_DLL → apparently not a DLL</text:p><text:p>→ can&apos;t be debugged</text:p></text:list-item></text:list></text:list-item></text:list></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="83" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="no 32b flag" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="19.308cm" svg:height="10.078cm" svg:x="8.276cm" svg:y="10.495cm"><draw:image xlink:href="Pictures/10000000000001C6000000ED88C70717.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="5.296cm" svg:height="0.973cm" svg:x="15.994cm" svg:y="18.075cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="1.476cm" svg:height="0.839cm" svg:x="26.524cm" svg:y="9.656cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">mini</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="16.51cm" svg:height="9.186cm" svg:x="0.635cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/10000000000001E70000010FC336EBF7.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.72cm" svg:height="0.839cm" svg:x="0.635cm" svg:y="10.391cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">normal64</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="4.761cm" svg:height="0.973cm" svg:x="9.109cm" svg:y="7.749cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="84" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="DLL with no DLL flag" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="25.52cm" svg:height="11.715cm" svg:x="1.24cm" svg:y="4.643cm"><draw:image xlink:href="Pictures/100000000000026F0000011E4B4B0194.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="3.535cm" svg:height="0.973cm" svg:x="15.241cm" svg:y="6.647cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="10.854cm" svg:height="0.803cm" svg:x="3.634cm" svg:y="6.146cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.987cm" svg:height="0.839cm" svg:x="25.013cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">dllnomain*</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="85" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="imports tricks" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Imports descriptor tricks</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.897cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>INT bogus or absent</text:p><text:list><text:list-item><text:p>only DllName and IAT required</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>descriptor just skipped if no thunk</text:p><text:list><text:list-item><text:p>dll name ignored</text:p><text:list><text:list-item><text:p>can be null or VERY big</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>parsing shouldn&apos;t abort too early</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>isTerminator = (IAT == 0 || DllName == 0)</text:p></text:list-item><text:list-item><text:p>terminator can be virtual or outside file</text:p><text:list><text:list-item><text:p>first descriptor too</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="86" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="virtual descriptor" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="25.272cm" svg:height="9.467cm" svg:x="1.364cm" svg:y="6.917cm"><draw:image xlink:href="Pictures/10000201000003EC0000016E6997DBB9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="4.371cm" svg:height="0.839cm" svg:x="23.629cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">imports_virtdesc</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr40" draw:layer="layout" svg:width="6.564cm" svg:height="4.523cm" svg:x="10.718cm" svg:y="1.234cm"><draw:text-box><text:p><text:span text:style-name="T39">dd OriginalFirstThunk</text:span></text:p><text:p><text:span text:style-name="T39">dd TimeDateStamp</text:span></text:p><text:p><text:span text:style-name="T39">dd ForwarderChain</text:span></text:p><text:p><text:span text:style-name="T39">----------------------------</text:span></text:p><text:p>dd Name</text:p><text:p>dd FirstThunk</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="87" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="collapsed imports" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Collapsed imports</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:p>advanced imports malformation</text:p><text:list text:style-name="L2"><text:list-item><text:p>extension-less DLL name</text:p></text:list-item><text:list-item><text:p>IAT in descriptor</text:p><text:list><text:list-item><text:p>pseudo-valid INT that is ignored</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>name and hint/names in terminator</text:p></text:list-item><text:list-item><text:p>valid because last dword is null</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="88" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="weird terminator &amp; IDA" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="16.903cm" svg:height="16.279cm" svg:x="0.97cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/100000000000036E0000034D197DAC73.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr13" draw:text-style-name="P1" draw:layer="layout" svg:width="9.525cm" svg:height="4.476cm" svg:x="17.78cm" svg:y="15.844cm"><draw:image xlink:href="Pictures/10000000000001B2000000CCEACD8BF2.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.623cm" svg:height="0.839cm" svg:x="0cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">corkamix</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="10.16cm" svg:height="3.442cm" svg:x="17.68cm" svg:y="12.265cm"><draw:image xlink:href="Pictures/10000000000001DB000000A1E52B5E8A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="89" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="exceptions directory" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="25.199cm" svg:height="3.256cm" svg:x="1.4cm" svg:y="0.962cm" presentation:class="title"><draw:text-box><text:p>Exceptions directory</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="25.199cm" svg:height="13.609cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>64 bits <text:span text:style-name="T9">S</text:span>tructured <text:span text:style-name="T9">E</text:span>xception <text:span text:style-name="T9">H</text:span>andler</text:p></text:list-item><text:list-item><text:p>usually with a lot of extra compiler code</text:p><text:p/></text:list-item><text:list-item><text:p>used by W32.Deelae for infection</text:p><text:list><text:list-item><text:p>Peter Ferrie, Virus Bulletin September 2011</text:p></text:list-item></text:list><text:p/></text:list-item><text:list-item><text:p>update-able manually, on the fly</text:p><text:list><text:list-item><text:p>no need to go through APIs</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="90" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="exceptions" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="18.474cm" svg:height="20.069cm" svg:x="4.763cm" svg:y="0.466cm"><draw:image xlink:href="Pictures/10000000000002660000029B63999AA6.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.042cm" svg:height="0.839cm" svg:x="24.958cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">exceptions</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="4.22cm" svg:height="1.855cm" svg:x="4.579cm" svg:y="12.681cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="5.569cm" svg:height="1.855cm" svg:x="4.591cm" svg:y="16.667cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="91" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="changing the SEH in 64b" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.67cm" svg:height="9.099cm" svg:x="0.635cm" svg:y="5.951cm"><draw:image xlink:href="Pictures/10000000000003490000011FC71BA33B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="3.999cm" svg:height="0.839cm" svg:x="24.001cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">seh_change64</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="11.934cm" svg:height="1.344cm" svg:x="1.2cm" svg:y="7.295cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="5.012cm" svg:height="1.344cm" svg:x="0.471cm" svg:y="11.566cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="92" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations tricks" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="25.199cm" svg:height="3.256cm" svg:x="1.4cm" svg:y="0.962cm" presentation:class="title"><draw:text-box><text:p>Relocations tricks</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="25.199cm" svg:height="13.881cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>allows any ImageBase</text:p><text:list><text:list-item><text:p>required on VAs: code, TLS, .Net</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>ignored if not required</text:p><text:list><text:list-item><text:p>no ImageBase change (→ fake relocs!)</text:p></text:list-item><text:list-item><text:p>no code</text:p></text:list-item><text:list-item><text:p>64 bites RIP-relative code</text:p></text:list-item><text:list-item><text:p>IP-independant code</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>can relocate anything</text:p><text:list><text:list-item><text:p>relocate ImageBase → alter EntryPoint</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="93" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations PoCs 1" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="22.467cm" svg:height="7.722cm" svg:x="2.869cm" svg:y="12.649cm"><draw:image xlink:href="Pictures/10000201000003DA00000150D6F2966F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="21.05cm" svg:height="8.255cm" svg:x="3.475cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/100000000000021F000000D5176AB851.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="10.404cm" svg:height="1.855cm" svg:x="12.739cm" svg:y="13.224cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="15.632cm" svg:height="0.866cm" svg:x="6.683cm" svg:y="4.808cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="1.984cm" svg:height="0.839cm" svg:x="23.416cm" svg:y="11.761cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">no_dd</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="3.525cm" svg:height="0.839cm" svg:x="21.24cm" svg:y="9.321cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">ibknoreloc64</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="94" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations PoCs 2" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="13.223cm" svg:height="9.525cm" svg:x="7.389cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/1000000000000149000000EDB8525AF6.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.765cm" svg:height="3.83cm" svg:x="13.632cm" svg:y="1.557cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="12.444cm" svg:height="0.993cm" svg:x="8.468cm" svg:y="9.335cm"><text:p/></draw:rect><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="25.459cm" svg:height="6.985cm" svg:x="1.271cm" svg:y="12.835cm"><draw:image xlink:href="Pictures/1000000000000285000000B1BFC39202.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.929cm" svg:height="0.993cm" svg:x="24.801cm" svg:y="16.158cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="2.563cm" svg:height="0.993cm" svg:x="1.04cm" svg:y="17.082cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.073cm" svg:height="0.839cm" svg:x="25.927cm" svg:y="20.164cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">ibreloc</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.932cm" svg:height="0.839cm" svg:x="20.955cm" svg:y="0.635cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">fakerelocs</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="95" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations types" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr17" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Relocation types (in theory)</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr18" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>HIGHLOW</text:p><text:list text:style-name="L2"><text:list-item><text:list><text:list-item><text:p>standard ImageBase delta</text:p></text:list-item></text:list></text:list-item></text:list><text:p>ABSOLUTE</text:p><text:list text:continue-numbering="true" text:style-name="L2"><text:list-item><text:list><text:list-item><text:p>do nothing</text:p></text:list-item><text:list-item><text:p>just for alignment padding</text:p></text:list-item></text:list><text:p/><text:p text:style-name="P1"/></text:list-item></text:list><text:p text:style-name="P3"/></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="96" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocation types in practice" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr19" draw:layer="layout" svg:width="25.199cm" svg:height="13.86cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>type 6 and 7 are entirely skipped</text:p><text:list><text:list-item><text:p>type 8 is forbidden</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>type 4 (HIGHADJ) requires an parameter</text:p><text:list><text:list-item><text:p>that is actually not taken into account (bug)</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>type 2 (LOW) doesn&apos;t do anything</text:p><text:list><text:list-item><text:p>because ImageBase are 64kb aligned</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>type MIPS and IA64 are present on all archs</text:p><text:list><text:list-item><text:p>and at last, some cleanup in Windows 8!</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame presentation:style-name="pr20" draw:layer="layout" svg:width="25.199cm" svg:height="3.507cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Relocation types in practice</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="97" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations switches in windows versions" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="10.739cm" svg:height="4.734cm" svg:x="3.175cm" svg:y="2.175cm"><draw:image xlink:href="Pictures/1000000000000196000000B3F85AF27B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="16.508cm" svg:height="6.985cm" svg:x="1.04cm" svg:y="10.16cm"><draw:image xlink:href="Pictures/10000000000001A7000000B3A55D210C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="4.701cm" svg:height="20.32cm" svg:x="19.985cm" svg:y="0.24cm"><draw:image xlink:href="Pictures/10000000000000CB0000036DA980CE8E.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="98" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations archeology" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>relocations archeology</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="15.169cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>HIGHADJ was there all along</text:p></text:list-item><text:list-item><text:p>MIPS was recognized but rejected by Win95</text:p></text:list-item><text:list-item><text:p>NT3.1 introduces MIPS – available in all archs.</text:p></text:list-item><text:list-item><text:p>LOW was rejected by Win95/WinME</text:p><text:list><text:list-item><text:p>while it does nothing on other versions</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>Windows 2000 had an extra relocation type, also with a parameter</text:p></text:list-item></text:list><text:p><text:span text:style-name="T19">Bonus:</text:span></text:p><text:p text:style-name="P3"><text:span text:style-name="T19">Win95 relocations use 2 copies of the exact same code.</text:span><text:span text:style-name="T19"><text:line-break/></text:span><text:span text:style-name="T19">code optimization FTW!</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="99" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations on other systems" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="12.322cm" svg:height="2.962cm" svg:x="7.839cm" svg:y="0.948cm"><draw:image xlink:href="Pictures/100000000000016E000000586E34E3FD.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="12.823cm" svg:height="2.591cm" svg:x="7.589cm" svg:y="9.325cm"><draw:image xlink:href="Pictures/100000000000016E0000004A07662377.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="9.757cm" svg:height="2.886cm" svg:x="9.121cm" svg:y="5.08cm"><draw:image xlink:href="Pictures/1000000000000126000000575F735952.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="15.155cm" svg:height="6.985cm" svg:x="6.423cm" svg:y="13.135cm"><draw:image xlink:href="Pictures/10000000000001A7000000C367442906.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="100" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="page101" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>messing with relocations</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="15.24cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>4 relocations types actually do nothing</text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">All relocations can be applied on a bogus address</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T18">HighAdj&apos;s parameter used to fool</text:span></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T18">Relocations can alter relocations</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T18">one block can alter the next</text:span></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T18">Relocations can decrypt data</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T18">set a kernel ImageBase</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T18">default ImageBase is known</text:span></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T18">No static analysis possible</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T18">but highly suspicious :D</text:span></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="101" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="useless and dummy blocks" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="10.095cm" svg:height="6.35cm" svg:x="8.953cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/10000000000000F000000097A2E4E78B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="9.966cm" svg:height="12.522cm" svg:x="9.017cm" svg:y="7.798cm"><draw:image xlink:href="Pictures/10000000000000EE0000012BBAC77D10.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.805cm" svg:height="0.839cm" svg:x="25.195cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">reloccrypt</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.313cm" svg:height="0.765cm" svg:x="9.017cm" svg:y="14.982cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="102" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="on-the-fly relocations" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="13.096cm" svg:height="9.786cm" svg:x="7.603cm" svg:y="0.374cm"><draw:image xlink:href="Pictures/10000201000001DC00000160033FCD0E.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.805cm" svg:height="0.839cm" svg:x="25.195cm" svg:y="20.165cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">reloccrypt</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="3.353cm" svg:height="1.418cm" svg:x="16.188cm" svg:y="8.742cm"><text:p/></draw:rect><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="14.751cm" svg:height="9.576cm" svg:x="6.775cm" svg:y="10.744cm"><draw:image xlink:href="Pictures/10000201000001D80000012ECB50E7B6.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="103" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="relocations encryption and IDA" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="14.406cm" svg:height="7.436cm" svg:x="0.635cm" svg:y="0.737cm"><draw:image xlink:href="Pictures/10000000000001AE000000DEBA54FB57.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="11.946cm" svg:height="7.43cm" svg:x="15.875cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/100000000000012B000000BA99EE11E6.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.805cm" svg:height="0.839cm" svg:x="25.195cm" svg:y="20.165cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">reloccrypt</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="22.496cm" svg:height="8.357cm" svg:x="2.752cm" svg:y="10.109cm"><draw:image xlink:href="Pictures/1000020100000280000000ECB544A654.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="104" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="code in the header" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="25.199cm" svg:height="3.256cm" svg:x="1.4cm" svg:y="0.962cm" presentation:class="title"><draw:text-box><text:p>Code in the header</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="25.199cm" svg:height="14.188cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>header is executable</text:p><text:list><text:list-item><text:p>packers put some data or jumps there</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>many unused fields</text:p></text:list-item><text:list-item><text:p>many less important fields</text:p><text:list><text:list-item><text:p>Peter Ferrie<text:a xlink:href="http://pferrie.host22.com/misc/pehdr.htm">http://pferrie.host22.com/misc/pehdr.htm</text:a></text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p>→ real code in the header</text:p><text:list text:continue-numbering="true" text:style-name="L2"><text:list-header><text:p/></text:list-header></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="105" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="maximum values" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="25.758cm" svg:height="19.044cm" svg:x="1.121cm" svg:y="0.978cm"><draw:image xlink:href="Pictures/1000000000000395000002A623607F3D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.437cm" svg:height="0.839cm" svg:x="25.663cm" svg:y="20.264cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">maxvals</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="106" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="hdr_code PoC" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.939cm" svg:height="18.808cm" svg:x="0.531cm" svg:y="1.096cm"><draw:image xlink:href="Pictures/100000000000038200000273B32D808C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.428cm" svg:height="0.839cm" svg:x="25.572cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">hdrcode</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="2.461cm" svg:height="1.746cm" svg:x="9.525cm" svg:y="6.032cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.558cm" svg:height="2.873cm" svg:x="16.423cm" svg:y="7.424cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="107" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Traceless demo and header" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.555cm" svg:height="15.396cm" svg:x="0.723cm" svg:y="2.802cm"><draw:image xlink:href="Pictures/10000000000007EE0000049984C8EC6C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.636cm" svg:height="0.839cm" svg:x="25.364cm" svg:y="20.164cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">traceless</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="108" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name=".Net" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>.Net</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="15.197cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>Loading process:</text:p><text:list text:style-name="L3"><text:list-item><text:p>PE loader</text:p></text:list-item></text:list><text:list text:style-name="L4"><text:list-item><text:list><text:list-item><text:p>requires only imports (DD[1]) at this stage</text:p></text:list-item></text:list></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:p>MSCoree.dll called</text:p></text:list-item><text:list-item><text:p>.Net Loader</text:p></text:list-item></text:list><text:list text:style-name="L2"><text:list-item><text:list><text:list-item><text:p>requires CLR (DD[13]) and relocations (DD[5])</text:p></text:list-item><text:list-item><text:p>forgets to check NumberOfRvaAndSizes :(</text:p><text:list><text:list-item><text:p>works with NumberOfRvaAndSizes = 2</text:p></text:list-item></text:list></text:list-item></text:list></text:list-item></text:list><text:p><text:span text:style-name="T45"><text:s/></text:span></text:p><text:p text:style-name="P1">fails IDA, reflector – but already in the wild</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="109" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="unrecognized .Net files" draw:style-name="dp1" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="20.955cm" svg:height="8.523cm" svg:x="6.35cm" svg:y="6.239cm"><draw:image xlink:href="Pictures/10000000000002FA00000136A69D48FB.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.064cm" svg:height="0.839cm" svg:x="25.936cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">tinynet</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr41" draw:text-style-name="P1" draw:layer="layout" svg:width="2.581cm" svg:height="13.067cm" svg:x="0.594cm" svg:y="3.967cm"><draw:text-box><text:p text:style-name="P1">PE</text:p><text:p text:style-name="P1"/><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">imports</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr41" draw:text-style-name="P1" draw:layer="layout" svg:width="2.191cm" svg:height="13.067cm" svg:x="3.175cm" svg:y="3.967cm"><draw:text-box><text:p text:style-name="P1">.NET</text:p><text:p text:style-name="P1"/><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">relocs</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">...</text:p><text:p text:style-name="P1">CLR</text:p><text:p text:style-name="P1">...</text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="5.771cm" svg:height="0.681cm" svg:x="10.52cm" svg:y="12.626cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="6.28cm" svg:height="1.496cm" svg:x="6.535cm" svg:y="8.801cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="3.571cm" svg:height="1.241cm" svg:x="17.755cm" svg:y="11.538cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="110" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Win32VersionValue" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Win32VersionValue</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>officially <text:span text:style-name="T34">reserved</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T46">should be </text:span><text:span text:style-name="T34">null</text:span></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T46">actually used to override versions info in the PEB</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T46">simple dynamic anti-emu</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T46">used in malwares</text:span></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="111" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="win32versionvalue poc" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.965cm" svg:height="13.277cm" svg:x="0.518cm" svg:y="3.862cm"><draw:image xlink:href="Pictures/10000000000002D5000001651F9D1972.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.026cm" svg:height="0.839cm" svg:x="25.974cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">winver</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="4.493cm" svg:height="3.438cm" svg:x="0.289cm" svg:y="4.563cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.373cm" svg:height="0.681cm" svg:x="16.51cm" svg:y="7.778cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="7.557cm" svg:height="0.681cm" svg:x="1.21cm" svg:y="15.717cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="112" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="non null PE" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>non-null PE</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>data file PE only needs MZ, e_lfanew, &apos;PE\0\0&apos;</text:p></text:list-item><text:list-item><text:p>&apos;PE&apos; at the end of the file</text:p><text:list><text:list-item><text:p>pad enough so that e_lfanew doesn&apos;t contain 00s</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p/><text:p text:style-name="P1">a non-null PE can be created and loaded</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="113" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="non null datafile PE" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.517cm" svg:height="14.237cm" svg:x="0.742cm" svg:y="3.382cm"><draw:image xlink:href="Pictures/100000000000026E0000014E18C4FBE0.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="3.199cm" svg:height="0.839cm" svg:x="24.801cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">d_nonnull-*</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="3.508cm" svg:height="0.713cm" svg:x="16.798cm" svg:y="5.408cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="6.377cm" svg:height="0.744cm" svg:x="2.198cm" svg:y="15.386cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="114" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="resources only DLL" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Resources-only DLL</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p><text:span text:style-name="T19">LoadlibraryEx</text:span> with <text:span text:style-name="T47">LOAD_LIBRARY_AS_DATAFILE</text:span></text:p></text:list-item><text:list-item><text:p>minimal PE</text:p><text:list><text:list-item><text:p>no machine, subsystem, ...</text:p></text:list-item><text:list-item><text:p>1 valid section</text:p><text:list><text:list-item><text:p>65535 sections under XP!</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>1 DataDirectory</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="115" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="resources-only DLL poc" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr42" draw:text-style-name="P1" draw:layer="layout" svg:width="26.67cm" svg:height="15.432cm" svg:x="0.665cm" svg:y="2.784cm"><draw:image xlink:href="Pictures/10000000000004CF000003036CE699EF.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="3.376cm" svg:height="0.839cm" svg:x="24.624cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">d_resource*</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.939cm" svg:height="0.657cm" svg:x="1.005cm" svg:y="4.047cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.939cm" svg:height="0.657cm" svg:x="1.006cm" svg:y="6.648cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.939cm" svg:height="0.657cm" svg:x="1.007cm" svg:y="7.549cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.939cm" svg:height="0.657cm" svg:x="1.008cm" svg:y="14.45cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="6.15cm" svg:height="0.657cm" svg:x="12.299cm" svg:y="10.923cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="2.205cm" svg:height="0.657cm" svg:x="12.131cm" svg:y="3.156cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="116" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="subsystems" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>subsystems</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>no fundamental differences</text:p><text:list><text:list-item><text:p>low alignments for drivers</text:p></text:list-item><text:list-item><text:p>incompatible imports: NTOSKRNL ↔ KERNEL32</text:p></text:list-item><text:list-item><text:p>console ↔ gui : IsConsoleAttached</text:p></text:list-item></text:list><text:p/></text:list-item></text:list><text:p text:style-name="P1">→ a PE with low alignments and no imports<text:line-break/>can work in all 3 subsystems</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="117" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="a multi subsystem PE" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.365cm" svg:height="0.839cm" svg:x="25.635cm" svg:y="20.162cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">multiss*</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="25.906cm" svg:height="15.975cm" svg:x="1.047cm" svg:y="2.513cm"><draw:image xlink:href="Pictures/1000020100000316000001E674C2200A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="118" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="nothing* description" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="25.199cm" svg:height="3.256cm" svg:x="1.4cm" svg:y="0.962cm" presentation:class="title"><draw:text-box><text:p>a &apos;naked&apos; PE with code</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="25.199cm" svg:height="13.609cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>low alignments → no section</text:p></text:list-item><text:list-item><text:p>no imports → resolve manually APIs</text:p></text:list-item><text:list-item><text:p>TLS only → no EntryPoint</text:p></text:list-item></text:list><text:p/><text:p text:style-name="P1">no EntryPoint, no section, no imports,</text:p><text:p text:style-name="P1">but executed code</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="119" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="nothing PoC" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.929cm" svg:height="20.259cm" svg:x="0.536cm" svg:y="0.307cm"><draw:image xlink:href="Pictures/100000000000026E000001D4DF5AAAFE.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="7.691cm" svg:height="0.959cm" svg:x="16.791cm" svg:y="13.985cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="11.78cm" svg:height="0.789cm" svg:x="3.46cm" svg:y="14.185cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="11.926cm" svg:height="0.861cm" svg:x="3.426cm" svg:y="11.56cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P26" draw:layer="layout" svg:width="2.458cm" svg:height="0.839cm" svg:x="25.4cm" svg:y="20.116cm"><draw:text-box><text:p text:style-name="P25"><text:span text:style-name="T48">nothing*</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="120" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="External EP 1" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="27.003cm" svg:height="8.357cm" svg:x="0.499cm" svg:y="7.569cm"><draw:image xlink:href="Pictures/10000201000004BC0000017440422279.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>external EntryPoint (1/2)</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.114cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>in a DLL (with no relocations)</text:p></text:list-item></text:list></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="11.611cm" svg:height="0.858cm" svg:x="0.55cm" svg:y="7.398cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="26.619cm" svg:height="1.386cm" svg:x="1.051cm" svg:y="11.843cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.441cm" svg:height="0.839cm" svg:x="25.559cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">dllextEP</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="121" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="External EP 2" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.858cm" svg:height="11.812cm" svg:x="0.571cm" svg:y="6.594cm"><draw:image xlink:href="Pictures/1000020100000424000001D03BFCE0E9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>external EntryPoint (2/2)</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.114cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>allocated just before in a TLS</text:p></text:list-item></text:list></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="15.348cm" svg:height="3.389cm" svg:x="6.854cm" svg:y="10.711cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="13.453cm" svg:height="0.846cm" svg:x="0.446cm" svg:y="6.645cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.737cm" svg:height="0.839cm" svg:x="25.263cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">tls_virtEP</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="122" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="skipped EP" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>skipped EntryPoint</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.114cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>ignored via terminating TLS</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="27.326cm" svg:height="10.84cm" svg:x="0.338cm" svg:y="6.86cm"><draw:image xlink:href="Pictures/100000000000026C000000F662196FEF.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="9.869cm" svg:height="0.83cm" svg:x="4.615cm" svg:y="9.558cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="8.852cm" svg:height="0.878cm" svg:x="4.581cm" svg:y="11.068cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="2.202cm" svg:height="0.891cm" svg:x="0.338cm" svg:y="7.389cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="2.627cm" svg:height="0.839cm" svg:x="25.373cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">tls_noEP</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="11.614cm" svg:height="0.878cm" svg:x="2.508cm" svg:y="16.902cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="123" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="from driver to  usermode" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>from ring 0 to ring 3</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p><text:span text:style-name="T49">kernel packers are limited</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T49">kernel debugging is heavy</text:span></text:p></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T49">change subsystem</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T49">use fake kernel dlls (ntoskrnl, etc...)</text:span></text:p></text:list-item></text:list><text:list text:style-name="L2"><text:list-item><text:list><text:list-item><text:p><text:span text:style-name="T49">redirect APIs</text:span></text:p><text:list><text:list-item><text:p><text:span text:style-name="T50">DbgPrint → MessageBoxA, ExAllocatePool → VirtualAlloc</text:span></text:p></text:list-item></text:list></text:list-item></text:list></text:list-item></text:list><text:p><text:span text:style-name="T49"/></text:p><text:p><text:span text:style-name="T49">→ </text:span><text:span text:style-name="T49">automate kernel unpacking</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="124" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="page125" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.363cm" svg:height="9.49cm" svg:x="0.819cm" svg:y="5.755cm"><draw:image xlink:href="Pictures/10000000000002E000000109E2A7102F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="16.242cm" svg:height="3.155cm" svg:x="1.004cm" svg:y="11.911cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="13.629cm" svg:height="1.314cm" svg:x="12.406cm" svg:y="5.851cm"><text:p/></draw:rect><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.369cm" svg:height="0.839cm" svg:x="25.631cm" svg:y="20.164cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">ntoskrnl</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="125" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="AddressOfIndex explanation" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>TLS AddressOfIndex</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>pointer to dword</text:p></text:list-item><text:list-item><text:p>overwritten with 0, 1... on n<text:span text:style-name="T51">th</text:span> TLS loading</text:p></text:list-item><text:list-item><text:p>easy dynamic trick</text:p><text:list><text:list-header><text:p><text:span text:style-name="T34">call &lt;garbage&gt;</text:span> on file → <text:span text:style-name="T34">call $+5</text:span> in memory</text:p></text:list-header></text:list></text:list-item><text:list-item><text:p>handled before imports under XP, not in W7</text:p><text:list><text:list-header><text:p/></text:list-header></text:list></text:list-item></text:list><text:p text:style-name="P1">same working PE, different loading process</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="126" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="tls_aoiOSDET" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="3.859cm" svg:height="0.839cm" svg:x="24.141cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">tls_aoiOSDET</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="23.754cm" svg:height="8.357cm" svg:x="2.124cm" svg:y="0.584cm"><draw:image xlink:href="Pictures/100002010000032200000118CB71C1C3.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="16.522cm" svg:height="10.217cm" svg:x="5.739cm" svg:y="9.518cm"><draw:image xlink:href="Pictures/1000020100000172000000E431025287.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="127" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Manifest" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Manifest</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>XML resource</text:p><text:list><text:list-item><text:p>can fail loading</text:p></text:list-item><text:list-item><text:p>can crash the OS ! (KB921337)</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>Tricky to classify</text:p><text:list><text:list-item><text:p>ignored if wrong type</text:p></text:list-item></text:list></text:list-item></text:list><text:p>Minimum Manifest</text:p><text:p><text:span text:style-name="T52">&lt;assembly xmlns=&apos;urn:schemas-microsoft-com:asm.v1&apos; manifestVersion=&apos;1.0&apos;/&gt;</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="128" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="TLS reg corruption" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>DllMain/TLS corruption</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>DllMain and TLS only requires ESI to be correct</text:p><text:list><text:list-item><text:p>Even ESP can be bogus</text:p></text:list-item><text:list-item><text:p>easy anti-emulator</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>TLS can terminate with exception</text:p><text:list><text:list-item><text:p>no error reported</text:p></text:list-item><text:list-item><text:p>EntryPoint executed normally</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="129" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="IDA &amp; TLS register corruption" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="24.965cm" svg:height="4.35cm" svg:x="1.518cm" svg:y="14.7cm"><draw:image xlink:href="Pictures/10000000000002EA00000082548C9877.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="19.754cm" svg:height="10.053cm" svg:x="4.123cm" svg:y="2.012cm"><draw:image xlink:href="Pictures/100002010000022E0000011CDDAAF19E.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.547cm" svg:height="0.839cm" svg:x="25.453cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">fakeregs</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="5.198cm" svg:height="0.935cm" svg:x="10.295cm" svg:y="4.676cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="5.453cm" svg:height="5.463cm" svg:x="18.201cm" svg:y="5.631cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="130" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="a Quine PE" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>a Quine PE</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>prints its source</text:p><text:list><text:list-item><text:p>totally useless – absolutely fun :D</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:list text:continue-numbering="true" text:style-name="L2"><text:list-item><text:p>fills DOS header with ASCII chars</text:p></text:list-item><text:list-item><text:p>ASM source between DOS and PE headers</text:p></text:list-item></text:list><text:p/><text:list text:continue-numbering="true" text:style-name="L2"><text:list-item><text:p>type-able manually</text:p></text:list-item><text:list-item><text:p>types itself in new window when executed</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="131" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="quine PoC" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr4" draw:text-style-name="P7" draw:layer="layout" svg:width="1.806cm" svg:height="0.839cm" svg:x="26.194cm" svg:y="20.003cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">quine</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="24.602cm" svg:height="13.776cm" svg:x="1.699cm" svg:y="3.612cm"><draw:image xlink:href="Pictures/100002010000035C000001E09EBF4A8C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="132" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="corkamix" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>a binary polyglot</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="14.319cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>add %PDF within 400h bytes</text:p><text:list><text:list-header><text:p>→ your PE is also a PDF (→ Acrobat)</text:p></text:list-header></text:list></text:list-item><text:list-item><text:p>add PK\03\04 anywhere</text:p><text:list><text:list-header><text:p>→ your PE is also a ZIP (→ PKZip)</text:p></text:list-header></text:list></text:list-item><text:list-item><text:p>throw a Java .CLASS in the ZIP</text:p><text:list><text:list-header><text:p>→ your PE is also a JAR (→ Java)</text:p></text:list-header></text:list></text:list-item><text:list-item><text:p>add &lt;HTML&gt; somewhere</text:p><text:list><text:list-header><text:p>→ your PE is also an HTML page (→ Mosaic)</text:p></text:list-header></text:list></text:list-item><text:list-item><text:p>Bonus: Python, JavaScript</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="133" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="corkamix PoC" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr43" draw:text-style-name="P1" draw:layer="layout" svg:width="26.238cm" svg:height="19.685cm" svg:x="0.881cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/10000000000003FA000003A6DCFDFE44.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="2.623cm" svg:height="0.839cm" svg:x="0.881cm" svg:y="19.481cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">corkamix</text:span></text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.905cm" svg:height="0.635cm" svg:x="15.875cm" svg:y="9.525cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.905cm" svg:height="0.635cm" svg:x="20.53cm" svg:y="9.494cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.905cm" svg:height="0.635cm" svg:x="13.389cm" svg:y="12.013cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="134" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="conclusion&apos;s introduction" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr21" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="subtitle"><draw:text-box><text:p><text:span text:style-name="T12">Conclusion</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="135" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="conclusion" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Conclusion</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>the Windows executable format is complex</text:p></text:list-item><text:list-item><text:p>mostly covered, but many little traps</text:p><text:list><text:list-item><text:p>new ones every day :(</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p/><text:list text:continue-numbering="true" text:style-name="L2"><text:list-header><text:p><text:a xlink:href="http://pe101.corkami.com/">http://pe101.corkami.com</text:a></text:p><text:p><text:a xlink:href="http://pe.corkami.com/">http://pe.corkami.com</text:a></text:p></text:list-header></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="0.81cm" svg:height="1.092cm" svg:x="1.4cm" svg:y="13.615cm"><draw:image xlink:href="Pictures/10000200000000170000001F7CAC9796.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="0.81cm" svg:height="1.092cm" svg:x="1.4cm" svg:y="15.32cm"><draw:image xlink:href="Pictures/10000200000000170000001FBE2CD93B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="136" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="QA &amp; acknolwedgments" draw:style-name="dp4" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr22" draw:layer="layout" svg:width="25.199cm" svg:height="11.103cm" svg:x="1.4cm" svg:y="0.962cm" presentation:class="subtitle" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T53">Questions?</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr23" draw:layer="layout" svg:width="25.199cm" svg:height="7.62cm" svg:x="1.27cm" svg:y="12.7cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P27"><text:span text:style-name="T18">Thanks to</text:span></text:p><text:p text:style-name="P1">Fabian Sauter, Peter Ferrie, وليد عصر</text:p><text:p text:style-name="P28"><text:span text:style-name="T54">Bernhard Treutwein, Costin Ionescu, Deroko, Ivanlef0u, Kris Kaspersky, Moritz Kroll, Thomas Siebert, Tomislav Peričin, Kris McConkey, Lyr1k, Gunther, Sergey Bratus, frank2, Ero Carrera, Jindřich Kubec, Lord Noteworthy, Mohab Ali, Ashutosh Mehra, Gynvael Coldwind, Nicolas Ruff, Aurélien Lebrun, Daniel Plohmann, Gorka Ramírez, </text:span><text:span text:style-name="T54">최진영</text:span><text:span text:style-name="T54">, Adam Błaszczyk, </text:span><text:span text:style-name="T54">板橋一正</text:span><text:span text:style-name="T54">, Gil Dabah, Juriaan Bremer, Bruce Dang, Mateusz Jurczyk, Markus Hinderhofer, Sebastian Biallas, Igor Skochinsky, Ильфак Гильфанов, Alex Ionescu, Alexander Sotirov, Cathal Mullaney</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="137" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="thank you" draw:style-name="dp4" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr24" draw:text-style-name="P29" draw:layer="layout" svg:width="24.692cm" svg:height="4.984cm" svg:x="1.155cm" svg:y="3.834cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P1"><text:span text:style-name="T55">Thank YOU!</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr25" draw:text-style-name="P30" draw:layer="layout" svg:width="10.036cm" svg:height="2.54cm" svg:x="8.482cm" svg:y="13.46cm"><draw:text-box><text:p><text:span text:style-name="T56"><text:a xlink:href="http://twitter.com/ange4771">@ange4771</text:a></text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P8" draw:layer="layout" svg:width="17.203cm" svg:height="2.376cm" svg:x="7.875cm" svg:y="11.398cm"><draw:text-box><text:p><text:span text:style-name="T12">Ange Albertini</text:span><text:span text:style-name="T47"> @gmail.com</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="7.331cm" svg:height="6.396cm" svg:x="20.669cm" svg:y="14.605cm"><draw:image xlink:href="Pictures/10000201000000F3000000D40525473A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:layer="layout" svg:width="5.688cm" svg:height="0.963cm" svg:x="11.156cm" svg:y="15.991cm"><draw:text-box><text:p><text:a xlink:href="http://corkami.com/">http://corkami.com</text:a></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="138" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="bonus slides" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="subtitle"><draw:text-box><text:p><text:span text:style-name="T1">Bonus</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="139" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="not PE but still fun" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr26" draw:layer="layout" svg:width="25.199cm" svg:height="17.685cm" svg:x="1.4cm" svg:y="0.962cm" presentation:class="subtitle"><draw:text-box><text:p>Not PE, but still fun</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="140" presentation:class="page"/><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="older formats" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>older formats</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>32b windows still support old EXE and COM</text:p><text:list><text:list-item><text:p>lower profile formats, evade detection</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>an EXE can patch itself back to PE</text:p><text:list><text:list-item><text:p>can use &apos;ZM&apos; signature</text:p></text:list-item><text:list-item><text:p>on disk :(</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>a symbols-only COM file can drop a PE</text:p><text:list><text:list-item><text:p>using Yosuke Hasegawa&apos;s <text:a xlink:href="http://utf-8.jp/public/sas/">http://utf-8.jp/public/sas/</text:a></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="141" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="EXE self patcher" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T19"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="26.692cm" svg:height="9.815cm" svg:x="0.613cm" svg:y="5.593cm"><draw:image xlink:href="Pictures/10000000000002E900000112ADA9EB14.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>EXE self patcher</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="4.862cm" svg:height="0.839cm" svg:x="23.138cm" svg:y="20.161cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">exe2pe, dosZMXP</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr13" draw:text-style-name="P1" draw:layer="layout" svg:width="8.944cm" svg:height="5.715cm" svg:x="18.361cm" svg:y="13.97cm"><draw:image xlink:href="Pictures/10000000000000CD0000008386BB1C78.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="1.207cm" svg:height="1.047cm" svg:x="18.177cm" svg:y="13.97cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="142" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="symbol .com dropper" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr8" draw:text-style-name="P1" draw:layer="layout" svg:width="25.199cm" svg:height="13.576cm" svg:x="1.399cm" svg:y="5.055cm"><draw:image xlink:href="Pictures/100000000000032B000001B528C702C7.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>symbol-only .COM dropper</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P21" draw:layer="layout" svg:width="3.906cm" svg:height="0.839cm" svg:x="24.094cm" svg:y="20.163cm"><draw:text-box><text:p text:style-name="P6"><text:span text:style-name="T10">aa86drop.com</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="143" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="file archeology" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>file archeology</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="14.588cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>bitmap fonts (.FON) are stored in NE format</text:p><text:list><text:list-item><text:p>created in 1985 for Windows 1.0</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T34">vgasys.fon</text:span> still present in Windows 8</text:p><text:list><text:list-item><text:p>file unchanged since 1991 (Windows 3.11)</text:p></text:list-item><text:list-item><text:p>font copyrighted in 1984</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>Properties show copyright name</text:p></text:list-item></text:list><text:p/><text:p text:style-name="P1">→ Windows 8 still (partially) parses</text:p><text:p text:style-name="P1">a 16b executable format from 1985</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="144" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="NE .FON files" draw:style-name="dp3" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="27.304cm" svg:height="18.943cm" svg:x="0.348cm" svg:y="1.029cm"><draw:image xlink:href="Pictures/1000020100000408000002CC9D4F28F9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr44" draw:text-style-name="P1" draw:layer="layout" svg:width="14.125cm" svg:height="7.285cm" svg:x="6.938cm" svg:y="13.67cm"><draw:image xlink:href="Pictures/10000000000001790000020392537315.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr13" draw:text-style-name="P1" draw:layer="layout" svg:width="3.922cm" svg:height="3.175cm" svg:x="7.27cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/10000201000000BD00000099B9F92F18.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr13" draw:text-style-name="P1" draw:layer="layout" svg:width="3.385cm" svg:height="3.385cm" svg:x="16.539cm" svg:y="0.425cm"><draw:image xlink:href="Pictures/10000201000000600000006074725873.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr13" draw:text-style-name="P1" draw:layer="layout" svg:width="3.614cm" svg:height="3.175cm" svg:x="12.193cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/10000201000000D6000000BC9063F5F1.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="145" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="Drunk opcode" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="25.199cm" svg:height="3.506cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="title"><draw:text-box><text:p>Drunk opcode</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="25.199cm" svg:height="13.859cm" svg:x="1.4cm" svg:y="4.914cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L2"><text:list-item><text:p>Lock:Prefetch</text:p><text:list><text:list-item><text:p>can&apos;t be executed</text:p></text:list-item><text:list-item><text:p>does <text:span text:style-name="T57">not</text:span> trigger an exception either</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>wrongly &apos;repaired&apos; by Windows 7 x64</text:p><text:list><text:list-item><text:p><text:span text:style-name="T57">modified</text:span> by the OS</text:p></text:list-item><text:list-item><text:p>yet still wrong after patching!</text:p></text:list-item></text:list></text:list-item></text:list><text:p/><text:p text:style-name="P1">infinite loop of silent errors</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="146" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="lock:prefetch execution" draw:style-name="dp5" draw:master-page-name="Default"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="26.67cm" svg:height="5.609cm" svg:x="0.665cm" svg:y="0.961cm"><draw:image xlink:href="Pictures/10000000000002C4000000959819CBD2.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="26.383cm" svg:height="5.549cm" svg:x="0.809cm" svg:y="7.726cm"><draw:image xlink:href="Pictures/10000000000002C400000095CA7174ED.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="26.984cm" svg:height="5.676cm" svg:x="0.508cm" svg:y="14.644cm"><draw:image xlink:href="Pictures/10000000000002C4000000950A4A2E91.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="2.645cm" svg:height="0.826cm" svg:x="24.447cm" svg:y="12.549cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="2.617cm" svg:height="1.319cm" svg:x="3.823cm" svg:y="15.736cm"><text:p/></draw:rect><draw:rect draw:style-name="gr36" draw:text-style-name="P1" draw:layer="layout" svg:width="3.094cm" svg:height="0.808cm" svg:x="4.015cm" svg:y="2.029cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="147" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="the end" draw:style-name="dp5" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T32"><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><draw:frame presentation:style-name="pr21" draw:layer="layout" svg:width="25.199cm" svg:height="17.935cm" svg:x="1.4cm" svg:y="0.837cm" presentation:class="subtitle"><draw:text-box><text:p>this is the end...</text:p><text:p>my only friend, the end...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="148" presentation:class="page"/><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><presentation:settings presentation:mouse-visible="false"/></office:presentation></office:body></office:document-content>